
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.ejabberd.im/archive/old/">
      
      
        <link rel="prev" href="../older-releases/from_2.1.1x_to_16.02/">
      
      
        <link rel="next" href="../../CHANGELOG/">
      
      
      <link rel="icon" href="../../assets/img/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.19">
    
    
      
        <title>Configure 20.03 - ejabberd Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m10.5 24-1.485-9.007-8.961-1.738L8.16 9.06 7.045 0l6.495 6.414 8.271-3.861-4.093 8.16 6.228 6.673-9.024-1.372z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 21v-3.71l7.78-4.49 3.77 2.2L21 11.25V21H3M21 8.94l-6.45 3.73-3.77-2.17L3 15v-2.21l7.78-4.49 3.77 2.2L21 6.75v2.19Z"/></svg>');}</style>



    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/css/mdversion.css">
    
      <link rel="stylesheet" href="../../assets/css/notes.css">
    
      <link rel="stylesheet" href="../../assets/css/status.css">
    
      <link rel="stylesheet" href="../../assets/css/headers-underline.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#configuring-ejabberd-2003-or-older" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="ejabberd Docs" class="md-header__button md-logo" aria-label="ejabberd Docs" data-md-component="logo">
      
  <img src="../../assets/img/logo-docs.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ejabberd Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configure 20.03
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/processone/ejabberd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    processone/ejabberd
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../get-started/" class="md-tabs__link">
          
  
    
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../admin/install/" class="md-tabs__link">
          
  
    
  
  Install

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../admin/configuration/" class="md-tabs__link">
          
  
    
  
  Configure

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../admin/guide/" class="md-tabs__link">
          
  
    
  
  Advanced

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developer/" class="md-tabs__link">
          
  
    
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developer/ejabberd-api/" class="md-tabs__link">
          
  
    
  
  API

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Archive

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../roadmap/" class="md-tabs__link">
          
  
    
  
  Roadmap

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="ejabberd Docs" class="md-nav__button md-logo" aria-label="ejabberd Docs" data-md-component="logo">
      
  <img src="../../assets/img/logo-docs.png" alt="logo">

    </a>
    ejabberd Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/processone/ejabberd" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    processone/ejabberd
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../get-started/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Overview
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ejabberd-faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../use-cases/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Use Cases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../COPYING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../README-GIT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../admin/install/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Install
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Install
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/install/container/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Containers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CONTAINER/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     ejabberd Container
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../README-ECS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     ecs Container
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/install/binary-installer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Binary Installers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/install/os-package/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operating System Package
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/install/source/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Compile Source Code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/install/homebrew/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Homebrew
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/install-osx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mac OSX
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/install/next-steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Next Steps
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../admin/configuration/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Configure
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Configure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/configuration/file-format/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Format
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/configuration/basic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basic Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/configuration/authentication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Authentication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/configuration/database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Databases
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/configuration/ldap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/configuration/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/configuration/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/configuration/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/configuration/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
          
        
      
        
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../admin/guide/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Advanced
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/extending-ejabberd/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/guide/clustering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clustering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/guide/managing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Managing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/guide/security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/guide/troubleshooting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/mix-010/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     MIX tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/guide/mqtt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     MQTT tutorial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/muc-vcard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     MUC vCards
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/mysql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     MySQL tutorial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
          
        
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../developer/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Development
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developer Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/extending-ejabberd/pubsub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     Pubsub Dev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/xmpp-clients-bots/extensions/roster-versioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     Simplified Roster Versioning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/extending-ejabberd/stanza-routing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     Stanza Routing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/sql-schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     SQL Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/contrib/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     Contributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     Contributor Convenant
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/CONTRIBUTORS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
     Contributors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/repositories/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dependencies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../README-DOCS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/extending-ejabberd/elixir/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Elixir Dev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../livebooks/ejabberd-developer-livebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Livebook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/extending-ejabberd/localization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Localization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/extending-ejabberd/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Dev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/xmpp-clients-bots/extensions/muc-sub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MUC/Sub Extension
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/extending-ejabberd/testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/vscode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VSCode
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/xmpp-clients-bots/ios/getting-started-xmppframework/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    XMPPFramework (iOS)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../developer/ejabberd-api/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    API
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/ejabberd-api/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/ejabberd-api/admin-tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/ejabberd-api/simple-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simple Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/ejabberd-api/permissions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Permissions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/ejabberd-api/oauth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OAuth Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/ejabberd-api/commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer/ejabberd-api/api_versioning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Versioning
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Archive
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../24.02/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    24.02
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            24.02
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.02/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.02/admin-tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.02/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.02/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.02/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.02/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../24.02/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 24.02
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../23.10/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    23.10
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_3">
            <span class="md-nav__icon md-icon"></span>
            23.10
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.10/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.10/admin-tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.10/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Option
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.10/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.10/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.10/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.10/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 23.10
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../23.04/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    23.04
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_4" id="__nav_7_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_4">
            <span class="md-nav__icon md-icon"></span>
            23.04
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.04/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.04/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Option
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.04/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.04/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.04/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.04/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 23.04
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../23.01/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    23.01
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            23.01
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.01/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.01/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Option
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.01/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.01/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.01/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23.01/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 23.01
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../22.10/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    22.10
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_6" id="__nav_7_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_6">
            <span class="md-nav__icon md-icon"></span>
            22.10
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.10/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.10/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Option
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.10/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.10/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.10/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.10/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 22.10
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../22.05/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    22.05
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_7" id="__nav_7_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_7">
            <span class="md-nav__icon md-icon"></span>
            22.05
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.05/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.05/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Option
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.05/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.05/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.05/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22.05/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 22.05
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../21.12/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    21.12
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_8" id="__nav_7_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_8">
            <span class="md-nav__icon md-icon"></span>
            21.12
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.12/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.12/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Option
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.12/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.12/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.12/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.12/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 21.12
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../21.07/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    21.07
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_9" id="__nav_7_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_9">
            <span class="md-nav__icon md-icon"></span>
            21.07
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.07/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.07/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Option
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.07/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.07/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.07/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.07/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 21.07
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../21.04/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    21.04
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_10" id="__nav_7_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_10">
            <span class="md-nav__icon md-icon"></span>
            21.04
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.04/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.04/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Option
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.04/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.04/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.04/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.04/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 21.04
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../21.01/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    21.01
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_11" id="__nav_7_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_11">
            <span class="md-nav__icon md-icon"></span>
            21.01
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.01/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.01/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Option
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.01/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.01/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21.01/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../20.12/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    20.12
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_12" id="__nav_7_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_12">
            <span class="md-nav__icon md-icon"></span>
            20.12
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.12/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.12/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Option
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.12/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.12/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.12/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_13" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../20.07/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    20.07
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_13" id="__nav_7_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_13">
            <span class="md-nav__icon md-icon"></span>
            20.07
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.07/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.07/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.07/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.07/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.07/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_14" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../20.04/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    20.04
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_14" id="__nav_7_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_14">
            <span class="md-nav__icon md-icon"></span>
            20.04
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.04/admin-api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.04/listen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Modules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.04/listen-options/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Listen Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.04/modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modules Options
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.04/toplevel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Top-Level Options
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_15" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../20.03/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    20.03
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_15">
            <span class="md-nav__icon md-icon"></span>
            20.03
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_16" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../20.02/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    20.02
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_16">
            <span class="md-nav__icon md-icon"></span>
            20.02
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_17" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../20.01/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    20.01
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7_17" id="__nav_7_17_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_17">
            <span class="md-nav__icon md-icon"></span>
            20.01
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20.01/upgrade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 20.01
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_18" >
        
          
          <label class="md-nav__link" for="__nav_7_18" id="__nav_7_18_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Older releases
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_18">
            <span class="md-nav__icon md-icon"></span>
            Older releases
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_19.05_to_19.08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 19.08
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_19.02_to_19.05/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 19.05
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_18.12_to_19.02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 19.02
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_18.09_to_18.12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 18.12
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_18.06_to_18.09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 18.09
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_18.04_to_18.06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 18.06
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_18.03_to_18.04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 18.04
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_18.01_to_18.03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 18.03
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_17.11_to_18.01/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 18.01
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_17.09_to_17.11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 17.11
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_17.06_to_17.09/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 17.09
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_17.03_to_17.06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 17.06
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_16.08_to_17.03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 17.03
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_16.06_to_16.08/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 16.08
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_16.04_to_16.06/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 16.06
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_16.03_to_16.04/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 16.04
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_16.02_to_16.03/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 16.03
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_15.11_to_16.02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade to ejabberd 16.02
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../older-releases/from_2.1.1x_to_16.02/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Upgrade from 2.1.1x to 16.02
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Configure 20.03
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Configure 20.03
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label=" ">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
       
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#config-file-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      Config File Formatting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Config File Formatting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#yaml-configuration-file-format" class="md-nav__link">
    <span class="md-ellipsis">
      Yaml Configuration File Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#legacy-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Legacy Configuration File
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-one-or-several-xmpp-domains" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring One or Several XMPP Domains
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring One or Several XMPP Domains">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#host-names" class="md-nav__link">
    <span class="md-ellipsis">
      Host Names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-hosting" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual Hosting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Basic Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listening-ports" class="md-nav__link">
    <span class="md-ellipsis">
      Listening Ports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acme" class="md-nav__link">
    <span class="md-ellipsis">
      ACME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-acme-options" class="md-nav__link">
    <span class="md-ellipsis">
      Available ACME options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#internal" class="md-nav__link">
    <span class="md-ellipsis">
      Internal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-login-and-sasl-anonymous" class="md-nav__link">
    <span class="md-ellipsis">
      Anonymous Login and SASL Anonymous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwt-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      JWT Authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Access Rules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Access Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acl-definition" class="md-nav__link">
    <span class="md-ellipsis">
      ACL Definition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-rights" class="md-nav__link">
    <span class="md-ellipsis">
      Access Rights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shaper-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Shaper Rules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limiting-opened-sessions-with-acl" class="md-nav__link">
    <span class="md-ellipsis">
      Limiting Opened Sessions with ACL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#several-connections-to-a-remote-xmpp-server-with-acl" class="md-nav__link">
    <span class="md-ellipsis">
      Several connections to a remote XMPP server with ACL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shapers" class="md-nav__link">
    <span class="md-ellipsis">
      Shapers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-language" class="md-nav__link">
    <span class="md-ellipsis">
      Default Language
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#captcha" class="md-nav__link">
    <span class="md-ellipsis">
      CAPTCHA
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Node settings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stun-and-turn" class="md-nav__link">
    <span class="md-ellipsis">
      STUN and TURN
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sip" class="md-nav__link">
    <span class="md-ellipsis">
      SIP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SIP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sip-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      SIP Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#note-on-sip-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Note on SIP usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#include-additional-configuration-files" class="md-nav__link">
    <span class="md-ellipsis">
      Include Additional Configuration Files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#option-macros-in-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Option Macros in Configuration File
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CHANGELOG/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ChangeLog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../roadmap/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Roadmap
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Roadmap
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label=" ">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
       
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#config-file-formatting" class="md-nav__link">
    <span class="md-ellipsis">
      Config File Formatting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Config File Formatting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#yaml-configuration-file-format" class="md-nav__link">
    <span class="md-ellipsis">
      Yaml Configuration File Format
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#legacy-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Legacy Configuration File
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-one-or-several-xmpp-domains" class="md-nav__link">
    <span class="md-ellipsis">
      Configuring One or Several XMPP Domains
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuring One or Several XMPP Domains">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#host-names" class="md-nav__link">
    <span class="md-ellipsis">
      Host Names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtual-hosting" class="md-nav__link">
    <span class="md-ellipsis">
      Virtual Hosting
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Basic Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#logging" class="md-nav__link">
    <span class="md-ellipsis">
      Logging
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listening-ports" class="md-nav__link">
    <span class="md-ellipsis">
      Listening Ports
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acme" class="md-nav__link">
    <span class="md-ellipsis">
      ACME
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-acme-options" class="md-nav__link">
    <span class="md-ellipsis">
      Available ACME options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#internal" class="md-nav__link">
    <span class="md-ellipsis">
      Internal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#anonymous-login-and-sasl-anonymous" class="md-nav__link">
    <span class="md-ellipsis">
      Anonymous Login and SASL Anonymous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jwt-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      JWT Authentication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#access-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Access Rules
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Access Rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#acl-definition" class="md-nav__link">
    <span class="md-ellipsis">
      ACL Definition
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-rights" class="md-nav__link">
    <span class="md-ellipsis">
      Access Rights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shaper-rules" class="md-nav__link">
    <span class="md-ellipsis">
      Shaper Rules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limiting-opened-sessions-with-acl" class="md-nav__link">
    <span class="md-ellipsis">
      Limiting Opened Sessions with ACL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#several-connections-to-a-remote-xmpp-server-with-acl" class="md-nav__link">
    <span class="md-ellipsis">
      Several connections to a remote XMPP server with ACL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shapers" class="md-nav__link">
    <span class="md-ellipsis">
      Shapers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#default-language" class="md-nav__link">
    <span class="md-ellipsis">
      Default Language
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#captcha" class="md-nav__link">
    <span class="md-ellipsis">
      CAPTCHA
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Node settings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stun-and-turn" class="md-nav__link">
    <span class="md-ellipsis">
      STUN and TURN
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sip" class="md-nav__link">
    <span class="md-ellipsis">
      SIP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SIP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sip-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      SIP Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#note-on-sip-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Note on SIP usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#include-additional-configuration-files" class="md-nav__link">
    <span class="md-ellipsis">
      Include Additional Configuration Files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#option-macros-in-configuration-file" class="md-nav__link">
    <span class="md-ellipsis">
      Option Macros in Configuration File
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/processone/docs.ejabberd.im/edit/master/content/archive/old.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/processone/docs.ejabberd.im/raw/master/content/archive/old.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h1 id="configuring-ejabberd-2003-or-older">Configuring ejabberd 20.03 or older<a class="headerlink" href="#configuring-ejabberd-2003-or-older" title="Permanent link">&para;</a></h1>
<p>Here are the main entry points to learn more about ejabberd configuration.
ejabberd is extremely powerful and can be configured in many ways with many options.</p>
<p>Do not let this complexity scare you. Most of you will be fine with default config file (or light changes).</p>
<h2 id="config-file-formatting">Config File Formatting<a class="headerlink" href="#config-file-formatting" title="Permanent link">&para;</a></h2>
<h3 id="yaml-configuration-file-format">Yaml Configuration File Format<a class="headerlink" href="#yaml-configuration-file-format" title="Permanent link">&para;</a></h3>
<p>The configuration file will be loaded the first time you start
<code>ejabberd</code>. The configuration file name MUST have “.yml” or “.yaml”
extension. This helps ejabberd to differentiate between the new and
legacy file formats (see
section <a href="#legacy-configuration-file">Legacy Configuration File</a>).</p>
<p>The configuration file is written in <a href="https://en.wikipedia.org/wiki/YAML"><code>YAML</code></a>.</p>
<p>Note that <code>ejabberd</code> never edits the configuration file. If you are
changing parameter from web admin interface, you will need to apply
them to configuration file manually. This is to prevent messing up
with your config file comments, syntax, etc.</p>
<p>Please, consult <code>ejabberd.log</code> for configuration errors. <code>ejabberd</code> will
report syntax related errors, as well as complains about unknown options
and invalid values. Make sure you respect indentation (YAML is
sensitive to this) or you will get pretty cryptic errors.</p>
<h3 id="legacy-configuration-file">Legacy Configuration File<a class="headerlink" href="#legacy-configuration-file" title="Permanent link">&para;</a></h3>
<p>In previous <code>ejabberd</code> version the configuration file should be
written in Erlang terms. The format is still supported, but it is
highly recommended to convert it to the new YAML format using
<code>convert_to_yaml</code> command from <code>ejabberdctl</code> (see
<a href="../../admin/guide/managing/#ejabberdctl">ejabberdctl</a>
and <a href="../../admin/guide/managing/#list_of_ejabberd_commands">List of ejabberd Commands</a>
for details).</p>
<p>If you want to specify some options using the old Erlang format, you
can set them in an additional cfg file, and include it using the
<code>include_config_file</code> option, see
<a href="#include-additional-configuration-files">Include Additional Configuration Files</a>
for the option description and a related example in
<a href="../../admin/guide/managing/#restrict_execution_with_accesscommands">Restrict Execution with AccessCommands</a>.</p>
<h2 id="configuring-one-or-several-xmpp-domains">Configuring One or Several XMPP Domains<a class="headerlink" href="#configuring-one-or-several-xmpp-domains" title="Permanent link">&para;</a></h2>
<h3 id="host-names">Host Names<a class="headerlink" href="#host-names" title="Permanent link">&para;</a></h3>
<p><code>ejabberd</code> supports managing several independent XMPP domains on a
single ejabberd instance, using a feature called virtual hosting.</p>
<p>The option <code>hosts</code> defines a list containing one or more domains that
<code>ejabberd</code> will serve.</p>
<p>Of course, the <code>hosts</code> list can contain just one domain if you do not
want to host multiple XMPP domains on the same instance.</p>
<p>The syntax is: <code>[HostName1, Hostname2]</code></p>
<p>Examples:</p>
<ul>
<li>Serving one domain:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">example.org</span><span class="p p-Indicator">]</span>
</span></code></pre></div>
<ul>
<li>Serving three domains:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.net</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.com</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jabber.somesite.org</span>
</span></code></pre></div>
<h3 id="virtual-hosting">Virtual Hosting<a class="headerlink" href="#virtual-hosting" title="Permanent link">&para;</a></h3>
<p>When managing several XMPP domains in a single instance, those domains are truly independent.
It means they can even have different configuration parameters.</p>
<p>Options can be defined separately for every virtual host using the <code>host_config</code> option.</p>
<p>The syntax is: <code>{HostName: [Option, ...]}</code></p>
<p>Examples:</p>
<ul>
<li>Domain <code>example.net</code> is using the internal authentication method
 while domain <code>example.com</code> is using the LDAP server running on the
 domain <code>localhost</code> to perform authentication:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="w">  </span><span class="nt">host_config</span><span class="p">:</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">    </span><span class="nt">example.net</span><span class="p">:</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">      </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="nt">example.com</span><span class="p">:</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">      </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ldap</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">      </span><span class="nt">ldap_servers</span><span class="p">:</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">localhost</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">      </span><span class="nt">ldap_uids</span><span class="p">:</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">uid</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">      </span><span class="nt">ldap_rootdn</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dc=localdomain&quot;</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">      </span><span class="nt">ldap_rootdn</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dc=example,dc=com&quot;</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">      </span><span class="nt">ldap_password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</span></code></pre></div>
<ul>
<li>Domain <code>example.net</code> is using SQL to perform authentication while
 domain <code>example.com</code> is using the LDAP servers running on the
 domains <code>localhost</code> and <code>otherhost</code>:</li>
</ul>
<p>host_config:
    example.net:
      auth_method: sql
      sql_type: odbc
      sql_server: "DSN=ejabberd;UID=ejabberd;PWD=ejabberd"
    example.com:
      auth_method: ldap
      ldap_servers:
        - localhost
        - otherhost
      ldap_uids:
        - uid
      ldap_rootdn: "dc=localdomain"
      ldap_rootdn: "dc=example,dc=com"
      ldap_password: ""</p>
<p>To define specific ejabberd modules in a virtual host, you can define
the global <code>modules</code> option with the common modules, and later add
specific modules to certain virtual hosts. To accomplish that, instead
of defining each option in <code>host_config</code> use <code>append_host_config</code> with
the same syntax.</p>
<p>In this example three virtual hosts have some similar modules, but there
are also other different modules for some specific virtual hosts:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="w"> </span><span class="c1">## This ejabberd server has three vhosts:</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w"> </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">one.example.org</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">two.example.org</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">   </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">three.example.org</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w"> </span><span class="c1">## Configuration of modules that are common to all vhosts</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w"> </span><span class="nt">modules</span><span class="p">:</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">   </span><span class="nt">mod_roster</span><span class="p">:</span><span class="w">    </span><span class="p p-Indicator">{}</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="w">   </span><span class="nt">mod_configure</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">   </span><span class="nt">mod_disco</span><span class="p">:</span><span class="w">     </span><span class="p p-Indicator">{}</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">   </span><span class="nt">mod_private</span><span class="p">:</span><span class="w">   </span><span class="p p-Indicator">{}</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">   </span><span class="nt">mod_time</span><span class="p">:</span><span class="w">      </span><span class="p p-Indicator">{}</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="w">   </span><span class="nt">mod_last</span><span class="p">:</span><span class="w">      </span><span class="p p-Indicator">{}</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="w">   </span><span class="nt">mod_version</span><span class="p">:</span><span class="w">   </span><span class="p p-Indicator">{}</span>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="w"> </span><span class="c1">## Add some modules to vhost one:</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="w"> </span><span class="nt">append_host_config</span><span class="p">:</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="w">   </span><span class="nt">one.example.org</span><span class="p">:</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="w">     </span><span class="nt">modules</span><span class="p">:</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="w">       </span><span class="nt">mod_muc</span><span class="p">:</span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="w">         </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conference.one.example.org</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="w">       </span><span class="nt">mod_ping</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="w"> </span><span class="c1">## Add a module just to vhost two:</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="w"> </span><span class="nt">append_host_config</span><span class="p">:</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="w">   </span><span class="nt">two.example.org</span><span class="p">:</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="w">     </span><span class="nt">modules</span><span class="p">:</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="w">       </span><span class="nt">mod_muc</span><span class="p">:</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="w">         </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conference.two.example.org</span>
</span></code></pre></div>
<h2 id="basic-configuration">Basic Configuration<a class="headerlink" href="#basic-configuration" title="Permanent link">&para;</a></h2>
<h3 id="logging">Logging<a class="headerlink" href="#logging" title="Permanent link">&para;</a></h3>
<p><code>ejabberd</code> configuration can help a lot by having the right amount of logging set up.</p>
<p>Here is a few general option to configure logging:</p>
<p><strong><code>loglevel: Number</code></strong>: Verbosity of log files generated by ejabberd. Available levels are.</p>
<ul>
<li>0: No ejabberd log at all (not recommended)</li>
<li>1: Critical</li>
<li>2: Error</li>
<li>3: Warning</li>
<li>4: Info</li>
<li>5: Debug</li>
</ul>
<p><strong><code>log_rotate: size, date and count</code></strong>: The <em>rotation</em> parameters describe how to rotate logs. Either size and/or date can trigger
    log rotation. Setting count to N keeps N rotated logs. Setting count to 0
    does not disable rotation, it instead rotates the file and keeps no previous
    versions around. Setting size to X rotate log when it reaches X bytes.
    To disable rotation set the size to 0 and the date to ""
    Date syntax is taken from the syntax newsyslog uses in newsyslog.conf.</p>
<p>Here are some examples:</p>
<ul>
<li>$D0     rotate every night at midnight</li>
<li>$D23    rotate every day at 23:00 hr</li>
<li>$W0D23  rotate every week on Sunday at 23:00 hr</li>
<li>$W5D16  rotate every week on Friday at 16:00 hr</li>
<li>$M1D0   rotate on the first day of every month at midnight</li>
<li>$M5D6   rotate on every 5th day of the month at 6:00 hr</li>
</ul>
<p>The values in default configuration file are:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="w">    </span><span class="nt">log_rotate_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="nt">log_rotate_date</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;$D0&quot;</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="nt">log_rotate_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span></code></pre></div>
<p><strong><code>log_rate_limit: Number</code></strong>: This option is used for overload protection: If you want to limit
    the number of messages per second allowed from error_logger, which is
    a good idea if you want to avoid a flood of messages when system is
    overloaded, you can set a limit. Default value is 100.</p>
<p>For example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="w">    </span><span class="nt">log_rate_limit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
</span></code></pre></div>
<p><strong><code>hide_sensitive_log_data: Boolean</code></strong>: We have a privacy option to ensure we do not log IP address or
    sensitive data. Default value is false for backward compatibility.</p>
<p>For example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="w">    </span><span class="nt">hide_sensitive_log_data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span></code></pre></div>
<h3 id="listening-ports">Listening Ports<a class="headerlink" href="#listening-ports" title="Permanent link">&para;</a></h3>
<p>The option <code>listen</code> defines for which ports, addresses and network protocols <code>ejabberd</code> will listen and what services will be run on them.
Each element of the list is an associative array with the following elements:</p>
<ul>
<li>
<p>Port number. Optionally also the IP address and/or a transport
 protocol.</p>
</li>
<li>
<p>Listening module that serves this port.</p>
</li>
<li>
<p>Options for the TCP socket and for the listening module.</p>
</li>
</ul>
<p>The option syntax is:</p>
<p><strong><code>[Listener, ...]</code></strong>:</p>
<p>Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="w"> </span><span class="nt">listen</span><span class="p">:</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">   </span><span class="p p-Indicator">-</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">     </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5222</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">     </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_c2s</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">     </span><span class="nt">starttls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">   </span><span class="p p-Indicator">-</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">     </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5269</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">     </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_s2s_in</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">     </span><span class="nt">transport</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
</span></code></pre></div>
<h4 id="port-number-ip-address-and-transport-protocol">Port Number, IP Address and Transport Protocol<a class="headerlink" href="#port-number-ip-address-and-transport-protocol" title="Permanent link">&para;</a></h4>
<p>The port number defines which port to listen for incoming connections.
It can be a Jabber/XMPP standard port or any other valid port number.</p>
<p>The IP address can be represented as a string. The socket will listen only in that network interface.
It is possible to specify a generic address ("0.0.0.0" for IPv4 or "::" for IPv6), so <code>ejabberd</code> will listen in all addresses.
Depending on the type of the IP address, IPv4 or IPv6 will be used.
When the IP address is not specified, it will listen on all IPv4 network addresses.</p>
<p>Note that on some operating systems and/or OS configurations, listening on "::" will mean listening for IPv4 traffic as well as IPv6 traffic.</p>
<p>Some example values for IP address:</p>
<ul>
<li>
<p><code>"0.0.0.0"</code> to listen in all IPv4 network interfaces. This is the
 default value when no IP is specified.</p>
</li>
<li>
<p><code>"::"</code> to listen in all IPv6 network interfaces</p>
</li>
<li>
<p><code>"10.11.12.13"</code> is the IPv4 address <code>10.11.12.13</code></p>
</li>
<li>
<p><code>"::FFFF:127.0.0.1"</code> is the IPv6 address <code>::FFFF:127.0.0.1/128</code></p>
</li>
</ul>
<p>The transport protocol can be <code>tcp</code> or <code>udp</code>. Default is <code>tcp</code>.</p>
<h4 id="listening-module">Listening Module<a class="headerlink" href="#listening-module" title="Permanent link">&para;</a></h4>
<p>The available modules, their purpose and the options allowed by each one
are:</p>
<p><strong><code>ejabberd_c2s</code></strong>:   Handles c2s connections.
    Options: <code>access</code>, <code>ciphers</code>, <code>dhfile</code>, <code>protocol_options</code>,
 <code>max_fsm_queue</code>, <code>max_stanza_size</code>, <code>shaper</code>,
 <code>starttls</code>, <code>starttls_required</code>, <code>tls</code>, <code>zlib</code>,
 <code>tls_compression</code></p>
<p><strong><code>ejabberd_s2s_in</code></strong>:   Handles incoming s2s connections.
    Options: <code>max_stanza_size</code>, <code>shaper</code>, <code>tls_compression</code></p>
<p><strong><code>ejabberd_service</code></strong>:   Interacts with an
 <a href="https://ejabberd.im/tutorials-transports"><code>external component</code></a>
 (as defined in the Jabber Component Protocol
 (<a href="https://xmpp.org/extensions/xep-0114.html"><code>XEP-0114</code></a>).
 Options: <code>access</code>, <code>hosts</code>, <code>max_fsm_queue</code>, <code>password</code>, <code>check_from</code>,
 <code>shaper_rule</code></p>
<p><strong><code>ejabberd_sip</code></strong>:   Handles SIP requests as defined in
 <a href="https://tools.ietf.org/html/rfc3261"><code>RFC 3261</code></a>.
 Options: <code>certfile</code>, <code>tls</code></p>
<p><strong><code>ejabberd_stun</code></strong>:   Handles STUN/TURN requests as defined in
 <a href="https://tools.ietf.org/html/rfc5389"><code>RFC 5389</code></a> and
 <a href="https://tools.ietf.org/html/rfc5766"><code>RFC 5766</code></a>.
 Options: <code>certfile</code>, <code>tls</code>, <code>use_turn</code>, <code>turn_ip</code>,
 <code>turn_port_range</code>, <code>turn_max_allocations</code>, <code>turn_max_permissions</code>,
 <code>shaper</code>, <code>server_name</code>, <code>auth_realm</code>, <code>auth_type</code></p>
<p><strong><code>ejabberd_http</code></strong>:   Handles incoming HTTP connections. This module is responsible for serving Web Admin, but also XMPP BOSH and Websocket with proper request handler configured.
 Options: <code>default_host</code>, <code>dhfile</code>,
 <code>request_handlers</code>, <code>tls</code>, <code>tls_compression</code>,
 <code>trusted_proxies</code> (global option)</p>
<p><strong><code>ejabberd_xmlrpc</code></strong>:   Handles XML-RPC requests to execute
 <a href="../../admin/guide/managing/#ejabberd_commands">ejabberd commands</a>.
 Options: <code>access_commands</code>, <code>maxsessions</code>, <code>timeout</code>.
 For explanations about <code>access_commands</code> see
 <a href="../../admin/guide/managing/#restrict_execution_with_accesscommands">Restrict Execution with AccessCommands</a>.
 Check some <a href="../../developer/ejabberd-api/oauth/#xml_rpc_examples">XML-RPC examples</a>.
 You can find more information in the old
 <a href="https://ejabberd.im/ejabberd_xmlrpc"><code>ejabberd_xmlrpc documentation</code></a>.</p>
<h4 id="options">Options<a class="headerlink" href="#options" title="Permanent link">&para;</a></h4>
<p>This is a detailed description of each option allowed by the listening
modules:</p>
<p><strong><code>access: AccessName</code></strong>:   This option defines access to the port. The default value is <code>all</code>.</p>
<p><strong><code>backlog: Value</code></strong>:   The backlog value defines the maximum length that the queue of
 pending connections may grow to. This should be increased if the
 server is going to handle lots of new incoming connections as they
 may be dropped if there is no space in the queue (and ejabberd was
 not able to accept them immediately). Default value is 5.</p>
<p><strong><code>ciphers: Ciphers</code></strong>:   OpenSSL ciphers list in the same format accepted by
 ‘<code>openssl ciphers</code>’ command.</p>
<p><strong><code>protocol_options: ProtocolOpts</code></strong>:   List of general options relating to SSL/TLS. These map to
 <code>OpenSSL’s set_options()</code>.
 The default entry is: <code>"no_sslv3|cipher_server_preference|no_compression"</code></p>
<p><strong><code>default_host: undefined|HostName</code></strong>:   If the HTTP request received by ejabberd contains the HTTP header
 <code>Host</code> with an ambiguous virtual host that doesn’t match any one
 defined in ejabberd (see <a href="#host-names">Host Names</a>), then this configured HostName
 is set as the request Host. The default value of this option is:
 <code>undefined</code>.</p>
<p><strong><code>dhfile: Path</code></strong>:   Full path to a file containing custom parameters for Diffie-Hellman key
 exchange. Such a file could be created with the command
 <code>openssl dhparam -out dh.pem 2048</code>. If this option is not specified,
 default parameters will be used, which might not provide the same level
 of security as using custom parameters.</p>
<p><strong><code>hosts: {Hostname: [HostOption, ...]}</code></strong>:   The external Jabber component that connects to this
 <code>ejabberd_service</code> can serve one or more hostnames. As <code>HostOption</code>
 you can define options for the component; currently the only allowed
 option is the password required to the component when attempt to
 connect to ejabberd: <code>password: Secret</code>. Note that you
 cannot define in a single <code>ejabberd_service</code> components of different
 services: add an <code>ejabberd_service</code> for each service, as seen in an
 example below. This option may not be necessary if the component
 already provides the host in its packets; in that case, you can simply
 provide the password option that will be used for all the hosts
 (see port 5236 definition in the example below).</p>
<p>Remember that you must also install and enable the module <code>mod\_bosh</code>, and the <code>ejabberd_c2s</code> listener must be available too.</p>
<p>If HTTP Bind (BOSH) is enabled, it will be available at <code>http://server:port/bosh/</code>.
Be aware that support for HTTP Bind is also needed in the XMPP client.
Remark also that HTTP Bind can be interesting to host a web-based XMPP client such as <a href="https://jwchat.org"><code>JWChat</code></a> (check the tutorials to install JWChat with ejabberd and an <a href="https://ejabberd.im/jwchat-localserver"><code>embedded local web server</code></a> or <a href="https://ejabberd.im/jwchat-apache"><code>Apache</code></a>).</p>
<p><strong><code>max_fsm_queue: Size</code></strong>:   This option specifies the maximum number of elements in the queue of
 the FSM (Finite State Machine). Roughly speaking, each message in
 such queues represents one XML stanza queued to be sent into its
 relevant outgoing stream. If queue size reaches the limit (because,
 for example, the receiver of stanzas is too slow), the FSM and the
 corresponding connection (if any) will be terminated and error
 message will be logged. The reasonable value for this option depends
 on your hardware configuration. This option can be specified for
 <code>ejabberd_service</code> and <code>ejabberd_c2s</code> listeners, or also globally
 for <code>ejabberd_s2s_out</code>. If the option is not specified for
 <code>ejabberd_service</code> or <code>ejabberd_c2s</code> listeners, the globally
 configured value is used. The allowed values are integers and
 ’undefined’. Default value: ’10000’.</p>
<p><strong><code>max_stanza_size: Size</code></strong>:   This option specifies an approximate maximum size in bytes of XML
 stanzas. Approximate, because it is calculated with the precision of
 one block of read data. For example <code>{max_stanza_size, 65536}</code>. The
 default value is <code>infinity</code>. Recommended values are 65536 for c2s
 connections and 131072 for s2s connections. s2s max stanza size must
 always much higher than c2s limit. Change this value with extreme
 care as it can cause unwanted disconnect if set too low.</p>
<p><strong><code>password: Secret</code></strong>:   Specify the password to verify an external component that connects to the port.</p>
<p><strong><code>request_handlers: {Path: Module}</code></strong>:   To define one or several handlers that will serve HTTP requests. The
 Path is a string; so the URIs that start with that Path will be
 served by Module. For example, if you want <code>mod_foo</code> to serve the
 URIs that start with <code>/a/b/</code>, and you also want <code>mod_bosh</code> to
 serve the URIs <code>/bosh/</code>, use this option:
 <div class="language-yaml highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="w">  </span><span class="nt">request_handlers</span><span class="p">:</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span><span class="nt">/a/b</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mod_foo</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">  </span><span class="nt">/bosh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mod_bosh</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">  </span><span class="nt">/mqtt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mod_mqtt</span>
</span></code></pre></div></p>
<p><strong><code>check_from: true|false</code></strong>:   This option can be used with <code>ejabberd_service</code> only.
 <a href="https://xmpp.org/extensions/xep-0114.html"><code>XEP-0114</code></a> requires that
 the domain must match the hostname of the component. If this option
 is set to <code>false</code>, <code>ejabberd</code> will allow the component to send
 stanzas with any arbitrary domain in the ’from’ attribute. Only use
 this option if you are completely sure about it. The default value
 is <code>true</code>, to be compliant with
 <a href="https://xmpp.org/extensions/xep-0114.html"><code>XEP-0114</code></a>.</p>
<p><strong><code>shaper: none|ShaperName</code></strong>:   This option defines a shaper for the port (see section <a href="#shapers">Shapers</a>).
 The default value is <code>none</code>.</p>
<p><strong><code>shaper_rule: none|ShaperRule</code></strong>:   This option defines a shaper rule for the <code>ejabberd_service</code> (see
 section <a href="#shapers">Shapers</a>). The recommended value is <code>fast</code>.</p>
<p><strong><code>starttls: true|false</code></strong>:   This option specifies that STARTTLS encryption is available on
 connections to the port. You should also set the <code>certfiles</code> option or configure <a href="#acme">ACME</a>.</p>
<p><strong><code>starttls_required: true|false</code></strong>:   This option specifies that STARTTLS encryption is required on
 connections to the port. No unencrypted connections will be allowed.
 You should also set the <code>certfiles</code> option or configure <a href="#acme">ACME</a>.</p>
<p><strong><code>timeout: Integer</code></strong>:   Timeout of the connections, expressed in milliseconds. Default: 5000</p>
<p><strong><code>tls: true|false</code></strong>:   This option specifies that traffic on the port will be encrypted
 using SSL immediately after connecting. This was the traditional
 encryption method in the early Jabber software, commonly on port
 5223 for client-to-server communications. But this method is
 nowadays deprecated and not recommended. The preferable encryption
 method is STARTTLS on port 5222, as defined
 <a href="https://xmpp.org/rfcs/rfc6120.html#tls"><code>RFC 6120: XMPP Core</code></a>,
 which can be enabled in <code>ejabberd</code> with the option <code>starttls</code>. If
 this option is set, you should also set the <code>certfiles</code> option or configure <a href="#acme">ACME</a>.
 The option <code>tls</code> can also be used in <code>ejabberd_http</code> to support HTTPS.</p>
<p><strong><code>tls_compression: true|false</code></strong>:   Whether to enable or disable TLS compression. The default value is
 <code>false</code>.</p>
<p><strong><code>use_proxy_protocol: true|false</code></strong>:   Is this listener accessed by proxy service that is using
    proxy protocol for supplying real IP addresses to ejabberd server. You can read about this protocol
    in <a href="http://www.haproxy.org/download/1.8/doc/proxy-protocol.txt">Proxy protocol specification</a>.
    The default value of this option is<code>false</code>.</p>
<p><strong><code>zlib: true|false</code></strong>:   This option specifies that Zlib stream compression (as defined in
 <a href="https://xmpp.org/extensions/xep-0138.html"><code>XEP-0138</code></a>) is available
 on connections to the port.</p>
<h4 id="global-options">Global Options<a class="headerlink" href="#global-options" title="Permanent link">&para;</a></h4>
<p>There are some additional global options that can be specified in the ejabberd configuration file (outside <code>listen</code>):</p>
<p><strong><code>acme</code></strong>: Automated SSL certificate management. See section <a href="#acme">ACME</a>.</p>
<p><strong><code>certfiles: List of paths</code></strong>: The option accepts a list of file
  paths (optionally with wildcards) containing either PEM certificates
  or PEM private keys. At startup, ejabberd sorts the certificates,
  finds matching private keys and rebuilds full certificates
  chains. Use this option when enabling options like <code>starttls</code> or
  <code>tls</code> in listeners <code>ejabberd_c2s</code>, <code>ejabberd_s2s</code> or
  <code>ejabberd_http</code>.</p>
<p><strong><code>c2s_cafile: Path</code></strong>: Full path to a file containing one or more CA
  certificates in PEM format.  All client certificates should be
  signed by one of these root CA certificates and should contain the
  corresponding JID(s) in <code>subjectAltName</code> field.</p>
<p><strong><code>c2s_ciphers: Ciphers</code></strong>: OpenSSL ciphers list in the same format
  accepted by ‘<code>openssl ciphers</code>’ command.</p>
<p><strong><code>c2s_dhfile: Path</code></strong>: Full path to a file containing custom DH
  parameters. Such a file could be created with the command <code>openssl
  dhparam -out dh.pem 2048</code>. If this option is not specified, default
  parameters will be used, which might not provide the same level of
  security as using custom parameters.</p>
<p><strong><code>c2s_protocol_options: ProtocolOpts</code></strong>: List of general options relating to SSL/TLS. These map to <code>OpenSSL’s set_options()</code>.
  The default entry is: <code>"no_sslv3|cipher_server_preference|no_compression"</code></p>
<p><strong><code>c2s_tls_compression: true|false</code></strong>: Whether to enable or disable
  TLS compression for c2s connections.  The default value is <code>false</code>.</p>
<p><strong><code>s2s_use_starttls: false|optional|required|required_trusted</code></strong>:   This option defines if s2s connections don’t use STARTTLS
 encryption; if STARTTLS can be used optionally; if STARTTLS is
 required to establish the connection; or if STARTTLS is required and
 the remote certificate must be valid and trusted. Do note that
 <code>required_trusted</code> is deprecated and will be unsupported in future
 releases. Instead, set it to <code>required</code> and make sure <code>mod_s2s_dialback</code>
 is <em>NOT</em> loaded. The default value is to not use STARTTLS: <code>false</code>.</p>
<p><strong><code>s2s_dhfile: Path</code></strong>:   Full path to a file containing custom DH parameters. Such a file could be
 created with the command <code>openssl dhparam -out dh.pem 2048</code>. If this
 option is not specified, default parameters will be used, which might
 not provide the same level of security as using custom parameters.</p>
<p><strong><code>s2s_ciphers: Ciphers</code></strong>:   OpenSSL ciphers list in the same format accepted by
 ‘<code>openssl ciphers</code>’ command.</p>
<p><strong><code>s2s_protocol_options: ProtocolOpts</code></strong>:   List of general options relating to SSL/TLS. These map to
 <code>OpenSSL’s set_options()</code>.
 The default entry is: <code>"no_sslv3|cipher_server_preference|no_compression"</code></p>
<p><strong><code>outgoing_s2s_families: [Family, ...]</code></strong>:   Specify which address families to try, in what order. By default it
 first tries connecting with IPv4, if that fails it tries using IPv6.</p>
<p><strong><code>outgoing_s2s_timeout: Timeout</code></strong>:   The timeout in seconds for outgoing S2S connection attempts.</p>
<p><strong><code>s2s_access: Access</code></strong>:   The policy for incoming and outgoing s2s connections to other XMPP
 servers. The default value is <code>all</code>. You can disable connections to other servers (federation)
 here by setting it to <code>none</code>, but this will not block other locally hosted servers as, for performance
 reasons, they are connected internally and not via the s2s module. To block even those you might
 need to use an additional module, for example <a href="https://github.com/processone/ejabberd-contrib/tree/master/mod_isolation"><code>mod_isolation</code></a>.</p>
<p><strong><code>s2s_dns_timeout: Timeout</code></strong>:   The timeout in seconds for DNS resolving. The default value is <code>10</code>.</p>
<p><strong><code>s2s_dns_retries: Number</code></strong>:   DNS resolving retries in seconds. The default value is <code>2</code>.</p>
<p><strong><code>s2s_max_retry_delay: Seconds</code></strong>:   The maximum allowed delay for retry to connect after a failed
 connection attempt. Specified in seconds. The default value is 300
 seconds (5 minutes).</p>
<p><strong><code>s2s_tls_compression: true|false</code></strong>:   Whether to enable or disable TLS compression for s2s connections.
 The default value is <code>false</code>.</p>
<p><strong><code>trusted_proxies: all | [IpString]</code></strong>:   Specify what proxies are trusted when an HTTP request contains the
 header <code>X-Forwarded-For</code> You can specify <code>all</code> to allow all proxies,
 or specify a list of IPs in string format. The default value is:
 <code>["127.0.0.1"]</code>. This allows, if enabled, to be able to know the real IP of the request, for admin purpose,
 or security configuration (for example using <a href="#mod_fail2ban">mod_fail2ban</a>)).
 <strong>Important:</strong> The proxy MUST be configured to set the <code>X-Forwarded-For</code> header if you enable this option as,
 otherwise, the client can set it itself and as a result the IP value cannot be trusted for security rules in
 ejabberd.</p>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<p>For example, the following simple configuration defines:</p>
<ul>
<li>
<p>There are three domains. The default certificate file is <code>server.pem</code>. However, the c2s and s2s connections to the domain
 <code>example.com</code> use the file <code>example_com.pem</code>.</p>
</li>
<li>
<p>Port 5222 listens for c2s connections with STARTTLS, and also allows plain connections for old clients.</p>
</li>
<li>
<p>Port 5223 listens for c2s connections with the old SSL.</p>
</li>
<li>
<p>Port 5269 listens for s2s connections with STARTTLS. The socket is set for IPv6 instead of IPv4.</p>
</li>
<li>
<p>Port 3478 listens for STUN requests over UDP.</p>
</li>
<li>
<p>Port 5280 listens for HTTP requests, and serves the HTTP-Bind (BOSH)  service.</p>
</li>
<li>
<p>Port 5281 listens for HTTP requests, using HTTPS to serve HTTP-Bind (BOSH) and the Web Admin as explained in <a href="../../admin/guide/managing/#web_admin">Managing: Web Admin</a>.
The socket only listens connections to the IP address 127.0.0.1.</p>
</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="w">   </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.com</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.org</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.net</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">   </span><span class="nt">certfiles</span><span class="p">:</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/ejabberd/server.pem</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/ejabberd/example_com.pem</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">   </span><span class="nt">listen</span><span class="p">:</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5222</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_c2s</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">       </span><span class="nt">access</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c2s</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">       </span><span class="nt">shaper</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c2s_shaper</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">       </span><span class="nt">starttls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">       </span><span class="nt">max_stanza_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65536</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5223</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_c2s</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">       </span><span class="nt">access</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c2s</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="w">       </span><span class="nt">shaper</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c2s_shaper</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="w">       </span><span class="nt">tls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="w">       </span><span class="nt">max_stanza_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">65536</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5269</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="w">       </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;::&quot;</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_s2s_in</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="w">       </span><span class="nt">shaper</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s2s_shaper</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="w">       </span><span class="nt">max_stanza_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">131072</span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3478</span>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="w">       </span><span class="nt">transport</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_stun</span>
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5280</span>
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_http</span>
</span><span id="__span-9-38"><a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a><span class="w">       </span><span class="nt">request_handlers</span><span class="p">:</span>
</span><span id="__span-9-39"><a id="__codelineno-9-39" name="__codelineno-9-39" href="#__codelineno-9-39"></a><span class="w">         </span><span class="nt">/bosh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mod_bosh</span>
</span><span id="__span-9-40"><a id="__codelineno-9-40" name="__codelineno-9-40" href="#__codelineno-9-40"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-9-41"><a id="__codelineno-9-41" name="__codelineno-9-41" href="#__codelineno-9-41"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5281</span>
</span><span id="__span-9-42"><a id="__codelineno-9-42" name="__codelineno-9-42" href="#__codelineno-9-42"></a><span class="w">       </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
</span><span id="__span-9-43"><a id="__codelineno-9-43" name="__codelineno-9-43" href="#__codelineno-9-43"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_http</span>
</span><span id="__span-9-44"><a id="__codelineno-9-44" name="__codelineno-9-44" href="#__codelineno-9-44"></a><span class="w">       </span><span class="nt">tls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-9-45"><a id="__codelineno-9-45" name="__codelineno-9-45" href="#__codelineno-9-45"></a><span class="w">       </span><span class="nt">request_handlers</span><span class="p">:</span>
</span><span id="__span-9-46"><a id="__codelineno-9-46" name="__codelineno-9-46" href="#__codelineno-9-46"></a><span class="w">         </span><span class="nt">/admin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_web_admin</span>
</span><span id="__span-9-47"><a id="__codelineno-9-47" name="__codelineno-9-47" href="#__codelineno-9-47"></a><span class="w">         </span><span class="nt">/bosh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mod_bosh</span>
</span><span id="__span-9-48"><a id="__codelineno-9-48" name="__codelineno-9-48" href="#__codelineno-9-48"></a>
</span><span id="__span-9-49"><a id="__codelineno-9-49" name="__codelineno-9-49" href="#__codelineno-9-49"></a><span class="w">   </span><span class="nt">s2s_use_starttls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">optional</span>
</span><span id="__span-9-50"><a id="__codelineno-9-50" name="__codelineno-9-50" href="#__codelineno-9-50"></a><span class="w">   </span><span class="nt">outgoing_s2s_families</span><span class="p">:</span>
</span><span id="__span-9-51"><a id="__codelineno-9-51" name="__codelineno-9-51" href="#__codelineno-9-51"></a><span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ipv4</span>
</span><span id="__span-9-52"><a id="__codelineno-9-52" name="__codelineno-9-52" href="#__codelineno-9-52"></a><span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ipv6</span>
</span><span id="__span-9-53"><a id="__codelineno-9-53" name="__codelineno-9-53" href="#__codelineno-9-53"></a><span class="w">   </span><span class="nt">outgoing_s2s_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
</span><span id="__span-9-54"><a id="__codelineno-9-54" name="__codelineno-9-54" href="#__codelineno-9-54"></a><span class="w">   </span><span class="nt">trusted_proxies</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">127.0.0.1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">192.168.1.11</span><span class="p p-Indicator">]</span>
</span></code></pre></div>
<p>In this example, the following configuration defines that:</p>
<ul>
<li>
<p>c2s connections are listened for on port 5222 (all IPv4 addresses)
 and on port 5223 (SSL, IP 192.168.0.1 and fdca:8ab6:a243:75ef::1)
 and denied for the user called ‘<code>bad</code>’.</p>
</li>
<li>
<p>s2s connections are listened for on port 5269 (all IPv4 addresses)
 with STARTTLS for secured traffic strictly required, and the
 certificates are verified. Incoming and outgoing connections of
 remote XMPP servers are denied, only two servers can connect:
 “jabber.example.org” and “example.com”.</p>
</li>
<li>
<p>Port 5280 is serving the Web Admin and the HTTP-Bind (BOSH) service in
 all the IPv4 addresses. Note that it is also possible to serve them
 on different ports. The second example in section <a href="../../admin/guide/managing/#web_admin">Managing: Web Admin</a> shows
 how exactly this can be done. A request handler to serve MQTT over Websocket is also defined.</p>
</li>
<li>
<p>All users except for the administrators have a traffic of limit
 1,000Bytes/second</p>
</li>
<li>
<p>The <a href="https://ejabberd.im/pyaimt"><code>AIM transport</code></a>
 <code>aim.example.org</code> is connected to port 5233 on localhost IP
 addresses (127.0.0.1 and ::1) with password ‘<code>aimsecret</code>’.</p>
</li>
<li>
<p>The ICQ transport JIT (<code>icq.example.org</code> and <code>sms.example.org</code>) is
 connected to port 5234 with password ‘<code>jitsecret</code>’.</p>
</li>
<li>
<p>The <a href="https://ejabberd.im/pymsnt"><code>MSN transport</code></a>
 <code>msn.example.org</code> is connected to port 5235 with password
 ‘<code>msnsecret</code>’.</p>
</li>
<li>
<p>The <a href="https://ejabberd.im/yahoo-transport-2"><code>Yahoo! transport</code></a>
 <code>yahoo.example.org</code> is connected to port 5236 with password
 ‘<code>yahoosecret</code>’.</p>
</li>
<li>
<p>The
 <a href="https://ejabberd.im/jabber-gg-transport"><code>Gadu-Gadu transport</code></a>
 <code>gg.example.org</code> is connected to port 5237 with password
 ‘<code>ggsecret</code>’.</p>
</li>
<li>
<p>The <a href="https://ejabberd.im/jmc"><code>Jabber Mail Component</code></a>
 <code>jmc.example.org</code> is connected to port 5238 with password
 ‘<code>jmcsecret</code>’.</p>
</li>
<li>
<p>The service custom has enabled the special option to avoiding
 checking the <code>from</code> attribute in the packets send by this component.
 The component can send packets in behalf of any users from the
 server, or even on behalf of any server.</p>
</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="w">   </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">     </span><span class="nt">blocked</span><span class="p">:</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">       </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bad</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">     </span><span class="nt">trusted_servers</span><span class="p">:</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">       </span><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.com</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jabber.example.org</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">     </span><span class="nt">xmlrpc_bot</span><span class="p">:</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">       </span><span class="nt">user</span><span class="p">:</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xmlrpc-robot@example.org</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">   </span><span class="nt">shaper</span><span class="p">:</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">     </span><span class="nt">normal</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">   </span><span class="nt">shaper_rules</span><span class="p">:</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">     </span><span class="nt">c2s_shaper</span><span class="p">:</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">       </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">none</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">       </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">normal</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">   </span><span class="nt">access_rules</span><span class="p">:</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">     </span><span class="nt">c2s</span><span class="p">:</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">       </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">deny</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">blocked</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">       </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">allow</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">     </span><span class="nt">xmlrpc_access</span><span class="p">:</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">       </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">allow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xmlrpc_bot</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">     </span><span class="nt">s2s</span><span class="p">:</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">       </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">allow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">trusted_servers</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">   </span><span class="nt">certfiles</span><span class="p">:</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="w">     </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/path/to/ssl.pem</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a><span class="w">   </span><span class="nt">s2s_access</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">s2s</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="w">   </span><span class="nt">s2s_use_starttls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">required_trusted</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">   </span><span class="nt">listen</span><span class="p">:</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5222</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_c2s</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="w">       </span><span class="nt">shaper</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c2s_shaper</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="w">       </span><span class="nt">access</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c2s</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="w">       </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.0.1</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5223</span>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_c2s</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="w">       </span><span class="nt">tls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a><span class="w">       </span><span class="nt">access</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c2s</span>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a><span class="w">       </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;FDCA:8AB6:A243:75EF::1&quot;</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5223</span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_c2s</span>
</span><span id="__span-10-45"><a id="__codelineno-10-45" name="__codelineno-10-45" href="#__codelineno-10-45"></a><span class="w">       </span><span class="nt">tls</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-10-46"><a id="__codelineno-10-46" name="__codelineno-10-46" href="#__codelineno-10-46"></a><span class="w">       </span><span class="nt">access</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c2s</span>
</span><span id="__span-10-47"><a id="__codelineno-10-47" name="__codelineno-10-47" href="#__codelineno-10-47"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-48"><a id="__codelineno-10-48" name="__codelineno-10-48" href="#__codelineno-10-48"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5269</span>
</span><span id="__span-10-49"><a id="__codelineno-10-49" name="__codelineno-10-49" href="#__codelineno-10-49"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_s2s_in</span>
</span><span id="__span-10-50"><a id="__codelineno-10-50" name="__codelineno-10-50" href="#__codelineno-10-50"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-51"><a id="__codelineno-10-51" name="__codelineno-10-51" href="#__codelineno-10-51"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5280</span>
</span><span id="__span-10-52"><a id="__codelineno-10-52" name="__codelineno-10-52" href="#__codelineno-10-52"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_http</span>
</span><span id="__span-10-53"><a id="__codelineno-10-53" name="__codelineno-10-53" href="#__codelineno-10-53"></a><span class="w">       </span><span class="nt">request_handlers</span><span class="p">:</span>
</span><span id="__span-10-54"><a id="__codelineno-10-54" name="__codelineno-10-54" href="#__codelineno-10-54"></a><span class="w">         </span><span class="nt">/admin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_web_admin</span>
</span><span id="__span-10-55"><a id="__codelineno-10-55" name="__codelineno-10-55" href="#__codelineno-10-55"></a><span class="w">         </span><span class="nt">/bosh</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mod_bosh</span>
</span><span id="__span-10-56"><a id="__codelineno-10-56" name="__codelineno-10-56" href="#__codelineno-10-56"></a><span class="w">                              </span><span class="l l-Scalar l-Scalar-Plain">/mqtt</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mod_mqtt</span>
</span><span id="__span-10-57"><a id="__codelineno-10-57" name="__codelineno-10-57" href="#__codelineno-10-57"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-58"><a id="__codelineno-10-58" name="__codelineno-10-58" href="#__codelineno-10-58"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4560</span>
</span><span id="__span-10-59"><a id="__codelineno-10-59" name="__codelineno-10-59" href="#__codelineno-10-59"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_xmlrpc</span>
</span><span id="__span-10-60"><a id="__codelineno-10-60" name="__codelineno-10-60" href="#__codelineno-10-60"></a><span class="w">       </span><span class="nt">access_commands</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</span><span id="__span-10-61"><a id="__codelineno-10-61" name="__codelineno-10-61" href="#__codelineno-10-61"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-62"><a id="__codelineno-10-62" name="__codelineno-10-62" href="#__codelineno-10-62"></a><span class="w">       </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1</span>
</span><span id="__span-10-63"><a id="__codelineno-10-63" name="__codelineno-10-63" href="#__codelineno-10-63"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5233</span>
</span><span id="__span-10-64"><a id="__codelineno-10-64" name="__codelineno-10-64" href="#__codelineno-10-64"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_service</span>
</span><span id="__span-10-65"><a id="__codelineno-10-65" name="__codelineno-10-65" href="#__codelineno-10-65"></a><span class="w">       </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-10-66"><a id="__codelineno-10-66" name="__codelineno-10-66" href="#__codelineno-10-66"></a><span class="w">         </span><span class="nt">aim.example.org</span><span class="p">:</span>
</span><span id="__span-10-67"><a id="__codelineno-10-67" name="__codelineno-10-67" href="#__codelineno-10-67"></a><span class="w">           </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aimsecret</span>
</span><span id="__span-10-68"><a id="__codelineno-10-68" name="__codelineno-10-68" href="#__codelineno-10-68"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-69"><a id="__codelineno-10-69" name="__codelineno-10-69" href="#__codelineno-10-69"></a><span class="w">       </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;::1&quot;</span>
</span><span id="__span-10-70"><a id="__codelineno-10-70" name="__codelineno-10-70" href="#__codelineno-10-70"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5233</span>
</span><span id="__span-10-71"><a id="__codelineno-10-71" name="__codelineno-10-71" href="#__codelineno-10-71"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_service</span>
</span><span id="__span-10-72"><a id="__codelineno-10-72" name="__codelineno-10-72" href="#__codelineno-10-72"></a><span class="w">       </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-10-73"><a id="__codelineno-10-73" name="__codelineno-10-73" href="#__codelineno-10-73"></a><span class="w">         </span><span class="nt">aim.example.org</span><span class="p">:</span>
</span><span id="__span-10-74"><a id="__codelineno-10-74" name="__codelineno-10-74" href="#__codelineno-10-74"></a><span class="w">           </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aimsecret</span>
</span><span id="__span-10-75"><a id="__codelineno-10-75" name="__codelineno-10-75" href="#__codelineno-10-75"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-76"><a id="__codelineno-10-76" name="__codelineno-10-76" href="#__codelineno-10-76"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5234</span>
</span><span id="__span-10-77"><a id="__codelineno-10-77" name="__codelineno-10-77" href="#__codelineno-10-77"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_service</span>
</span><span id="__span-10-78"><a id="__codelineno-10-78" name="__codelineno-10-78" href="#__codelineno-10-78"></a><span class="w">       </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-10-79"><a id="__codelineno-10-79" name="__codelineno-10-79" href="#__codelineno-10-79"></a><span class="w">         </span><span class="nt">icq.example.org</span><span class="p">:</span>
</span><span id="__span-10-80"><a id="__codelineno-10-80" name="__codelineno-10-80" href="#__codelineno-10-80"></a><span class="w">           </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jitsecret</span>
</span><span id="__span-10-81"><a id="__codelineno-10-81" name="__codelineno-10-81" href="#__codelineno-10-81"></a><span class="w">         </span><span class="nt">sms.example.org</span><span class="p">:</span>
</span><span id="__span-10-82"><a id="__codelineno-10-82" name="__codelineno-10-82" href="#__codelineno-10-82"></a><span class="w">           </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jitsecret</span>
</span><span id="__span-10-83"><a id="__codelineno-10-83" name="__codelineno-10-83" href="#__codelineno-10-83"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-84"><a id="__codelineno-10-84" name="__codelineno-10-84" href="#__codelineno-10-84"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5235</span>
</span><span id="__span-10-85"><a id="__codelineno-10-85" name="__codelineno-10-85" href="#__codelineno-10-85"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_service</span>
</span><span id="__span-10-86"><a id="__codelineno-10-86" name="__codelineno-10-86" href="#__codelineno-10-86"></a><span class="w">       </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-10-87"><a id="__codelineno-10-87" name="__codelineno-10-87" href="#__codelineno-10-87"></a><span class="w">         </span><span class="nt">msn.example.org</span><span class="p">:</span>
</span><span id="__span-10-88"><a id="__codelineno-10-88" name="__codelineno-10-88" href="#__codelineno-10-88"></a><span class="w">           </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">msnsecret</span>
</span><span id="__span-10-89"><a id="__codelineno-10-89" name="__codelineno-10-89" href="#__codelineno-10-89"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-90"><a id="__codelineno-10-90" name="__codelineno-10-90" href="#__codelineno-10-90"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5236</span>
</span><span id="__span-10-91"><a id="__codelineno-10-91" name="__codelineno-10-91" href="#__codelineno-10-91"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_service</span>
</span><span id="__span-10-92"><a id="__codelineno-10-92" name="__codelineno-10-92" href="#__codelineno-10-92"></a><span class="w">       </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yahoosecret</span>
</span><span id="__span-10-93"><a id="__codelineno-10-93" name="__codelineno-10-93" href="#__codelineno-10-93"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-94"><a id="__codelineno-10-94" name="__codelineno-10-94" href="#__codelineno-10-94"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5237</span>
</span><span id="__span-10-95"><a id="__codelineno-10-95" name="__codelineno-10-95" href="#__codelineno-10-95"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_service</span>
</span><span id="__span-10-96"><a id="__codelineno-10-96" name="__codelineno-10-96" href="#__codelineno-10-96"></a><span class="w">       </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-10-97"><a id="__codelineno-10-97" name="__codelineno-10-97" href="#__codelineno-10-97"></a><span class="w">         </span><span class="nt">gg.example.org</span><span class="p">:</span>
</span><span id="__span-10-98"><a id="__codelineno-10-98" name="__codelineno-10-98" href="#__codelineno-10-98"></a><span class="w">           </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ggsecret</span>
</span><span id="__span-10-99"><a id="__codelineno-10-99" name="__codelineno-10-99" href="#__codelineno-10-99"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-100"><a id="__codelineno-10-100" name="__codelineno-10-100" href="#__codelineno-10-100"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5238</span>
</span><span id="__span-10-101"><a id="__codelineno-10-101" name="__codelineno-10-101" href="#__codelineno-10-101"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_service</span>
</span><span id="__span-10-102"><a id="__codelineno-10-102" name="__codelineno-10-102" href="#__codelineno-10-102"></a><span class="w">       </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-10-103"><a id="__codelineno-10-103" name="__codelineno-10-103" href="#__codelineno-10-103"></a><span class="w">         </span><span class="nt">jmc.example.org</span><span class="p">:</span>
</span><span id="__span-10-104"><a id="__codelineno-10-104" name="__codelineno-10-104" href="#__codelineno-10-104"></a><span class="w">           </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jmcsecret</span>
</span><span id="__span-10-105"><a id="__codelineno-10-105" name="__codelineno-10-105" href="#__codelineno-10-105"></a><span class="w">     </span><span class="p p-Indicator">-</span>
</span><span id="__span-10-106"><a id="__codelineno-10-106" name="__codelineno-10-106" href="#__codelineno-10-106"></a><span class="w">       </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5239</span>
</span><span id="__span-10-107"><a id="__codelineno-10-107" name="__codelineno-10-107" href="#__codelineno-10-107"></a><span class="w">       </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_service</span>
</span><span id="__span-10-108"><a id="__codelineno-10-108" name="__codelineno-10-108" href="#__codelineno-10-108"></a><span class="w">       </span><span class="nt">check_from</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-10-109"><a id="__codelineno-10-109" name="__codelineno-10-109" href="#__codelineno-10-109"></a><span class="w">       </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-10-110"><a id="__codelineno-10-110" name="__codelineno-10-110" href="#__codelineno-10-110"></a><span class="w">         </span><span class="nt">custom.example.org</span><span class="p">:</span>
</span><span id="__span-10-111"><a id="__codelineno-10-111" name="__codelineno-10-111" href="#__codelineno-10-111"></a><span class="w">           </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">customsecret</span>
</span></code></pre></div>
<p>Note, that for services based in jabberd14 or WPJabber you have to make
the transports log and do XDB by themselves:</p>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="w"> </span><span class="cm">&lt;!--</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="cm">       You have to add elogger and rlogger entries here when using ejabberd.</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="cm">       In this case the transport will do the logging.</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="cm">    --&gt;</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w"> </span><span class="nt">&lt;log</span><span class="w"> </span><span class="na">id=</span><span class="s">&#39;logger&#39;</span><span class="nt">&gt;</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">   </span><span class="nt">&lt;host/&gt;</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">   </span><span class="nt">&lt;logtype/&gt;</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">   </span><span class="nt">&lt;format&gt;</span>%d:<span class="w"> </span>[%t]<span class="w"> </span>(%h):<span class="w"> </span>%s<span class="nt">&lt;/format&gt;</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">   </span><span class="nt">&lt;file&gt;</span>/var/log/jabber/service.log<span class="nt">&lt;/file&gt;</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w"> </span><span class="nt">&lt;/log&gt;</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w"> </span><span class="cm">&lt;!--</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="cm">       Some XMPP server implementations do not provide</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="cm">       XDB services (for example, jabberd2 and ejabberd).</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="cm">       xdb_file.so is loaded in to handle all XDB requests.</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="cm">    --&gt;</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="w"> </span><span class="nt">&lt;xdb</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;xdb&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="w">   </span><span class="nt">&lt;host/&gt;</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="w">   </span><span class="nt">&lt;load&gt;</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="w">     </span><span class="cm">&lt;!-- this is a lib of wpjabber or jabberd14 --&gt;</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="w">     </span><span class="nt">&lt;xdb_file&gt;</span>/usr/lib/jabber/xdb_file.so<span class="nt">&lt;/xdb_file&gt;</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="w">     </span><span class="nt">&lt;/load&gt;</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="w">   </span><span class="nt">&lt;xdb_file</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;jabber:config:xdb_file&quot;</span><span class="nt">&gt;</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="w">     </span><span class="nt">&lt;spool&gt;&lt;jabberd:cmdline</span><span class="w"> </span><span class="na">flag=</span><span class="s">&#39;s&#39;</span><span class="nt">&gt;</span>/var/spool/jabber<span class="nt">&lt;/jabberd:cmdline&gt;&lt;/spool&gt;</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a><span class="w">   </span><span class="nt">&lt;/xdb_file&gt;</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="w"> </span><span class="nt">&lt;/xdb&gt;</span>
</span></code></pre></div>
<h3 id="acme">ACME<a class="headerlink" href="#acme" title="Permanent link">&para;</a></h3>
<p><a href="https://tools.ietf.org/html/rfc8555">ACME</a> is used to automatically obtain SSL certificates for the domains served by ejabberd, which means that certificate requests and renewals are performed to some CA server (aka "ACME server")
in a fully automated mode. The automated mode is enabled by default.
However, since ACME requires HTTP challenges (i.e. an ACME server will connect to ejabberd server on HTTP port 80 during certificate issuance), some configuration of ejabberd is still required. Namely, an HTTP listener for <code>ejabberd_http</code> module should be configured on non-TLS port with so called "ACME well known" request handler:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="w">    </span><span class="nt">listen</span><span class="p">:</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">-</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">module</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_http</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">port</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5280</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">request_handlers</span><span class="p p-Indicator">:</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">          </span><span class="nt">/.well-known/acme-challenge</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_acme</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">          </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span></code></pre></div>
<p>Note that the ACME protocol <strong>requires</strong> challenges to be sent on port 80. Since this is a privileged
port, ejabberd cannot listen on it directly without root privileges. Thus you need some mechanism
to forward port 80 to the port defined by the listener (port 5280 in the example above). There are
several ways to do this: using NAT, setcap (Linux only), or HTTP front-ends (e.g. <code>sslh</code>, <code>nginx</code>,
<code>haproxy</code> and so on). Pick one that fits your installation the best, but <strong>DON'T</strong> run ejabberd as root.</p>
<p>If you see errors in the logs with ACME server problem reports, it's <strong>highly</strong> recommended to change <code>ca_url</code>
option of section <code>acme</code> to the URL pointing to some staging ACME environment, fix the problems until you obtain
a certificate, and then change the URL back and retry using <code>request-certificate</code> ejabberdctl command
(see below). This is needed because ACME servers typically have rate limits, preventing you from requesting
certificates too rapidly and you can get stuck for several hours or even days.
By default, ejabberd uses <a href="https://letsencrypt.org">Let's Encrypt</a> authority.
Thus, the default value of <code>ca_url</code> option is <code>https://acme-v02.api.letsencrypt.org/directory</code>
and the staging URL will be <code>https://acme-staging-v02.api.letsencrypt.org/directory</code>:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="w">    </span><span class="nt">acme</span><span class="p">:</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">      </span><span class="c1">## Staging environment</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">      </span><span class="nt">ca_url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://acme-staging-v02.api.letsencrypt.org/directory</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">      </span><span class="c1">## Production environment (the default):</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">      </span><span class="c1"># ca_url: https://acme-v02.api.letsencrypt.org/directory</span>
</span></code></pre></div>
<p>The automated mode can be disabled by setting <code>auto</code> option of section <code>acme</code> to <code>false</code>:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="w">    </span><span class="nt">acme</span><span class="p">:</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">      </span><span class="nt">auto</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span></code></pre></div>
<p>In this case automated renewals are still enabled, however, in order to request a new certificate,
you need to run <code>request-certificate</code> ejabberdctl command:</p>
<div class="language-text highlight"><pre><span></span><code>`$ ejabberdctl request-certificate all`
</code></pre></div>
<p>If you only want to request certificates for a subset of the domains, run:</p>
<div class="language-text highlight"><pre><span></span><code>`$ ejabberdctl request-certificate domain.tld,pubsub.domain.tld,server.com,conference.server.com,...`
</code></pre></div>
<p>You can view the certificates obtained using ACME:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="w">    </span>$<span class="w"> </span>ejabberdctl<span class="w"> </span>list-certificates
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span>domain.tld<span class="w"> </span>/path/to/cert/file1<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span>server.com<span class="w"> </span>/path/to/cert/file2<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span>...
</span></code></pre></div>
<p>The output is mostly self-explained: every line contains the domain, the corresponding certificate file,
and whether this certificate file is used or not. A certificate might not be used for several reasons:
mostly because ejabberd detects a better certificate (i.e. not expired, or having a longer lifetime).
It's recommended to revoke unused certificates if they are not yet expired (see below).</p>
<p>At any point you can revoke a certificate: pick the certificate file from the listing above and run:</p>
<p><code>$ ejabberdctl revoke-certificate /path/to/cert/file</code></p>
<p>If the commands return errors, consult the log files for details.</p>
<h3 id="available-acme-options">Available ACME options<a class="headerlink" href="#available-acme-options" title="Permanent link">&para;</a></h3>
<p><strong><code>ca_url</code></strong>: The ACME directory URL used as an entry point for the ACME server.
   The default value is <code>https://acme-v02.api.letsencrypt.org/directory</code> - the
   directory URL of <a href="https://letsencrypt.org">Let's Encrypt</a> authority.</p>
<p><strong><code>contact</code></strong>: A list of contact addresses (typically emails) where an ACME server
   will send notifications when problems occur. The default is an empty list which
   means an ACME server will send no notices.</p>
<p><strong><code>auto</code></strong>: Whether to automatically request certificates for all configured domains
   (that yet have no a certificate) on server start or configuration reload.
   The default is <code>true</code>.</p>
<p><strong><code>cert_type</code></strong>: A type of a certificate key. Available values are <code>ec</code> and <code>rsa</code>
   for EC and RSA certificates respectively. It's better to have RSA certificates
   for the purpose of backward compatibility with legacy clients and servers,
   thus the default is <code>rsa</code>.</p>
<p>Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="w">    </span><span class="nt">acme</span><span class="p">:</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">      </span><span class="nt">ca_url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://acme-v02.api.letsencrypt.org/directory</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">      </span><span class="nt">contact</span><span class="p">:</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mailto:admin@domain.tld</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mailto:bot@domain.tld</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">      </span><span class="nt">auto</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">      </span><span class="nt">cert_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rsa</span>
</span></code></pre></div>
<h4 id="acme-implementation-details">ACME implementation details<a class="headerlink" href="#acme-implementation-details" title="Permanent link">&para;</a></h4>
<p>In nutshell, certification requests are performed in two phases. Firstly, ejabberd
creates an account at the ACME server. That is an EC private key. Secondly,
a certificate is requested. In the case of a revocation, no account is
used - only a cerificate in question is needed. All information is stored under
<code>acme</code> directory inside spool directory of ejabberd (typically <code>/var/lib/ejabberd</code>).
An example content of the directory is the following:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>$<span class="w"> </span>tree<span class="w"> </span>/var/lib/ejabberd
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>/var/lib/ejabberd
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>├──<span class="w"> </span>acme
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>│<span class="w">   </span>├──<span class="w"> </span>account.key
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>│<span class="w">   </span>└──<span class="w"> </span>live
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>│<span class="w">       </span>├──<span class="w"> </span>251ce180d964e98a2f18b65504df2ab7c55943e2
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>│<span class="w">       </span>└──<span class="w"> </span>93816a8429ebbaa75574eb3f59d4a806b67d6917
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>...
</span></code></pre></div>
<p>Here, <code>account.key</code> is the EC private key used to identify the ACME account.
You can inspect its content using <code>openssl</code> command:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>openssl<span class="w"> </span>ec<span class="w"> </span>-text<span class="w"> </span>-noout<span class="w"> </span>-in<span class="w"> </span>/var/lib/ejabberd/acme/account.key
</span></code></pre></div>
<p>Obtained certificates are stored under <code>acme/live</code> directory.
You can inspect any of the certificates using <code>openssl</code> command as well:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>openssl<span class="w"> </span>x509<span class="w"> </span>-text<span class="w"> </span>-noout<span class="w"> </span>-in<span class="w"> </span>/var/lib/ejabberd/acme/live/251ce180d964e98a2f18b65504df2ab7c55943e2
</span></code></pre></div>
<p>In the case of errors, you can delete the whole <code>acme</code> directory - ejabberd
will recreate its content on next certification request. However, don't delete it
too frequently - usually there is a rate limit on the number of accounts and
certificates an ACME server creates. In particular, for <a href="https://letsencrypt.org">Let's Encrypt</a>
the limits are described <a href="https://letsencrypt.org/docs/rate-limits">here</a>.</p>
<h2 id="authentication">Authentication<a class="headerlink" href="#authentication" title="Permanent link">&para;</a></h2>
<p>The option <code>auth_method</code> defines the authentication methods that are
used for user authentication. The syntax is:</p>
<p><code>[Method, ...]</code> :</p>
<p>The following authentication methods are supported by <code>ejabberd</code>:</p>
<ul>
<li>
<p>internal — See section <a href="#internal">Internal</a>.</p>
</li>
<li>
<p>external — See section <a href="#external-script">External Script</a>.</p>
</li>
<li>
<p>ldap — See section  <a href="#ldap">LDAP</a>.</p>
</li>
<li>
<p>sql — See section <a href="#relational-databases">Relational Databases</a>.</p>
</li>
<li>
<p>anonymous — See section <a href="#anonymous-login-and-sasl-anonymous">Anonymous Login and SASL Anonymous</a>.</p>
</li>
<li>
<p>pam — See section <a href="#pam-authentication">Pam Authentication</a>.</p>
</li>
</ul>
<p>When the option is omitted, ejabberd will rely upon the default database which is configured in <code>default_db</code> option. If this option is not set neither the default authentication method will be <code>internal</code>.</p>
<p>Account creation is only supported by internal, external and sql methods.</p>
<p>The option <code>resource_conflict</code> defines the action when a client attempts
to login to an account with a resource that is already connected. The
option syntax is:</p>
<p><strong><code>resource_conflict: setresource|closenew|closeold</code></strong>:  The possible values match exactly the three possibilities described in
<a href="https://tools.ietf.org/html/rfc6120#section-7.7.2.2"><code>XMPP Core: section 7.7.2.2</code></a>.
The default value is <code>closeold</code>. If the client uses old Jabber Non-SASL
authentication (<a href="https://xmpp.org/extensions/xep-0078.html"><code>XEP-0078</code></a>),
then this option is not respected, and the action performed is
<code>closeold</code>.</p>
<p><strong><code>fqdn: undefined|FqdnString|[FqdnString]</code></strong>:
Allows you to define the Fully Qualified Domain Name
of the machine, in case it isn't detected automatically. The FQDN is
used to authenticate some clients that use the DIGEST-MD5 SASL
mechanism.</p>
<p><strong><code>disable_sasl_mechanisms: Mechanism|[Mechanism, ...]</code></strong>:
Specify a list of SASL mechanisms
(such as "DIGEST-MD5", "SCRAM-SHA1" or "X-OAUTH2") that should <em>not</em> be offered to
the client. The mechanisms can be listed as lowercase or uppercase
strings.</p>
<h3 id="internal">Internal<a class="headerlink" href="#internal" title="Permanent link">&para;</a></h3>
<p><code>ejabberd</code> uses its internal Mnesia database as the default
authentication method. The value <code>internal</code> will enable the internal
authentication method.</p>
<p>The option <code>auth_password_format: plain|scram</code> defines in what format
the users passwords are stored:</p>
<p><strong><code>plain</code></strong>:   The password is stored as plain text in the database. This is risky
 because the passwords can be read if your database gets compromised.
 This is the default value. This format allows clients to
 authenticate using: the old Jabber Non-SASL
 (<a href="https://xmpp.org/extensions/xep-0078.html"><code>XEP-0078</code></a>),
 <code>SASL PLAIN</code>, <code>SASL DIGEST-MD5</code>, and <code>SASL SCRAM-SHA-1</code>.</p>
<p><strong><code>scram</code></strong>:   The password is not stored, only some information that allows to
 verify the hash provided by the client. It is impossible to obtain
 the original plain password from the stored information; for this
 reason, when this value is configured it cannot be changed to
 <code>plain</code> anymore. This format allows clients to authenticate using:
 <code>SASL PLAIN</code> and <code>SASL SCRAM-SHA-1</code>.</p>
<p>For details about the client-server communication when using SCRAM-SHA-1,
refer to <a href="https://wiki.xmpp.org/web/SASLandSCRAM-SHA-1">SASL and SCRAM-SHA-1</a>.</p>
<p>When you enable SCRAM password format for internal storage, if you try
to authenticate a user that had their password already stored in plain
text, their password will be automatically converted to SCRAM format. It
means database is converted as you use it.</p>
<p>If you want to convert your Mnesia database all at once, you can look
into the Erlang function:
<code>ejabberd_auth_internal:maybe_scram_passwords/0</code>.</p>
<p>Examples:</p>
<ul>
<li>To use internal authentication on <code>example.org</code> and LDAP
 authentication on <code>example.net</code>:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="w">  </span><span class="nt">host_config</span><span class="p">:</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">    </span><span class="nt">example.org</span><span class="p">:</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">      </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">internal</span><span class="p p-Indicator">]</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">    </span><span class="nt">example.net</span><span class="p">:</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">      </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">ldap</span><span class="p p-Indicator">]</span>
</span></code></pre></div>
<ul>
<li>To use internal authentication with hashed passwords on all virtual
 hosts:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="w">  </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">  </span><span class="nt">auth_password_format</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scram</span>
</span></code></pre></div>
<p><em>Note on SCRAM using and foreign authentication limitations</em>: when using the SCRAM password format, it is not possible to use foreign authentication method in ejabberd, as the real password is not known,
Foreign authentication are use to authenticate through various bridges ejabberd provide.
Foreign authentication includes at the moment SIP and TURN auth support and they will not be working with SCRAM.</p>
<h4 id="external-script">External Script<a class="headerlink" href="#external-script" title="Permanent link">&para;</a></h4>
<p>In this authentication method, when <code>ejabberd</code> starts, it start a script, and calls it to perform authentication tasks.</p>
<p>The server administrator can write the external authentication script in any language. The details on the interface between ejabberd and the
script are described in the <code>ejabberd Developers Guide</code>. There are also <a href="https://ejabberd.im/extauth"><code>several example authentication scripts</code></a>.</p>
<p>These are the specific options:</p>
<p><strong><code>extauth_program: PathToScript</code></strong>:   Indicate in this option the full path to the external authentication
 script. The script must be executable by ejabberd.</p>
<p><strong><code>extauth_instances: Integer</code></strong>:   Indicate how many instances of the script to run simultaneously to
 serve authentication in the virtual host. The default value is the
 minimum number: 1.</p>
<p><strong><code>auth_use_cache: false|true</code></strong>:   Starting in <em>ejabberd 17.06</em>, caching has received a complete overhaul.
 Instead of <code>extauth_cache</code>, a set of new variables describes cache
 behaviour, and the default value is now <code>true</code>. Note that caching
 interferes with the ability to maintain multiple passwords per
 account. So if your authentication mechanism supports
 application-specific passwords, caching must be disabled.
 The options are called <code>auth_use_cache</code>, <code>auth_cache_missed</code>,
 <code>auth_cache_size</code>, <code>auth_cache_life_time</code>,
 and you can see details in the section <a href="#caching">Caching</a>.</p>
<p>This example sets external authentication, the extauth script, enables
caching for 10 minutes, and starts three instances of the script for
each virtual host defined in ejabberd:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="w"> </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">external</span><span class="p p-Indicator">]</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w"> </span><span class="nt">extauth_program</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/etc/ejabberd/JabberAuth.class.php</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w"> </span><span class="nt">extauth_instances</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w"> </span><span class="nt">auth_use_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span></code></pre></div>
<h3 id="anonymous-login-and-sasl-anonymous">Anonymous Login and SASL Anonymous<a class="headerlink" href="#anonymous-login-and-sasl-anonymous" title="Permanent link">&para;</a></h3>
<p>The <code>anonymous</code> authentication method enables two modes for anonymous
authentication:</p>
<p><strong><code>Anonymous login</code></strong>:   This is a standard login, that use the classical login and password
 mechanisms, but where password is accepted or preconfigured for all
 anonymous users. This login is compliant with SASL authentication,
 password and digest non-SASL authentication, so this option will
 work with almost all XMPP clients</p>
<p><strong><code>SASL Anonymous</code></strong>:   This is a special SASL authentication mechanism that allows to login
 without providing username or password (see
 <a href="https://xmpp.org/extensions/xep-0175.html"><code>XEP-0175</code></a>). The main
 advantage of SASL Anonymous is that the protocol was designed to
 give the user a login. This is useful to avoid in some case, where
 the server has many users already logged or registered and when it
 is hard to find a free username. The main disavantage is that you
 need a client that specifically supports the SASL Anonymous
 protocol.</p>
<p>The anonymous authentication method can be configured with the following
options. Remember that you can use the <code>host_config</code> option to set
virtual host specific options (see section <a href="#virtual-hosting">Virtual Hosting</a>).</p>
<p><strong><code>allow_multiple_connections: false|true</code></strong>:   This option is only used when the anonymous mode is enabled. Setting
 it to <code>true</code> means that the same username can be taken multiple
 times in anonymous login mode if different resource are used to
 connect. This option is only useful in very special occasions. The
 default value is <code>false</code>.</p>
<p><strong><code>anonymous_protocol: login_anon | sasl_anon | both</code></strong>:   <code>login_anon</code> means that the anonymous login method will be used.
 <code>sasl_anon</code> means that the SASL Anonymous method will be used.
 <code>both</code> means that SASL Anonymous and login anonymous are both
 enabled.</p>
<p>Those options are defined for each virtual host with the <code>host_config</code>
parameter (see section  <a href="#virtual-hosting">Virtual Hosting</a>).</p>
<p>Examples:</p>
<ul>
<li>To enable anonymous login on all virtual hosts:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="w">  </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">anonymous</span><span class="p p-Indicator">]</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span><span class="nt">anonymous_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">login_anon</span>
</span></code></pre></div>
<ul>
<li>Similar as previous example, but limited to <code>public.example.org</code>:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="w">  </span><span class="nt">host_config</span><span class="p">:</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">    </span><span class="nt">public.example.org</span><span class="p">:</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">      </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">anonymous</span><span class="p p-Indicator">]</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">      </span><span class="nt">anonymous_protoco</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">login_anon</span>
</span></code></pre></div>
<ul>
<li>To enable anonymous login and internal authentication on a virtual  host:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="w">  </span><span class="nt">host_config</span><span class="p">:</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">    </span><span class="nt">public.example.org</span><span class="p">:</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">      </span><span class="nt">auth_method</span><span class="p">:</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">anonymous</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="w">      </span><span class="nt">anonymous_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">login_anon</span>
</span></code></pre></div>
<ul>
<li>To enable SASL Anonymous on a virtual host:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="w">  </span><span class="nt">host_config</span><span class="p">:</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">    </span><span class="nt">public.example.org</span><span class="p">:</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">      </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">anonymous</span><span class="p p-Indicator">]</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">      </span><span class="nt">anonymous_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sasl_anon</span>
</span></code></pre></div>
<ul>
<li>To enable SASL Anonymous and anonymous login on a virtual host:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="w">  </span><span class="nt">host_config</span><span class="p">:</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">    </span><span class="nt">public.example.org</span><span class="p">:</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">      </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">anonymous</span><span class="p p-Indicator">]</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">      </span><span class="nt">anonymous_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">both</span>
</span></code></pre></div>
<ul>
<li>To enable SASL Anonymous, anonymous login, and internal authentication on a virtual host:</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="w">  </span><span class="nt">host_config</span><span class="p">:</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">    </span><span class="nt">public.example.org</span><span class="p">:</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">      </span><span class="nt">auth_method</span><span class="p">:</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">internal</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">anonymous</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="w">      </span><span class="nt">anonymous_protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">both</span>
</span></code></pre></div>
<p>There are more configuration examples and XMPP client example stanzas in <a href="https://ejabberd.im/Anonymous-users-support"><code>Anonymous users support</code></a>.</p>
<h4 id="pam-authentication">PAM Authentication<a class="headerlink" href="#pam-authentication" title="Permanent link">&para;</a></h4>
<p><code>ejabberd</code> supports authentication via Pluggable Authentication Modules
(PAM). PAM is currently supported in AIX, FreeBSD, HP-UX, Linux, Mac OS
X, NetBSD and Solaris. PAM authentication is disabled by default, so you
have to configure and compile <code>ejabberd</code> with PAM support enabled:</p>
<p><code>./configure --enable-pam &amp;&amp; make install</code></p>
<p>Options:</p>
<p><strong><code>pam_service: Name</code></strong>:   This option defines the PAM service name. Default is <code>ejabberd</code>.
 Refer to the PAM documentation of your operation system for more
 information.</p>
<p><strong><code>pam_userinfotype: username|jid</code></strong>:   This option defines what type of information about the user ejabberd
 provides to the PAM service: only the username, or the user JID.
 Default is <code>username</code>.</p>
<p>Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="w"> </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">pam</span><span class="p p-Indicator">]</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w"> </span><span class="nt">pam_service</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd</span>
</span></code></pre></div>
<p>Though it is quite easy to set up PAM support in <code>ejabberd</code>, PAM itself
introduces some security issues:</p>
<ul>
<li>To perform PAM authentication <code>ejabberd</code> uses external C-program
 called <code>epam</code>. By default, it is located in
 <code>/var/lib/ejabberd/priv/bin/</code> directory. You have to set it root on
 execution in the case when your PAM module requires root privileges
 (<code>pam_unix.so</code> for example). Also you have to grant access for
 <code>ejabberd</code> to this file and remove all other permissions from it.
 Execute with root privileges:</li>
</ul>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="w">  </span>chown<span class="w"> </span>root:ejabberd<span class="w"> </span>/var/lib/ejabberd/priv/bin/epam
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="w">  </span>chmod<span class="w"> </span><span class="m">4750</span><span class="w"> </span>/var/lib/ejabberd/priv/bin/epam
</span></code></pre></div>
<ul>
<li>
<p>Make sure you have the latest version of PAM installed on your
 system. Some old versions of PAM modules cause memory leaks. If you
 are not able to use the latest version, you can <code>kill(1)</code> <code>epam</code>
 process periodically to reduce its memory consumption: <code>ejabberd</code>
 will restart this process immediately.</p>
</li>
<li>
<p><code>epam</code> program tries to turn off delays on authentication failures.
 However, some PAM modules ignore this behavior and rely on their own
 configuration options. You can create a configuration file
 <code>ejabberd.pam</code>. This example shows how to turn off delays in
 <code>pam_unix.so</code> module:</p>
</li>
</ul>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="w">  </span><span class="c1">#%PAM-1.0</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="w">  </span>auth<span class="w">        </span>sufficient<span class="w">  </span>pam_unix.so<span class="w"> </span>likeauth<span class="w"> </span>nullok<span class="w"> </span>nodelay
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="w">  </span>account<span class="w">     </span>sufficient<span class="w">  </span>pam_unix.so
</span></code></pre></div>
<div class="language-text highlight"><pre><span></span><code>That is not a ready to use configuration file: you must use it as a
</code></pre></div>
<p>hint when building your own PAM configuration instead. Note that if
 you want to disable delays on authentication failures in the PAM
 configuration file, you have to restrict access to this file, so a
 malicious user can’t use your configuration to perform brute-force
 attacks.</p>
<ul>
<li>
<p>You may want to allow login access only for certain users.
 <code>pam_listfile.so</code> module provides such functionality.</p>
</li>
<li>
<p>If you use <code>pam_winbind</code> to authorise against a Windows Active
 Directory, then <code>/etc/nsswitch.conf</code> must be configured to use
 <code>winbind</code> as well.</p>
</li>
</ul>
<h3 id="jwt-authentication">JWT Authentication<a class="headerlink" href="#jwt-authentication" title="Permanent link">&para;</a></h3>
<p><code>ejabberd</code> supports authentication using JSON Web Token (JWT).  When enabled,
clients send signed tokens instead of passwords, which are checked using a
private key specified in the <code>jwt_key</code> option.  JWT payload must look like
this:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="w">      </span><span class="nt">&quot;jid&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;test@example.org&quot;</span><span class="p">,</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="w">      </span><span class="nt">&quot;exp&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1564436511</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="w"> </span><span class="err">```</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="err">Op</span><span class="kc">t</span><span class="err">io</span><span class="kc">ns</span><span class="p">:</span>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="err">**`jw</span><span class="kc">t</span><span class="err">_key</span><span class="p">:</span><span class="w"> </span><span class="err">Pa</span><span class="kc">t</span><span class="err">h`**</span><span class="p">:</span><span class="w">   </span><span class="err">Full</span><span class="w"> </span><span class="err">pa</span><span class="kc">t</span><span class="err">h</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="kc">f</span><span class="err">ile</span><span class="w"> </span><span class="err">co</span><span class="kc">nta</span><span class="err">i</span><span class="kc">n</span><span class="err">i</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">JWT</span><span class="w"> </span><span class="err">priva</span><span class="kc">te</span><span class="w"> </span><span class="err">key.</span>
</span><span id="__span-32-10"><a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>
</span><span id="__span-32-11"><a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="err">**`jw</span><span class="kc">t</span><span class="err">_au</span><span class="kc">t</span><span class="err">h_o</span><span class="kc">nl</span><span class="err">y_rule</span><span class="p">:</span><span class="w"> </span><span class="err">AccessName`**</span><span class="p">:</span><span class="w">   </span><span class="err">The</span><span class="w"> </span><span class="err">accou</span><span class="kc">nts</span><span class="w"> </span><span class="kc">t</span><span class="err">ha</span><span class="kc">t</span><span class="w"> </span><span class="err">ma</span><span class="kc">t</span><span class="err">ch</span><span class="w"> </span><span class="kc">t</span><span class="err">his</span><span class="w"> </span><span class="err">access</span><span class="w"> </span><span class="err">rule</span><span class="w"> </span><span class="err">ca</span><span class="kc">n</span><span class="w"> </span><span class="err">au</span><span class="kc">t</span><span class="err">he</span><span class="kc">nt</span><span class="err">ica</span><span class="kc">te</span><span class="w"> </span><span class="err">o</span><span class="kc">nl</span><span class="err">y</span><span class="w"> </span><span class="err">usi</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">JWT</span><span class="p">,</span><span class="w"> </span><span class="err">eve</span><span class="kc">n</span><span class="w"> </span><span class="err">i</span><span class="kc">f</span><span class="w"> </span><span class="err">ejabberd</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">co</span><span class="kc">nf</span><span class="err">igured</span><span class="w"> </span><span class="kc">t</span><span class="err">o</span><span class="w"> </span><span class="err">suppor</span><span class="kc">t</span><span class="w"> </span><span class="err">o</span><span class="kc">t</span><span class="err">her</span><span class="w"> </span><span class="err">au</span><span class="kc">t</span><span class="err">h</span><span class="w"> </span><span class="err">me</span><span class="kc">t</span><span class="err">hods</span><span class="w"> </span><span class="kc">t</span><span class="err">oo.</span>
</span><span id="__span-32-12"><a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>
</span><span id="__span-32-13"><a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="err">Example</span><span class="p">:</span>
</span><span id="__span-32-14"><a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a><span class="err">```</span><span class="w"> </span><span class="err">yaml</span>
</span><span id="__span-32-15"><a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a><span class="w"> </span><span class="err">au</span><span class="kc">t</span><span class="err">h_me</span><span class="kc">t</span><span class="err">hod</span><span class="p">:</span><span class="w"> </span><span class="err">jw</span><span class="kc">t</span>
</span><span id="__span-32-16"><a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a><span class="w"> </span><span class="err">jw</span><span class="kc">t</span><span class="err">_key</span><span class="p">:</span><span class="w"> </span><span class="err">/pa</span><span class="kc">t</span><span class="err">h/</span><span class="kc">t</span><span class="err">o/jw</span><span class="kc">t</span><span class="err">/key</span>
</span></code></pre></div>
<p>In this example, admins can use both JWT and plain passwords, while the rest of users can use only JWT.</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="w"> </span><span class="c1"># the order is important here, don&#39;t use [sql, jwt]</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="w"> </span><span class="nt">auth_method</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">jwt</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">sql</span><span class="p p-Indicator">]</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w"> </span><span class="nt">access_rules</span><span class="p">:</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a><span class="w">   </span><span class="l l-Scalar l-Scalar-Plain">jwt_only</span><span class="p p-Indicator">:</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a><span class="w">     </span><span class="nt">deny</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a><span class="w">     </span><span class="nt">allow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a><span class="w"> </span><span class="nt">jwt_auth_only_rule</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jwt_only</span>
</span></code></pre></div>
<h2 id="access-rules">Access Rules<a class="headerlink" href="#access-rules" title="Permanent link">&para;</a></h2>
<p><em>This section describes new ACL syntax introduced in ejabberd 16.06.
For old access rule and ACL syntax documentation, please refer to <a href="https://github.com/processone/docs.ejabberd.im/blob/7391ac375fd8253f74214cbffa2bafb140501981/content/admin/guide/configuration.md">configuration document archive</a></em></p>
<h3 id="acl-definition">ACL Definition<a class="headerlink" href="#acl-definition" title="Permanent link">&para;</a></h3>
<p>Access control in <code>ejabberd</code> is performed via Access Control Lists
(ACLs). The declarations of ACLs in the configuration file have the
following syntax:</p>
<p><strong><code>acl: { ACLName: { ACLType: ACLValue } }</code></strong></p>
<p><code>ACLType: ACLValue</code> can be one of the following:</p>
<p><strong><code>all</code></strong>:   Matches all JIDs. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">       </span><span class="nt">world</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
</span></code></pre></div>
<p><strong><code>user: Username</code></strong>:   Matches the user with the name <code>Username</code> on any of the local virtual host.
 Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="w">       </span><span class="nt">admin</span><span class="p">:</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">         </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">yozhik</span>
</span></code></pre></div>
<p><strong><code>user: {Username: Server} | Jid</code></strong>:   Matches the user with the JID <code>Username@Server</code> and any resource.
 Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="w">       </span><span class="nt">admin</span><span class="p">:</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">user</span><span class="p">:</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="w">             </span><span class="l l-Scalar l-Scalar-Plain">yozhik@example.org</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">peter@example.org</span>
</span></code></pre></div>
<p><strong><code>server: Server</code></strong>:   Matches any JID from server <code>Server</code>. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="w">      </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">       </span><span class="nt">exampleorg</span><span class="p">:</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="w">         </span><span class="nt">server</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.org</span>
</span></code></pre></div>
<p><strong><code>resource: Resource</code></strong>:   Matches any JID with a resource <code>Resource</code>. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="w">       </span><span class="nt">mucklres</span><span class="p">:</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">         </span><span class="nt">resource</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">muckl</span>
</span></code></pre></div>
<p><strong><code>shared_group: Groupname</code></strong>:   Matches any member of a Shared Roster Group with name <code>Groupname</code> in
 the virtual host. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="w">       </span><span class="nt">techgroupmembers</span><span class="p">:</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">         </span><span class="nt">shared_group</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">techteam</span>
</span></code></pre></div>
<p><strong><code>shared_group: {Groupname: Server}</code></strong>:   Matches any member of a Shared Roster Group with name <code>Groupname</code> in
 the virtual host <code>Server</code>. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="w">       </span><span class="nt">techgroupmembers</span><span class="p">:</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w">         </span><span class="nt">shared_group</span><span class="p">:</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">           </span><span class="nt">techteam</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.org</span>
</span></code></pre></div>
<p><strong><code>ip: Network</code></strong>:   Matches any IP address from the <code>Network</code>. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="w">       </span><span class="nt">loopback</span><span class="p">:</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">         </span><span class="nt">ip</span><span class="p">:</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.0/8</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;::1&quot;</span>
</span></code></pre></div>
<p><strong><code>user_regexp: Regexp</code></strong>:   Matches any local user with a name that matches <code>Regexp</code> on local
 virtual hosts. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="w">       </span><span class="nt">tests</span><span class="p">:</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="w">         </span><span class="nt">user_regexp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^test[0-9]*$&quot;</span>
</span></code></pre></div>
<p><strong><code>user_regexp: {Regexp: Server} | JidRegexp</code></strong>:   Matches any user with a name that matches <code>Regexp</code> at server
 <code>Server</code>. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="w">       </span><span class="nt">tests</span><span class="p">:</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="w">         </span><span class="nt">user_regexp</span><span class="p">:</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;^test1&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">example.org</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="w">           </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;^test2@example.org&quot;</span>
</span></code></pre></div>
<p><strong><code>server_regexp: Regexp</code></strong>:   Matches any JID from the server that matches <code>Regexp</code>. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="w">       </span><span class="nt">icq</span><span class="p">:</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">         </span><span class="nt">server_regexp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^icq\\.&quot;</span>
</span></code></pre></div>
<p><strong><code>resource_regexp: Regexp</code></strong>:   Matches any JID with a resource that matches <code>Regexp</code>. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="w">       </span><span class="nt">icq</span><span class="p">:</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w">         </span><span class="nt">resource_regexp</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^laptop\\.&quot;</span>
</span></code></pre></div>
<p><strong><code>node_regexp: {UserRegexp: ServerRegexp}</code></strong>:   Matches any user with a name that matches <code>UserRegexp</code> at any server
 that matches <code>ServerRegexp</code>. Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="w">     </span><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="w">       </span><span class="nt">yozhik</span><span class="p">:</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="w">         </span><span class="nt">node_regexp</span><span class="p">:</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="w">           </span><span class="s">&quot;^yozhik$&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;^example.(com|org)$&quot;</span>
</span></code></pre></div>
<!-- TODO: explain remaining parameters -->

<p><strong><code>user_glob: Glob</code></strong>:</p>
<p><strong><code>user_glob: {Glob: Server}</code></strong>:</p>
<p><strong><code>server_glob: Glob</code></strong>:</p>
<p><strong><code>resource_glob: Glob</code></strong>:</p>
<p><strong><code>node_glob: {UserGlob: ServerGlob}</code></strong>:   This is the same as above. However, it uses shell glob patterns
instead of regexp. These patterns can have the following special
characters:</p>
<ul>
<li>
<p><strong><code>*</code></strong>:   matches any string including the null string.</p>
</li>
<li>
<p><strong><code>?</code></strong>:   matches any single character.</p>
</li>
<li>
<p><strong><code>[...]</code></strong>:   matches any of the enclosed characters. Character ranges are
     specified by a pair of characters separated by a <code>-</code>. If the
     first character after <code>[</code> is a <code>!</code>, any character not enclosed
     is matched.</p>
</li>
</ul>
<p>The following <code>ACLName</code> are pre-defined:</p>
<p><strong><code>all</code></strong>:   Matches any JID.</p>
<p><strong><code>none</code></strong>:   Matches no JID.</p>
<h3 id="access-rights">Access Rights<a class="headerlink" href="#access-rights" title="Permanent link">&para;</a></h3>
<p>An entry allowing or denying access to different services. The syntax
is:</p>
<p><strong><code>access_rules: { AccessName: { - allow|deny: ACLRule|ACLDefinition } }</code></strong></p>
<p>Each definition may contain arbitrary number of <code>- allow</code> or <code>- deny</code>
sections, and each section can contain any number of acl rules
(as defined in <a href="#acl-definition">previous section</a>, it recognizes
one additional rule <code>acl: RuleName</code> that matches when acl rule
named <code>RuleName</code> matches). If no rule or definition is defined, the
rule <code>all</code> is applied.</p>
<p>Definition's <code>- allow</code> and <code>- deny</code> sections are processed in top
to bottom order, and first one for which all listed acl rules matches
is returned as result of access rule. If no rule matches <code>deny</code> is returned.</p>
<p>To simplify configuration two shortcut version are available:
<code>- allow: acl</code> and <code>- allow</code>, example below shows equivalent
definitions where short or long version are used:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="w">    </span><span class="nt">access_rules</span><span class="p">:</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="w">      </span><span class="nt">a_short</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="w">      </span><span class="nt">a_long</span><span class="p">:</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">acl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="w">      </span><span class="nt">b_short</span><span class="p">:</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">deny</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">banned</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">allow</span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="w">      </span><span class="nt">b_long</span><span class="p">:</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">deny</span><span class="p">:</span>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">acl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">banned</span>
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">allow</span><span class="p">:</span>
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
</span></code></pre></div>
<p>If you define specific Access rights in a virtual host, remember that
the globally defined Access rights have precedence over those. This
means that, in case of conflict, the Access granted or denied in the
global server is used and the Access of a virtual host doesn't have
effect.</p>
<p>Example:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="w">      </span><span class="nt">access_rules</span><span class="p">:</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="w">        </span><span class="nt">configure</span><span class="p">:</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">allow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">admin</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="w">        </span><span class="nt">something</span><span class="p">:</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">deny</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">someone</span>
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">allow</span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a><span class="w">        </span><span class="nt">s2s_banned</span><span class="p">:</span>
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">deny</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">problematic_hosts</span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">deny</span><span class="p">:</span>
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">acl</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">banned_forever</span>
</span><span id="__span-48-11"><a id="__codelineno-48-11" name="__codelineno-48-11" href="#__codelineno-48-11"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">deny</span><span class="p">:</span>
</span><span id="__span-48-12"><a id="__codelineno-48-12" name="__codelineno-48-12" href="#__codelineno-48-12"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">222.111.222.111/32</span>
</span><span id="__span-48-13"><a id="__codelineno-48-13" name="__codelineno-48-13" href="#__codelineno-48-13"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">deny</span><span class="p">:</span>
</span><span id="__span-48-14"><a id="__codelineno-48-14" name="__codelineno-48-14" href="#__codelineno-48-14"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">111.222.111.222/32</span>
</span><span id="__span-48-15"><a id="__codelineno-48-15" name="__codelineno-48-15" href="#__codelineno-48-15"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">allow</span>
</span><span id="__span-48-16"><a id="__codelineno-48-16" name="__codelineno-48-16" href="#__codelineno-48-16"></a><span class="w">        </span><span class="nt">xmlrpc_access</span><span class="p">:</span>
</span><span id="__span-48-17"><a id="__codelineno-48-17" name="__codelineno-48-17" href="#__codelineno-48-17"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">allow</span><span class="p">:</span>
</span><span id="__span-48-18"><a id="__codelineno-48-18" name="__codelineno-48-18" href="#__codelineno-48-18"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">peter@example.com</span>
</span><span id="__span-48-19"><a id="__codelineno-48-19" name="__codelineno-48-19" href="#__codelineno-48-19"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">allow</span><span class="p">:</span>
</span><span id="__span-48-20"><a id="__codelineno-48-20" name="__codelineno-48-20" href="#__codelineno-48-20"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ivone@example.com</span>
</span><span id="__span-48-21"><a id="__codelineno-48-21" name="__codelineno-48-21" href="#__codelineno-48-21"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">allow</span><span class="p">:</span>
</span><span id="__span-48-22"><a id="__codelineno-48-22" name="__codelineno-48-22" href="#__codelineno-48-22"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">user</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bot@example.com</span>
</span><span id="__span-48-23"><a id="__codelineno-48-23" name="__codelineno-48-23" href="#__codelineno-48-23"></a><span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">ip</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.0.0.0/24</span>
</span></code></pre></div>
<p>The following <code>AccessName</code> are pre-defined:</p>
<p><strong><code>all</code></strong>:   Always returns the value ‘<code>allow</code>’.</p>
<p><strong><code>none</code></strong>:   Always returns the value ‘<code>deny</code>’.</p>
<h3 id="shaper-rules">Shaper Rules<a class="headerlink" href="#shaper-rules" title="Permanent link">&para;</a></h3>
<p>An entry allowing to declaring shaper to use for matching user/hosts. The syntax
is:</p>
<p><strong><code>shaper_rules: { ShaperRuleName: { - Number|ShaperName: ACLRule|ACLDefinition } }</code></strong></p>
<p>Semantic is similar to that described in <a href="#access-rights">Access Rights</a> section,
only difference is that instead using <code>- allow</code> or <code>- deny</code>, name of shaper or number
should be used.</p>
<p>Examples:</p>
<div class="language-text highlight"><pre><span></span><code>shaper_rules:
  connections_limit:
    - 10:
      - user: peter@example.com
    - 100: admin
    - 5
  download_speed:
    - fast: admin
    - slow: anonymous_users
    - normal
  log_days: 30
</code></pre></div>
<h3 id="limiting-opened-sessions-with-acl">Limiting Opened Sessions with ACL<a class="headerlink" href="#limiting-opened-sessions-with-acl" title="Permanent link">&para;</a></h3>
<p>The special access <code>max_user_sessions</code> specifies the maximum number of
sessions (authenticated connections) per user. If a user tries to open
more sessions by using different resources, the first opened session
will be disconnected. The error <code>session replaced</code> will be sent to the
disconnected session. The value for this option can be either a number,
or <code>infinity</code>. The default value is <code>infinity</code>.</p>
<p>The syntax is:</p>
<p><strong><code>{ max_user_sessions: { - Number: ACLRule|ACLDefinition } }</code></strong></p>
<p>This example limits the number of sessions per user to 5 for all users,
and to 10 for admins:</p>
<p>shaper_rules:
   max_user_sessions:
     - 10: admin
     - 5</p>
<h3 id="several-connections-to-a-remote-xmpp-server-with-acl">Several connections to a remote XMPP server with ACL<a class="headerlink" href="#several-connections-to-a-remote-xmpp-server-with-acl" title="Permanent link">&para;</a></h3>
<p>The special access <code>max_s2s_connections</code> specifies how many simultaneous
S2S connections can be established to a specific remote XMPP server. The
default value is <code>1</code>. There’s also available the access
<code>max_s2s_connections_per_node</code>.</p>
<p>The syntax is:</p>
<p><strong><code>{ max_s2s_connections: { ACLName: MaxNumber } }</code></strong></p>
<p>Examples:</p>
<ul>
<li>Allow up to 3 connections with each remote server:</li>
</ul>
<p>shaper_rules:
    max_s2s_connections: 3</p>
<h2 id="shapers">Shapers<a class="headerlink" href="#shapers" title="Permanent link">&para;</a></h2>
<p>Shapers enable you to limit connection traffic. The syntax is:</p>
<p><strong><code>shaper: { ShaperName: Rate }</code></strong>:  where <code>Rate</code> stands for the maximum allowed incoming rate in bytes per
second. When a connection exceeds this limit, <code>ejabberd</code> stops reading
from the socket until the average rate is again below the allowed
maximum.</p>
<p>Examples:</p>
<ul>
<li>To define a shaper named ‘<code>normal</code>’ with traffic speed limited to
 1,000bytes/second:</li>
</ul>
<p>shaper:
    normal: 1000</p>
<ul>
<li>To define a shaper named ‘<code>fast</code>’ with traffic speed limited to
 50,000bytes/second:</li>
</ul>
<p>shaper:
    fast: 50000</p>
<h2 id="default-language">Default Language<a class="headerlink" href="#default-language" title="Permanent link">&para;</a></h2>
<p>The option <code>language</code> defines the default language of server strings
that can be seen by XMPP clients. If a XMPP client does not support
<code>xml:lang</code>, the specified language is used.</p>
<p>The option syntax is:</p>
<p><strong><code>language: Language</code></strong>: The default value is <code>en</code>. In order to take effect there must be a
translation file <code>Language.msg</code> in <code>ejabberd</code>’s <code>msgs</code> directory.</p>
<p>For example, to set Russian as default language:</p>
<p>language: ru</p>
<p>The page <a href="../../developer/extending-ejabberd/localization/">Internationalization and Localization</a>
provides more details.</p>
<h2 id="captcha">CAPTCHA<a class="headerlink" href="#captcha" title="Permanent link">&para;</a></h2>
<p>Some <code>ejabberd</code> modules can be configured to require a CAPTCHA challenge
on certain actions. If the client does not support CAPTCHA Forms
(<a href="https://xmpp.org/extensions/xep-0158.html"><code>XEP-0158</code></a>), a web link is
provided so the user can fill the challenge in a web browser.</p>
<p>An example script is provided that generates the image using
ImageMagick’s Convert program.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>We do not provide example scripts to support image generation on Microsoft Windows. Captcha will not work with ejabberd Windows installer.</p>
</div>
<p>The configurable options are:</p>
<p><strong><code>captcha_cmd: Path</code></strong>:   Full path to a script that generates the image. The default value
 disables the feature: <code>undefined</code></p>
<p><strong><code>captcha_url: URL</code></strong>:  An URL where CAPTCHA requests should be sent.
        You need to configure request_handlers for ejabberd_http listener as well.</p>
<p>Example configuration:</p>
<p>hosts: [example.org]</p>
<p>captcha_cmd: /lib/ejabberd/priv/bin/captcha.sh
 captcha_url: http://example.org:5280/captcha
 ## captcha_url: https://example.org:443/captcha
 ## captcha_url: http://example.com/captcha</p>
<p>listen:
   ...
   -
     port: 5280
     module: ejabberd_http
     request_handlers:
       /captcha: ejabberd_captcha
   ...</p>
<h2 id="node-settings">Node settings<a class="headerlink" href="#node-settings" title="Permanent link">&para;</a></h2>
<p><code>net_ticktime: 60</code></p>
<p>This option can be used to tune tick time parameter of
net_kernel. It tells <code>erlang</code> VM how often nodes should check if
intra-node communication was not interrupted. This option must have
identical value on all nodes, or it will lead to subtle bugs. Usually
leaving default value of this is option is best, tweak it only if you
know what you are doing.</p>
<h2 id="stun-and-turn">STUN and TURN<a class="headerlink" href="#stun-and-turn" title="Permanent link">&para;</a></h2>
<p><code>ejabberd</code> is able to act as a stand-alone STUN/TURN server
(<a href="https://tools.ietf.org/html/rfc5389"><code>RFC 5389</code></a>/<a href="https://tools.ietf.org/html/rfc5766"><code>RFC 5766</code></a>).
In that role <code>ejabberd</code> helps clients with ICE
(<a href="https://tools.ietf.org/html/rfc5245"><code>RFC 5245</code></a>) or Jingle ICE
(<a href="https://xmpp.org/extensions/xep-0176.html"><code>XEP-0176</code></a>) support to
discover their external addresses and ports and to relay media traffic
when it is impossible to establish direct peer-to-peer connection.</p>
<p>You should configure <code>ejabberd_stun</code> listening module as described in
<a href="#listening-module">Listening Module</a> section. The specific configurable options are:</p>
<p><strong><code>tls: true|false</code></strong>:   If enabled, <code>certfile</code> option must be set, otherwise <code>ejabberd</code> will
 not be able to accept TLS connections. Obviously, this option makes
 sense for <code>tcp</code> transport only. The default is <code>false</code>.</p>
<p><strong><code>certfile: Path</code></strong>:   Path to the certificate file. Only makes sense when <code>tls</code> is set.</p>
<p><strong><code>use_turn: true|false</code></strong>:   Enables/disables TURN (media relay) functionality. The default is
 <code>false</code>.</p>
<p><strong><code>turn_ip: String</code></strong>:   The IPv4 address advertised by your TURN server. The address should
 not be NAT’ed or firewalled. There is not default, so you should set
 this option explicitly. Implies <code>use_turn</code>.</p>
<p><strong><code>turn_min_port: Integer</code></strong>:   Together with <code>turn_max_port</code> forms port range to allocate from. The
 default is 49152. Implies <code>use_turn</code>.</p>
<p><strong><code>turn_max_port: Integer</code></strong>:   Together with <code>turn_min_port</code> forms port range to allocate from. The
 default is 65535. Implies <code>use_turn</code>.</p>
<p><strong><code>turn_max_allocations: Integer|infinity</code></strong>:   Maximum number of TURN allocations available from the particular IP
 address. The default value is 10. Implies <code>use_turn</code>.</p>
<p><strong><code>turn_max_permissions: Integer|infinity</code></strong>:   Maximum number of TURN permissions available from the particular IP
 address. The default value is 10. Implies <code>use_turn</code>.</p>
<p><strong><code>auth_type: user|anonymous</code></strong>:   Which authentication type to use for TURN allocation requests. When
 type <code>user</code> is set, ejabberd authentication backend is used. For
 <code>anonymous</code> type no authentication is performed (not recommended for
 public services). The default is <code>user</code>. Implies <code>use_turn</code>.</p>
<p><strong><code>auth_realm: String</code></strong>:   When <code>auth_type</code> is set to <code>user</code> and you have several virtual hosts
 configured you should set this option explicitly to the virtual host
 you want to serve on this particular listening port. Implies
 <code>use_turn</code>.</p>
<p><strong><code>shaper: Atom</code></strong>:   For <code>tcp</code> transports defines shaper to use. The default is <code>none</code>.</p>
<p><strong><code>server_name: String</code></strong>:   Defines software version to return with every response. The default
 is the STUN library version.</p>
<p>Example configuration with disabled TURN functionality (STUN only):</p>
<p>listen:
   ...
   -
     port: 3478
     transport: udp
     module: ejabberd_stun
   -
     port: 3478
     module: ejabberd_stun
   -
     port: 5349
     module: ejabberd_stun
     certfile: /etc/ejabberd/server.pem
   ...</p>
<p>Example configuration with TURN functionality. Note that STUN is always
enabled if TURN is enabled. Here, only UDP section is shown:</p>
<p>listen:
   ...
   -
     port: 3478
     transport: udp
     use_turn: true
     turn_ip: 10.20.30.1
     module: ejabberd_stun
   ...</p>
<p>You also need to configure DNS SRV records properly so clients can
easily discover a STUN/TURN server serving your XMPP domain. Refer to
section
<a href="https://tools.ietf.org/html/rfc5389#section-9"><code>DNS Discovery of a Server</code></a>
of <a href="https://tools.ietf.org/html/rfc5389"><code>RFC 5389</code></a> and section
<a href="https://tools.ietf.org/html/rfc5766#section-6"><code>Creating an Allocation</code></a>
of <a href="https://tools.ietf.org/html/rfc5766"><code>RFC 5766</code></a> for details.</p>
<p>Example DNS SRV configuration for STUN only:</p>
<p>_stun._udp   IN SRV  0 0 3478 stun.example.com.
 _stun._tcp   IN SRV  0 0 3478 stun.example.com.
 _stuns._tcp  IN SRV  0 0 5349 stun.example.com.</p>
<p>And you should also add these in the case if TURN is enabled:</p>
<p>_turn._udp   IN SRV  0 0 3478 turn.example.com.
 _turn._tcp   IN SRV  0 0 3478 turn.example.com.
 _turns._tcp  IN SRV  0 0 5349 turn.example.com.</p>
<h2 id="sip">SIP<a class="headerlink" href="#sip" title="Permanent link">&para;</a></h2>
<h3 id="sip-configuration">SIP Configuration<a class="headerlink" href="#sip-configuration" title="Permanent link">&para;</a></h3>
<p><code>ejabberd</code> has built-in SIP support. In order to activate it you need to
add listeners for it, configure DNS properly and enable <code>mod_sip</code> for
the desired virtual host.</p>
<p>To add a listener you should configure <code>ejabberd_sip</code> listening module
as described in <a href="#listening-module">Listening Module</a> section. If option <code>tls</code> is specified, option
<code>certfile</code> must be specified as well, otherwise incoming TLS connections
would fail.</p>
<p>Example configuration with standard ports (as per
<a href="https://tools.ietf.org/html/rfc3261"><code>RFC 3261</code></a>):</p>
<p>listen:
   ...
   -
     port: 5060
     transport: udp
     module: ejabberd_sip
   -
     port: 5060
     module: ejabberd_sip
   -
     port: 5061
     module: ejabberd_sip
     tls: true
     certfile: /etc/ejabberd/server.pem
   ...</p>
<p>Note that there is no StartTLS support in SIP and
<a href="https://en.wikipedia.org/wiki/Server_Name_Indication"><code>SNI</code></a> support is
somewhat tricky, so for TLS you have to configure different virtual
hosts on different ports if you have different certificate files for
them.</p>
<p>Next you need to configure DNS SIP records for your virtual domains.
Refer to <a href="https://tools.ietf.org/html/rfc3263"><code>RFC 3263</code></a> for the
detailed explanation. Simply put, you should add NAPTR and SRV records
for your domains. Skip NAPTR configuration if your DNS provider doesn't
support this type of records. It’s not fatal, however, highly
recommended.</p>
<p>Example configuration of NAPTR records:</p>
<p>example.com IN NAPTR 10  0 "s" "SIPS+D2T" "" _sips._tcp.example.com.
 example.com IN NAPTR 20  0 "s" "SIP+D2T" "" _sip._tcp.example.com.
 example.com IN NAPTR 30  0 "s" "SIP+D2U" "" _sip._udp.example.com.</p>
<p>Example configuration of SRV records with standard ports (as per
<a href="https://tools.ietf.org/html/rfc3261"><code>RFC 3261</code></a>):</p>
<p>_sip._udp   IN SRV  0 0 5060 sip.example.com.
 _sip._tcp   IN SRV  0 0 5060 sip.example.com.
 _sips._tcp  IN SRV  0 0 5061 sip.example.com.</p>
<h3 id="note-on-sip-usage">Note on SIP usage<a class="headerlink" href="#note-on-sip-usage" title="Permanent link">&para;</a></h3>
<p>SIP authentication does not support SCRAM. As such, it is not possible
to use <code>mod_sip</code> to authenticate when ejabberd has been set to encrypt
password with SCRAM.</p>
<h2 id="include-additional-configuration-files">Include Additional Configuration Files<a class="headerlink" href="#include-additional-configuration-files" title="Permanent link">&para;</a></h2>
<p>The option <code>include_config_file</code> in a configuration file instructs
<code>ejabberd</code> to include other configuration files immediately.</p>
<p>The basic syntax is:</p>
<p><strong><code>include_config_file: [Filename]</code></strong></p>
<p>It is possible to specify suboptions using the full syntax:</p>
<p><strong><code>include_config_file: { Filename: [Suboption, ...] }</code></strong>:  The filename can be indicated either as an absolute path, or relative to
the main <code>ejabberd</code> configuration file. It isn't possible to use
wildcards. The file must exist and be readable.</p>
<p>The allowed suboptions are:</p>
<p><strong><code>disallow: [Optionname, ...]</code></strong>:   Disallows the usage of those options in the included configuration
 file. The options that match this criteria are not accepted. The
 default value is an empty list: <code>[]</code></p>
<p><strong><code>allow_only: [Optionname, ...]</code></strong>:   Allows only the usage of those options in the included configuration
 file. The options that do not match this criteria are not accepted.
 The default value is: <code>all</code></p>
<p>This is a basic example:</p>
<p>include_config_file: /etc/ejabberd/additional.yml</p>
<p>In this example, the included file is not allowed to contain a <code>listen</code>
option. If such an option is present, the option will not be accepted.
The file is in a subdirectory from where the main configuration file is.</p>
<p>include_config_file:
   ./example.org/additional_not_listen.yml:
     disallow: [listen]</p>
<p>Please notice that options already defined in the main configuration file cannot be redefined in the included configuration files. But you can use <code>host_config</code> and <code>append_host_config</code> as usual (see <a href="#virtual-hosting">Virtual Hosting</a>).</p>
<p>In this example, <code>ejabberd.yml</code> defines some ACL for the whole ejabberd server, and later includes another file:</p>
<p>acl:
   admin:
     user:
       - admin@localhost
 include_config_file:
   /etc/ejabberd/acl.yml</p>
<p>The file <code>acl.yml</code> can add additional administrators to one of the virtual hosts:</p>
<p>append_host_config:
   localhost:
     acl:
       admin:
         user:
           - bob@localhost
           - jan@localhost</p>
<h2 id="option-macros-in-configuration-file">Option Macros in Configuration File<a class="headerlink" href="#option-macros-in-configuration-file" title="Permanent link">&para;</a></h2>
<p>In the <code>ejabberd</code> configuration file, it is possible to define a macro
for a value and later use this macro when defining an option.</p>
<p>A macro is defined with this syntax:</p>
<p><strong><code>define_macro: { ’MACRO’: Value }</code></strong>:  Defines a macro. The <code>value</code> can be any
valid arbitrary YAML value. For convenience, it's recommended to define
a macro name in capital letters.</p>
<p>Duplicated macros are not allowed.</p>
<p>Macros are processed after additional configuration files have been
included, so it is possible to use macros that are defined in
configuration files included before the usage.</p>
<p>It is possible to use a macro in the definition of another macro.</p>
<p>This example shows the basic usage of a macro:</p>
<p>define_macro:
   LOG_LEVEL_NUMBER: 5
 loglevel: LOG_LEVEL_NUMBER</p>
<p>The resulting option interpreted by <code>ejabberd</code> is: <code>loglevel: 5</code>.</p>
<p>This example shows that values can be any arbitrary YAML value:</p>
<p>define_macro:
   USERBOB:
     user:
       - bob@localhost
 acl:
   admin: USERBOB</p>
<p>The resulting option interpreted by <code>ejabberd</code> is:</p>
<p>acl:
   admin:
     user:
       - bob@localhost</p>
<p>This complex example:</p>
<p>define_macro:
   NUMBER_PORT_C2S: 5222
   NUMBER_PORT_HTTP: 5280
 listen:
   -
     port: NUMBER_PORT_C2S
     module: ejabberd_c2s
   -
     port: NUMBER_PORT_HTTP
     module: ejabberd_http</p>
<p>produces this result after being interpreted:</p>
<p>listen:
   -
     port: 5222
     module: ejabberd_c2s
   -
     port: 5280
     module: ejabberd_http</p>
<h1 id="database-and-ldap-configuration">Database and LDAP Configuration<a class="headerlink" href="#database-and-ldap-configuration" title="Permanent link">&para;</a></h1>
<p><code>ejabberd</code> uses its internal Mnesia database by default. However, it is
possible to use a relational database, key-value storage or an LDAP
server to store persistent, long-living data. <code>ejabberd</code> is very
flexible: you can configure different authentication methods for
different virtual hosts, you can configure different authentication
mechanisms for the same virtual host (fallback), you can set different
storage systems for modules, and so forth.</p>
<p>The following databases are supported by <code>ejabberd</code>:</p>
<ul>
<li>
<p><a href="https://erlang.org/doc/apps/mnesia/"><code>Mnesia</code></a></p>
</li>
<li>
<p><a href="https://www.mysql.com/"><code>MySQL</code></a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Open_Database_Connectivity"><code>Any ODBC compatible database</code></a></p>
</li>
<li>
<p><a href="https://www.postgresql.org/"><code>PostgreSQL</code></a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Microsoft_SQL_Server"><code>MS SQL Server/SQL Azure</code></a></p>
</li>
<li>
<p><a href="https://sqlite.org/"><code>SQLite</code></a></p>
</li>
<li>
<p><a href="https://redis.io/"><code>Redis</code></a> (only for transient data)</p>
</li>
</ul>
<p>The following LDAP servers are tested with <code>ejabberd</code>:</p>
<ul>
<li>
<p><code>Active Directory</code> (see
 section <a href="#active-directory">Active Directory</a>)</p>
</li>
<li>
<p><a href="https://openldap.org/"><code>OpenLDAP</code></a></p>
</li>
<li>
<p><a href="https://communigate.com/"><code>CommuniGate Pro</code></a></p>
</li>
<li>
<p>Normally any LDAP compatible server should work; inform us about
 your success with a not-listed server so that we can list it here.</p>
</li>
</ul>
<p>Important note about virtual hosting: if you define several domains in
ejabberd.yml (see section <a href="#host-names">Host Names</a>), you probably want that each
virtual host uses a different configuration of database, authentication
and storage, so that usernames do not conflict and mix between different
virtual hosts. For that purpose, the options described in the next
sections must be set inside a <code>host_config</code> for each vhost (see section
<a href="#virtual-hosting">Virtual Hosting</a>). For example:</p>
<p>host_config:
   public.example.org:
     sql_type: pgsql
     sql_server: localhost
     sql_database: database-public-example-org
     sql_username: ejabberd
     sql_password: password
     auth_method: [sql]</p>
<h2 id="relational-databases">Relational Databases<a class="headerlink" href="#relational-databases" title="Permanent link">&para;</a></h2>
<p>There are two schemas usable for ejabberd. The default lecacy schema allows to
store one XMPP domain into one ejabberd database. The 'new' schema allows to
handle several XMPP domains in a single ejabberd database. Using this new schema
is best when serving several XMPP domains and/or changing domains from time to
time. This avoid need to manage several databases and handle complex
configuration changes.</p>
<p>You need to upload SQL schema to your SQL server. Choose the one from <a href="https://github.com/processone/ejabberd/tree/master/sql"><code>this</code></a> list.
If you are using MySQL and choose the default schema, use <code>mysql.sql</code>. If you
are using PostgreSQL and need the new schema, use <code>pg.new.sql</code>.</p>
<p>If you choose the new schema, you MUST add an extra line into <code>ejabberd.yml</code>
configuration file to enable the feature:</p>
<p>new_sql_schema: true</p>
<p>The actual database access is defined in the options with <code>sql_</code>
prefix. The values are used to define if we want to use ODBC, or one of
the two native interface available, PostgreSQL or MySQL.</p>
<p>The following parameters are available:</p>
<p><strong><code>sql_type: mysql | pgsql | odbc | mssql | sqlite</code></strong>:   The type of an SQL connection. The default is <code>odbc</code>.</p>
<p><strong><code>sql_server: String</code></strong>:   A hostname of the SQL server. The default is <code>localhost</code>.</p>
<p><strong><code>sql_port: Port</code></strong>:   The port where the SQL server is accepting connections. The option
 is valid for <code>mysql</code>, <code>pgsql</code> and <code>mssql</code>. The default is <code>3306</code> and
 <code>5432</code> respectively.</p>
<p><strong><code>sql_database: String</code></strong>:   The database name. The default is <code>ejabberd</code>. The option is valid
 for <code>mysql</code>, <code>pgsql</code> and <code>mssql</code>.</p>
<p><strong><code>sql_username: String</code></strong>:   The username. The default is <code>ejabberd</code>. The option is valid
 for <code>mysql</code>, <code>pgsql</code> and <code>mssql</code>.</p>
<p><strong><code>sql_password: String</code></strong>:   The password. The default is empty string. The option is valid
 for <code>mysql</code>, <code>pgsql</code> and <code>mssql</code>.</p>
<p><strong><code>sql_ssl: Boolean</code></strong>:   use ssl if not set plain tcp.
 The default value is <code>false</code>. The option is valid for <code>pgsql</code> and <code>mysql</code>.</p>
<p><strong><code>sql_ssl_verify: Boolean</code></strong>:   if set verify ssl connect.
 The default value is <code>false</code>. The option is valid for <code>pgsql</code>.</p>
<p><strong><code>sql_ssl_cafile: String</code></strong>:  The path to a CA certificate file.
 By default the option is not set. The option is valid for <code>pgsql</code>.</p>
<p><strong><code>sql_ssl_certfile: String</code></strong>:  The path to a client/authentication certificate file.
 By default the option is not set. The option is valid for <code>pgsql</code>.</p>
<p><strong><code>sql_pool_size: N</code></strong>:   By default <code>ejabberd</code> opens 10 connections to the database for each
 virtual host. You can change this number by using this option.</p>
<p><strong><code>sql_keepalive_interval: N</code></strong>:   You can configure an interval to make a dummy SQL request to keep
 alive the connections to the database. The default value is
 ’undefined’, so no keepalive requests are made. Specify in seconds:
 for example 28800 means 8 hours.</p>
<p><strong><code>sql_start_interval: N</code></strong>:   If the connection to the database fails, <code>ejabberd</code> waits 30 seconds
 before retrying. You can modify this interval with this option.</p>
<p><strong><code>sql_prepared_statements: Boolean</code></strong>:  If you need to disable prepared
 statements.  The default value is <code>true</code>.  The option is valid for
 <code>pgsql</code> and <code>mysql</code>.</p>
<p>Example of plain ODBC connection:</p>
<p>sql_server: "DSN=database;UID=ejabberd;PWD=password"</p>
<p>Example of MySQL connection:</p>
<p>sql_type: mysql
 sql_server: server.company.com
 sql_port: 3306 # the default
 sql_database: mydb
 sql_username: user1
 sql_password: "<strong><em>*</em></strong>***"
 sql_pool_size: 5</p>
<h2 id="microsoft-sql-notes">Microsoft SQL Notes<a class="headerlink" href="#microsoft-sql-notes" title="Permanent link">&para;</a></h2>
<p>For now, MS SQL is only supported in Unix-like OS'es. You need to have
<a href="https://www.freetds.org/"><code>FreeTDS</code></a> and <a href="http://www.unixodbc.org/"><code>unixODBC</code></a> installed on your machine.
Also, in some cases you need to add machine name to <code>sql_username</code>, especially
when you have <code>sql_server</code> defined as an IP address, e.g.:</p>
<p>sql_type: mssql
 sql_server: 1.2.3.4
 ...
 sql_username: user1@host</p>
<h3 id="sql-authentication">SQL Authentication<a class="headerlink" href="#sql-authentication" title="Permanent link">&para;</a></h3>
<p>You can authenticate users against an SQL database, see the option
<code>auth_method</code> in section <a href="#authentication">Authentication</a>.</p>
<p>The option <code>auth_password_format</code> is supported,
for details see section <a href="#internal">Internal</a>.
Please note that if you use SQL auth method and set SCRAM format,
old plain passwords that may be stored in the database are not
automatically scrammed. For that, you can execute the command:</p>
<p>ejabberdctl convert_to_scram example.org</p>
<h3 id="sql-storage">SQL Storage<a class="headerlink" href="#sql-storage" title="Permanent link">&para;</a></h3>
<p>An ODBC compatible database also can be used to store information into
from several <code>ejabberd</code> modules. See section <a href="#modules-overview">Modules Overview</a> to see which
modules can be used with relational databases like MySQL. To enable
storage to your database, just make sure that your database is running
well (see previous sections), and add the module option <code>db_type: sql</code>
or set <code>default_db: sql</code> globally if you want to use SQL for all modules.</p>
<h2 id="ldap">LDAP<a class="headerlink" href="#ldap" title="Permanent link">&para;</a></h2>
<p><code>ejabberd</code> has built-in LDAP support. You can authenticate users against
LDAP server and use LDAP directory as vCard storage.</p>
<p>Usually <code>ejabberd</code> treats LDAP as a read-only storage: it is possible to
consult data, but not possible to create accounts or edit vCard that is
stored in LDAP. However, it is possible to change passwords if
<code>mod_register</code> module is enabled and LDAP server supports
<a href="https://tools.ietf.org/html/rfc3062"><code>RFC 3062</code></a>.</p>
<h3 id="ldap-connection">LDAP Connection<a class="headerlink" href="#ldap-connection" title="Permanent link">&para;</a></h3>
<p>Two connections are established to the LDAP server per vhost, one for
authentication and other for regular calls.</p>
<p>Parameters:</p>
<p><strong><code>ldap_servers: [Servers, ...]</code></strong>:   List of IP addresses or DNS names of your LDAP servers. This option
 is required.</p>
<p><strong><code>ldap_encrypt: none|tls</code></strong>:   Type of connection encryption to the LDAP server. Allowed values
 are: <code>none</code>, <code>tls</code>. The value <code>tls</code> enables encryption by using LDAP
 over SSL. Note that STARTTLS encryption is not supported. The
 default value is: <code>none</code>.</p>
<p><strong><code>ldap_tls_verify: false|soft|hard</code></strong>:   This option specifies whether to verify LDAP server certificate or
 not when TLS is enabled. When <code>hard</code> is enabled <code>ejabberd</code> doesn’t
 proceed if a certificate is invalid. When <code>soft</code> is enabled
 <code>ejabberd</code> proceeds even if check fails. The default is <code>false</code>
 which means no checks are performed.</p>
<p><strong><code>ldap_tls_cacertfile: Path</code></strong>:   Path to file containing PEM encoded CA certificates. This option is
 needed (and required) when TLS verification is enabled.</p>
<p><strong><code>ldap_tls_depth: Number</code></strong>:   Specifies the maximum verification depth when TLS verification is
 enabled, i.e. how far in a chain of certificates the verification
 process can proceed before the verification is considered to fail.
 Peer certificate = 0, CA certificate = 1, higher level CA
 certificate = 2, etc. The value 2 thus means that a chain can at
 most contain peer cert, CA cert, next CA cert, and an additional CA
 cert. The default value is 1.</p>
<p><strong><code>ldap_port: Number</code></strong>:   Port to connect to your LDAP server. The default port is 389 if
 encryption is disabled; and 636 if encryption is enabled. If you
 configure a value, it is stored in <code>ejabberd</code>’s database. Then, if
 you remove that value from the configuration file, the value
 previously stored in the database will be used instead of the
 default port.</p>
<p><strong><code>ldap_rootdn: RootDN</code></strong>:   Bind DN. The default value is empty string "" which means ‘anonymous connection’.</p>
<p><strong><code>ldap_password: Password</code></strong>:   Bind password. The default value is is empty string.</p>
<p><strong><code>ldap_deref_aliases: never|always|finding|searching</code></strong>:   Whether or not to dereference aliases. The default is <code>never</code>.</p>
<p>Example:</p>
<p>auth_method: [ldap]
 ldap_servers:
   - ldap1.example.org
 ldap_port: 389
 ldap_rootdn: "cn=Manager,dc=domain,dc=org"
 ldap_password: "<strong><em>*</em></strong>***"</p>
<h3 id="ldap-authentication">LDAP Authentication<a class="headerlink" href="#ldap-authentication" title="Permanent link">&para;</a></h3>
<p>You can authenticate users against an LDAP directory. Note that current
LDAP implementation does not support SASL authentication.</p>
<p>Available options are:</p>
<p><strong><code>ldap_base: Base</code></strong>:   LDAP base directory which stores users accounts. This option is
 required.</p>
<p><strong><code>ldap_uids: [ ldap_uidattr | {ldap_uidattr: ldap_uidattr_format} ]</code></strong>:   LDAP attribute which holds a list of attributes to use as
 alternatives for getting the JID. The default attributes are
 <code>[{uid, %u}]</code>. The attributes are of the form: <code>[{ldap_uidattr}]</code> or
 <code>[{ldap_uidattr, ldap_uidattr_format}]</code>. You can use as many comma
 separated attributes as needed. The values for <code>ldap_uidattr</code> and
 <code>ldap_uidattr_format</code> are described as follow:</p>
<ul>
<li>
<p><strong><code>ldap_uidattr</code></strong>:   LDAP attribute which holds the user’s part of a JID. The default
     value is <code>uid</code>.</p>
</li>
<li>
<p><strong><code>ldap_uidattr_format</code></strong>:   Format of the <code>ldap_uidattr</code> variable. The format <em>must</em> contain
     one and only one pattern variable <code>%u</code> which will be replaced by
     the user’s part of a JID. For example, <code>%u@example.org</code>. The
     default value is <code>%u</code>.</p>
</li>
</ul>
<p><strong><code>ldap_filter: Filter</code></strong>:   <a href="https://tools.ietf.org/html/rfc4515"><code>RFC 4515</code></a> LDAP filter. The
 default Filter value is: <code>undefined</code>. Example:
 <code>(&amp;(objectClass=shadowAccount)(memberOf=Jabber Users))</code>. Please, do
 not forget to close brackets and do not use superfluous whitespaces.
 Also you <em>must not</em> use <code>ldap_uidattr</code> attribute in filter because
 this attribute will be substituted in LDAP filter automatically.</p>
<p><strong><code>ldap_dn_filter: { Filter: FilterAttrs }</code></strong>:   This filter is applied on the results returned by the main filter.
 This filter performs additional LDAP lookup to make the complete
 result. This is useful when you are unable to define all filter
 rules in <code>ldap_filter</code>. You can define <code>%u</code>, <code>%d</code>, <code>%s</code> and <code>%D</code>
 pattern variables in Filter: <code>%u</code> is replaced by a user’s part of a
 JID, <code>%d</code> is replaced by the corresponding domain (virtual host),
 all <code>%s</code> variables are consecutively replaced by values of
 FilterAttrs attributes and <code>%D</code> is replaced by Distinguished Name.
 By default <code>ldap_dn_filter</code> is undefined. Example:</p>
<div class="language-text highlight"><pre><span></span><code> ldap_dn_filter:
   &quot;(&amp;(name=%s)(owner=%D)(user=%u@%d))&quot;: [sn]
</code></pre></div>
<p>Since this filter makes additional LDAP lookups, use it only in the
last resort: try to define all filter rules in <code>ldap_filter</code> if
possible.</p>
<h3 id="ldap-examples">LDAP Examples<a class="headerlink" href="#ldap-examples" title="Permanent link">&para;</a></h3>
<h4 id="common-example">Common example<a class="headerlink" href="#common-example" title="Permanent link">&para;</a></h4>
<p>Let’s say <code>ldap.example.org</code> is the name of our LDAP server. We have
users with their passwords in <code>ou=Users,dc=example,dc=org</code> directory.
Also we have addressbook, which contains users emails and their
additional infos in <code>ou=AddressBook,dc=example,dc=org</code> directory. The
connection to the LDAP server is encrypted using TLS, and using the
custom port 6123. Corresponding authentication section should looks like
this:</p>
<p>## Authentication method
 auth_method: [ldap]
 ## DNS name of our LDAP server
 ldap_servers: [ldap.example.org]
 ## Bind to LDAP server as "cn=Manager,dc=example,dc=org" with password "secret"
 ldap_rootdn: "cn=Manager,dc=example,dc=org"
 ldap_password: secret
 ldap_encrypt: tls
 ldap_port: 6123
 ## Define the user's base
 ldap_base: "ou=Users,dc=example,dc=org"
 ## We want to authorize users from 'shadowAccount' object class only
 ldap_filter: "(objectClass=shadowAccount)"</p>
<p>Now we want to use users LDAP-info as their vCards. We have four
attributes defined in our LDAP schema: <code>mail</code> — email address,
<code>givenName</code> — first name, <code>sn</code> — second name, <code>birthDay</code> — birthday.
Also we want users to search each other. Let’s see how we can set it up:</p>
<p>modules:
   ...
   mod_vcard:
     db_type: ldap
     ## We use the same server and port, but want to bind anonymously because
     ## our LDAP server accepts anonymous requests to
     ## "ou=AddressBook,dc=example,dc=org" subtree.
     ldap_rootdn: ""
     ldap_password: ""
     ## define the addressbook's base
     ldap_base: "ou=AddressBook,dc=example,dc=org"
     ## uidattr: user's part of JID is located in the "mail" attribute
     ## uidattr_format: common format for our emails
     ldap_uids:
       mail: "%u@mail.example.org"
     ## We have to define empty filter here, because entries in addressbook does not
     ## belong to shadowAccount object class
     ldap_filter: ""
     ## Now we want to define vCard pattern
     ldap_vcard_map:
      NICKNAME: {"%u": []} # just use user's part of JID as their nickname
      GIVEN: {"%s": [givenName]}
      FAMILY: {"%s": [sn]}
      FN: {"%s, %s": [sn, givenName]} # example: "Smith, John"
      EMAIL: {"%s": [mail]}
      BDAY: {"%s": [birthDay]}]}
     ## Search form
     ldap_search_fields:
       User: "%u"
       Name: givenName
       "Family Name": sn
       Email: mail
       Birthday: birthDay
     ## vCard fields to be reported
     ## Note that JID is always returned with search results
     ldap_search_reported:
       "Full Name": FN
       Nickname: NICKNAME
       Birthday: BDAY
   ...</p>
<p>Note that <code>mod_vcard</code> with LDAP backend checks for the existence of the user
before searching their information in LDAP.</p>
<h4 id="active-directory">Active Directory<a class="headerlink" href="#active-directory" title="Permanent link">&para;</a></h4>
<p>Active Directory is just an LDAP-server with predefined attributes. A
sample configuration is shown below:</p>
<p>auth_method: [ldap]
 ldap_servers: [office.org]  # List of LDAP servers
 ldap_base: "DC=office,DC=org" # Search base of LDAP directory
 ldap_rootdn: "CN=Administrator,CN=Users,DC=office,DC=org" # LDAP manager
 ldap_password: "<strong><em>*</em></strong>" # Password to LDAP manager
 ldap_uids: [sAMAccountName]
 ldap_filter: "(memberOf=*)"</p>
<p>modules:
   ...
   mod_vcard:
     db_type: ldap
     ldap_vcard_map:
       NICKNAME: {"%u": []}
       GIVEN: {"%s": [givenName]}
       MIDDLE: {"%s": [initials]}
       FAMILY: {"%s": [sn]}
       FN: {"%s": [displayName]}
       EMAIL: {"%s": [mail]}
       ORGNAME: {"%s": [company]}
       ORGUNIT: {"%s": [department]}
       CTRY: {"%s": [c]}
       LOCALITY: {"%s": [l]}
       STREET: {"%s": [streetAddress]}
       REGION: {"%s": [st]}
       PCODE: {"%s": [postalCode]}
       TITLE: {"%s": [title]}
       URL: {"%s": [wWWHomePage]}
       DESC: {"%s": [description]}
       TEL: {"%s": [telephoneNumber]}]}
     ldap_search_fields:
       User: "%u"
       Name: givenName
       "Family Name": sn
       Email: mail
       Company: company
       Department: department
       Role: title
       Description: description
       Phone: telephoneNumber
     ldap_search_reported:
       "Full Name": FN
       Nickname: NICKNAME
       Email: EMAIL
   ...</p>
<h2 id="redis">Redis<a class="headerlink" href="#redis" title="Permanent link">&para;</a></h2>
<p><a href="https://redis.io/"><code>Redis</code></a> is an advanced key-value cache and store. You can
use it to store transient data, such as records for C2S (client) sessions.
There are several options available:</p>
<p><strong><code>redis_server: String</code></strong>:   A hostname of the Redis server. The default is <code>localhost</code>.</p>
<p><strong><code>redis_port: Port</code></strong>:   The port where the Redis server is accepting connections. The default
 is 6379.</p>
<p><strong><code>redis_password: String</code></strong>:   The password to the Redis server. The default is an empty string,
 i.e. no password.</p>
<p><strong><code>redis_db: N</code></strong>:   Redis database number. The default is 0.</p>
<p><strong><code>redis_connect_timeout: N</code></strong>:   A number of seconds to wait for the connection to be established to the Redis
 server. The default is 1 second.</p>
<p>Example configuration:</p>
<p>redis_server: redis.server.com
 redis_db: 1</p>
<h2 id="default-database-configuration">Default database configuration<a class="headerlink" href="#default-database-configuration" title="Permanent link">&para;</a></h2>
<p>You can simplify the configuration by setting the default database. This can be done with <code>default_db</code> option:</p>
<p><strong><code>default_db: mnesia|sql</code></strong>:  This will define the default database for a module lacking <code>db_type</code> option or if <code>auth_method</code> option is not set.</p>
<h1 id="session-management">Session Management<a class="headerlink" href="#session-management" title="Permanent link">&para;</a></h1>
<p>By default pointers to C2S sessions are kept in Mnesia. You may want to
use another database backend for this. The option is:</p>
<p><strong><code>sm_db_type: mnesia|sql|redis</code></strong>:   Note that for <code>sql</code> or <code>redis</code> you should have them configured. See sections
 <a href="#relational-databases">Relational Databases</a> or <a href="#redis">Redis</a>.</p>
<h1 id="modules-configuration">Modules Configuration<a class="headerlink" href="#modules-configuration" title="Permanent link">&para;</a></h1>
<p>The option <code>modules</code> defines the list of modules that will be loaded
after <code>ejabberd</code>’s startup. Each entry in the list is a tuple in which
the first element is the name of a module and the second is a list of
options for that module.</p>
<p>The syntax is:</p>
<p><strong><code>modules: { ModuleName: ModuleOptions }</code></strong></p>
<p>Examples:</p>
<ul>
<li>In this example only the module <code>mod_muc</code> is loaded and no module
 options are specified between the square brackets:</li>
</ul>
<p>modules:
    mod_muc: {}</p>
<ul>
<li>In the second example the modules <code>mod_muc</code>, <code>mod_time</code>, and
 <code>mod_version</code> are loaded without options.</li>
</ul>
<p>modules:
    mod_muc:       {}
    mod_time:      {}
    mod_version:   {}</p>
<h2 id="modules-overview">Modules Overview<a class="headerlink" href="#modules-overview" title="Permanent link">&para;</a></h2>
<p>The following table lists all modules included in <code>ejabberd</code>.</p>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Module</strong></th>
<th style="text-align: left;"><strong>Feature</strong></th>
<th style="text-align: left;"><strong>Dependencies</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">mod_adhoc</td>
<td style="text-align: left;">Ad-Hoc Commands (<a href="https://xmpp.org/extensions/xep-0050.html"><code>XEP-0050</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_announce">mod_announce</a></td>
<td style="text-align: left;">Manage announcements</td>
<td style="text-align: left;">recommends <code>mod_adhoc</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_block_strangers">mod_block_strangers</a></td>
<td style="text-align: left;">Block packets from non-subscribers</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">mod_blocking</td>
<td style="text-align: left;">Simple Communications Blocking (<a href="https://xmpp.org/extensions/xep-0191.html"><code>XEP-0191</code></a>)</td>
<td style="text-align: left;"><code>mod_privacy</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_bosh">mod_bosh</a></td>
<td style="text-align: left;">BOSH (<a href="https://xmpp.org/extensions/xep-0124.html"><code>XEP-0124</code></a>) and XMPP over BOSH (<a href="https://xmpp.org/extensions/xep-0206.html"><code>XEP-0206</code></a>)</td>
<td style="text-align: left;"><code>ejabberd_c2s</code> listener</td>
</tr>
<tr>
<td style="text-align: left;">mod_caps</td>
<td style="text-align: left;">Entity Capabilities (<a href="https://xmpp.org/extensions/xep-0115.html"><code>XEP-0115</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">mod_carboncopy</td>
<td style="text-align: left;">Message Carbons (<a href="https://xmpp.org/extensions/xep-0280.html"><code>XEP-0280</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_client_state">mod_client_state</a></td>
<td style="text-align: left;">Filter stanzas for inactive clients</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">mod_configure</td>
<td style="text-align: left;">Server configuration using Ad-Hoc</td>
<td style="text-align: left;"><code>mod_adhoc</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_delegation">mod_delegation</a></td>
<td style="text-align: left;">Namespace Delegation (<a href="https://xmpp.org/extensions/xep-0355.html"><code>XEP-0355</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_disco">mod_disco</a></td>
<td style="text-align: left;">Service Discovery (<a href="https://xmpp.org/extensions/xep-0030.html"><code>XEP-0030</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_fail2ban">mod_fail2ban</a></td>
<td style="text-align: left;">Bans IPs that show the malicious signs</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_http_api">mod_http_api</a></td>
<td style="text-align: left;">REST API for ejabberd using JSON data</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_http_fileserver">mod_http_fileserver</a></td>
<td style="text-align: left;">Small HTTP file server</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_http_upload">mod_http_upload</a></td>
<td style="text-align: left;">HTTP File Upload (<a href="https://xmpp.org/extensions/xep-0363.html"><code>XEP-0363</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_http_upload_quota">mod_http_upload_quota</a></td>
<td style="text-align: left;">HTTP File Upload Quotas</td>
<td style="text-align: left;"><code>mod_http_upload</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_jidprep">mod_jidprep</a></td>
<td style="text-align: left;">JID Prep (<a href="https://xmpp.org/extensions/xep-0328.html"><code>XEP-0328</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_last">mod_last</a></td>
<td style="text-align: left;">Last Activity (<a href="https://xmpp.org/extensions/xep-0012.html"><code>XEP-0012</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_mam">mod_mam</a></td>
<td style="text-align: left;">Message Archive Management (<a href="https://xmpp.org/extensions/xep-0313.html"><code>XEP-0313</code></a>)</td>
<td style="text-align: left;"><code>mod_mam</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_mix">mod_mix</a></td>
<td style="text-align: left;">Mediated Information eXchange (<a href="https://xmpp.org/extensions/xep-0369.html"><code>XEP-0369</code></a>)</td>
<td style="text-align: left;"><code>mod_pubsub</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_metrics">mod_metrics</a></td>
<td style="text-align: left;">Simple metrics handler for runtime statistics</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_muc">mod_muc</a></td>
<td style="text-align: left;">Multi-User Chat (<a href="https://xmpp.org/extensions/xep-0045.html"><code>XEP-0045</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">mod_muc_admin</td>
<td style="text-align: left;">Administrative commands for Multi-User Chat</td>
<td style="text-align: left;"><code>mod_muc</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_muc_log">mod_muc_log</a></td>
<td style="text-align: left;">Multi-User Chat room logging</td>
<td style="text-align: left;"><code>mod_muc</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_multicast">mod_multicast</a></td>
<td style="text-align: left;">Extended Stanza Addressing (<a href="https://xmpp.org/extensions/xep-0033.html"><code>XEP-0033</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_offline">mod_offline</a></td>
<td style="text-align: left;">Offline message storage (<a href="https://xmpp.org/extensions/xep-0160.html"><code>XEP-0160</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_ping">mod_ping</a></td>
<td style="text-align: left;">XMPP Ping and periodic keepalives (<a href="https://xmpp.org/extensions/xep-0199.html"><code>XEP-0199</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_pres_counter">mod_pres_counter</a></td>
<td style="text-align: left;">Detect presence subscription flood</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_privacy">mod_privacy</a></td>
<td style="text-align: left;">Blocking Communication (<a href="https://xmpp.org/extensions/xep-0016.html"><code>XEP-0016</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_private">mod_private</a></td>
<td style="text-align: left;">Private XML Storage (<a href="https://xmpp.org/extensions/xep-0049.html"><code>XEP-0049</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_privilege">mod_privilege</a></td>
<td style="text-align: left;">Privileged Entity (<a href="https://xmpp.org/extensions/xep-0356.html"><code>XEP-0356</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_proxy65">mod_proxy65</a></td>
<td style="text-align: left;">SOCKS5 Bytestreams (<a href="https://xmpp.org/extensions/xep-0065.html"><code>XEP-0065</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_pubsub">mod_pubsub</a></td>
<td style="text-align: left;">Pub-Sub (<a href="https://xmpp.org/extensions/xep-0060.html"><code>XEP-0060</code></a>), PEP (<a href="https://xmpp.org/extensions/xep-0163.html"><code>XEP-0163</code></a>)</td>
<td style="text-align: left;"><code>mod_caps</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_push">mod_push</a></td>
<td style="text-align: left;">Push Notifications (<a href="https://xmpp.org/extensions/xep-0357.html"><code>XEP-0357</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_push_keepalive">mod_push_keepalive</a></td>
<td style="text-align: left;">Keep sessions of push clients alive</td>
<td style="text-align: left;"><code>mod_push</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_register">mod_register</a></td>
<td style="text-align: left;">In-Band Registration (<a href="https://xmpp.org/extensions/xep-0077.html"><code>XEP-0077</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_register_web">mod_register_web</a></td>
<td style="text-align: left;">Web for Account Registrations</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_roster">mod_roster</a></td>
<td style="text-align: left;">Roster management (XMPP IM)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_s2s_dialback">mod_s2s_dialback</a></td>
<td style="text-align: left;">Server Dialback (<a href="https://xmpp.org/extensions/xep-0220.html"><code>XEP-0220</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_service_log">mod_service_log</a></td>
<td style="text-align: left;">Copy user messages to logger service</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_shared_roster">mod_shared_roster</a></td>
<td style="text-align: left;">Shared roster management</td>
<td style="text-align: left;"><code>mod_roster</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_shared_roster_ldap">mod_shared_roster_ldap</a></td>
<td style="text-align: left;">LDAP Shared roster management</td>
<td style="text-align: left;"><code>mod_roster</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_sic">mod_sic</a></td>
<td style="text-align: left;">Server IP Check (<a href="https://xmpp.org/extensions/xep-0279.html"><code>XEP-0279</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_sip">mod_sip</a></td>
<td style="text-align: left;">SIP Registrar/Proxy (<a href="https://tools.ietf.org/html/rfc3261"><code>RFC 3261</code></a>)</td>
<td style="text-align: left;"><code>ejabberd_sip</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_stats">mod_stats</a></td>
<td style="text-align: left;">Statistics Gathering (<a href="https://xmpp.org/extensions/xep-0039.html"><code>XEP-0039</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_stream_mgmt">mod_stream_mgmt</a></td>
<td style="text-align: left;">Stream Management (<a href="https://xmpp.org/extensions/xep-0198.html"><code>XEP-0198</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_time">mod_time</a></td>
<td style="text-align: left;">Entity Time (<a href="https://xmpp.org/extensions/xep-0202.html"><code>XEP-0202</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_vcard">mod_vcard</a></td>
<td style="text-align: left;">vcard-temp (<a href="https://xmpp.org/extensions/xep-0054.html"><code>XEP-0054</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_vcard_xupdate">mod_vcard_xupdate</a></td>
<td style="text-align: left;">vCard-Based Avatars (<a href="https://xmpp.org/extensions/xep-0153.html"><code>XEP-0153</code></a>)</td>
<td style="text-align: left;"><code>mod_vcard</code></td>
</tr>
<tr>
<td style="text-align: left;"><a href="#mod_version">mod_version</a></td>
<td style="text-align: left;">Software Version (<a href="https://xmpp.org/extensions/xep-0092.html"><code>XEP-0092</code></a>)</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<ul>
<li>(*) This module requires a supported database. For a list of
 supported databases, see section <a href="#database-and-ldap-configuration">Database and LDAP Configuration</a>.</li>
</ul>
<p>You can see which database backend each module needs by looking at the
suffix:</p>
<ul>
<li>
<p>No suffix, this means that the module uses Erlang’s built-in
 database Mnesia as backend or SQL database
 (see <a href="#database-and-ldap-configuration">Database and LDAP Configuration</a>).</p>
</li>
<li>
<p>‘_ldap’, this means that the module needs an LDAP server as
 backend.</p>
</li>
</ul>
<p>You can find more
<a href="https://ejabberd.im/contributions"><code>contributed modules</code></a> on the
<code>ejabberd</code> website. Please remember that these contributions might not
work or that they can contain severe bugs and security leaks. Therefore,
use them at your own risk!</p>
<h2 id="common-options">Common Options<a class="headerlink" href="#common-options" title="Permanent link">&para;</a></h2>
<p>The following options are used by many modules. Therefore, they are
described in this separate section.</p>
<h3 id="host">host<a class="headerlink" href="#host" title="Permanent link">&para;</a></h3>
<p>This option defines the Jabber ID of a service provided by an <code>ejabberd</code>
module.</p>
<p>The syntax is:</p>
<p><strong><code>host: HostName</code></strong>:</p>
<p>If you include the keyword “@HOST@” in the HostName, it is replaced at
start time with the real virtual host string.</p>
<p>This example configures the MUC module to provide its service
in the Jabber ID <code>conference.example.org</code>:</p>
<p>modules:
   ...
   mod_muc:
     host: conference.example.org
   ...</p>
<p>However, if there are several virtual hosts and this module is enabled
in all of them, the “@HOST@” keyword must be used:</p>
<p>modules:
   ...
   mod_muc:
     host: "conference.@HOST@"
   ...</p>
<h3 id="caching">Caching<a class="headerlink" href="#caching" title="Permanent link">&para;</a></h3>
<p>There are several global options to enable caching and configure its behaviour:</p>
<p><strong><code>use_cache: false|true</code></strong>:   Enable or disable cache. The default is <code>true</code>.</p>
<p><strong><code>cache_missed: false|true</code></strong>:   Whether or not to cache missed lookups.
    When there is an attempt to lookup for a value in a database and this
    value is not found and the option is set to <code>true</code>, this attempt will
    be cached and no attempts will be performed until the cache expires.
    Usually you don't want to change it. Default is <code>true</code>.</p>
<p><strong><code>cache_size: Items|infinity</code></strong>:    A maximum number of items (not memory!) in cache.
    The rule of thumb, for all tables except rosters, you should set it to
    the number of maximum online users you expect.
    For roster multiply this number by 20 or so.
    If the cache size reaches this threshold, it's fully cleared, i.e.
    all items are deleted, and the corresponding warning is logged.
    You should avoid frequent cache clearance, because this degrades performance.
    The default value is 1000.</p>
<p><strong><code>cache_life_time: Seconds|infinity</code></strong>:    The time (in seconds) of a cached item to keep in cache.
    Once it's expired, the corresponding item is erased from cache.
    The default value is 3600 seconds, that is one hour.</p>
<p>These options can also be defined specifically in several modules.
Additionally, some core ejabberd parts support those options,
like <code>auth</code>, <code>oauth</code>, <code>router</code> and <code>sm</code>.
In those cases, please prepend the option names with the part name,
for example <code>router_use_cache</code>, or <code>sm_cache_size</code>.</p>
<h2 id="mod_admin_extra">mod_admin_extra<a class="headerlink" href="#mod_admin_extra" title="Permanent link">&para;</a></h2>
<p>Available option:</p>
<p><strong><code>module_resource: Resource</code></strong>:   Indicate the resource that the XMPP stanzas must use in the FROM or TO JIDs.
    This is only useful in the vcard set and get commands.
    The default value is "mod_admin_extra".</p>
<p>In this example configuration, the users vCards can only be modified
by executing <code>mod_admin_extra</code> commands:</p>
<div class="language-text highlight"><pre><span></span><code>acl:
  adminextraresource:
    - resource: &quot;modadminextraf8x,31ad&quot;
access_rules:
  vcard_set:
    - allow: adminextraresource
modules:
  mod_admin_extra:
    module_resource: &quot;modadminextraf8x,31ad&quot;
  mod_vcard:
    access_set: vcard_set
</code></pre></div>
<p>Description of some commands:</p>
<p><strong><code>pushroster</code></strong>:  The file used by <code>pushroster</code> and <code>pushroster-all</code> must be placed:
     - Windows: on the directory were you installed ejabberd:
       <code>C:/Program Files/ejabberd</code>
     - Other OS: on the same directory where the .beam files are.
   Example content for the roster file:</p>
<p>[{&lt;&lt;"bob"&gt;&gt;, &lt;&lt;"example.org"&gt;&gt;, &lt;&lt;"workers"&gt;&gt;, &lt;&lt;"Bob"&gt;&gt;},
   {&lt;&lt;"mart"&gt;&gt;, &lt;&lt;"example.org"&gt;&gt;, &lt;&lt;"workers"&gt;&gt;, &lt;&lt;"Mart"&gt;&gt;},
   {&lt;&lt;"Rich"&gt;&gt;, &lt;&lt;"example.org"&gt;&gt;, &lt;&lt;"bosses"&gt;&gt;, &lt;&lt;"Rich"&gt;&gt;}].</p>
<p><strong><code>srg-create</code></strong>:  If you want to put a group Name with blankspaces, use the characters
   "' and '" to define when the Name starts and ends. For example:</p>
<p>ejabberdctl srg-create g1 example.org "'Group number 1'" this_is_g1 g1</p>
<p><strong><code>ban-account</code></strong>:  This command kicks all the connected sessions of the account from the
   server.  It also changes their password to a randomly
   generated one, so they can't login anymore unless a server administrator
   changes their password again.</p>
<p>It is possible to define the reason of the ban.  The new password
also includes the reason and the date and time of the ban.</p>
<p>For example, if this command is called:</p>
<p>ejabberdctl vhost example.org ban-account boby Spammed several MUC rooms</p>
<p>then the sessions of the local account which JID is <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#98;&#111;&#98;&#121;&#64;&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#111;&#114;&#103;">&#98;&#111;&#98;&#121;&#64;&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#111;&#114;&#103;</a>
will be kicked, and its password will be set to something like this:</p>
<p>BANNED_ACCOUNT--20080425T21:45:07--2176635--Spammed_several_MUC_rooms</p>
<h2 id="mod_announce">mod_announce<a class="headerlink" href="#mod_announce" title="Permanent link">&para;</a></h2>
<p>This module enables configured users to broadcast announcements and to
set the message of the day (MOTD). Configured users can perform these
actions with a XMPP client either using Ad-hoc commands or sending
messages to specific JIDs.</p>
<p>The Ad-hoc commands are listed in the Server Discovery. For this feature
to work, <code>mod_adhoc</code> must be enabled.</p>
<p>The specific JIDs where messages can be sent are listed below. The
first JID in each entry will apply only to the specified virtual host
<code>example.org</code>, while the JID between brackets will apply to all virtual
hosts in ejabberd.</p>
<p><strong><code>example.org/announce/all (example.org/announce/all-hosts/all)</code></strong>:   The message is sent to all registered users. If the user is online
 and connected to several resources, only the resource with the
 highest priority will receive the message. If the registered user is
 not connected, the message will be stored offline in assumption that
 offline storage (see section  <a href="#mod_offline">mod_offline</a>) is enabled.</p>
<p><strong><code>example.org/announce/online (example.org/announce/all-hosts/online)</code></strong>:   The message is sent to all connected users. If the user is online
 and connected to several resources, all resources will receive the
 message.</p>
<p><strong><code>example.org/announce/motd (example.org/announce/all-hosts/motd)</code></strong>:   The message is set as the message of the day (MOTD) and is sent to
 users when they login. In addition the message is sent to all
 connected users (similar to <code>announce/online</code>).</p>
<p><strong><code>example.org/announce/motd/update (example.org/announce/all-hosts/motd/update)</code></strong>:   The message is set as message of the day (MOTD) and is sent to users
 when they login. The message is <em>not sent</em> to any currently
 connected user.</p>
<p><strong><code>example.org/announce/motd/delete (example.org/announce/all-hosts/motd/delete)</code></strong>:   Any message sent to this JID removes the existing message of the day
 (MOTD).</p>
<p>Options:</p>
<p><strong><code>db_type: mnesia|sql</code></strong>:   Define the type of storage where the module will create the tables and store user information. The default is the storage defined by the global option <code>default_db</code>, or <code>mnesia</code> if omitted. If <code>sql</code> value is defined, make sure you have defined the database, see <a href="#database-and-ldap-configuration">database</a>.</p>
<p><strong><code>use_cache: false|true</code></strong>:   Use this option and related ones as explained in section <a href="#caching">Caching</a>.</p>
<p><strong><code>access: AccessName</code></strong>:   This option specifies who is allowed to send announcements and to
 set the message of the day (by default, nobody is able to send such
 messages).</p>
<p>Examples:</p>
<ul>
<li>Only administrators can send announcements:</li>
</ul>
<p>access_rules:
    announce:
      - allow: admin</p>
<p>modules:
    ...
    mod_adhoc: {}
    mod_announce:
      access: announce
    ...</p>
<ul>
<li>Administrators as well as the direction can send announcements:</li>
</ul>
<p>acl:
    direction:
      user:
        big_boss@example.org
        assistant@example.org
    admin:
      user:
        admin@example.org
  access_rules:
    announce:
      - allow: admin
      - allow: direction</p>
<p>modules:
    ...
    mod_adhoc: {}
    mod_announce:
      access: announce
    ...</p>
<p>Note that <code>mod_announce</code> can be resource intensive on large deployments
as it can broadcast lot of messages. This module should be disabled for
instances of <code>ejabberd</code> with hundreds of thousands users.</p>
<h2 id="mod_block_strangers">mod_block_strangers<a class="headerlink" href="#mod_block_strangers" title="Permanent link">&para;</a></h2>
<p>This module allows to block/log messages coming from an unknown entity.
If a writing entity is not in your roster, you can let this module drop and/or
log the message. By default you'll just not receive message from that entity.
Enable this module if you want to drop SPAM messages.</p>
<p>Options:</p>
<p><strong><code>drop: true|false</code></strong>:   This option specifies if strangers messages should
be dropped or not. The default value is <code>true</code>.</p>
<p><strong><code>log: true|false</code></strong>:   This option specifies if strangers messages should
be logged (as info message) in ejabberd logs. The default value is <code>false</code>.</p>
<p><strong><code>allow_local_users: true|false</code></strong>:   This option specifies if strangers from
the same local host should be accepted or not. The default value is <code>true</code>.</p>
<p><strong><code>allow_transports: true|false</code></strong>:   If set to <code>true</code> and some server's JID
is in user's roster, then messages from any user of this server are
accepted even if no subscription present. The default value is <code>true</code>.</p>
<p><strong><code>captcha: true|false</code></strong>: Whether to generate CAPTCHA or not in response
to messages from strangers. See also section <a href="#captcha">CAPTCHA</a>. The
default value is <code>false</code>.</p>
<h2 id="mod_bosh">mod_bosh<a class="headerlink" href="#mod_bosh" title="Permanent link">&para;</a></h2>
<p>This module implements XMPP over BOSH as defined in <a href="https://xmpp.org/extensions/xep-0124.html"><code>XEP-0124</code></a> and <a href="https://xmpp.org/extensions/xep-0206.html"><code>XEP-0206</code></a>. BOSH stands for
Bidirectional-streams Over Synchronous HTTP. It makes it possible to simulate long lived connections required by XMPP
over HTTP protocol. In practice, this module makes it possible to use XMPP in a browser without Websocket support and
more generally to have a way to use XMPP while having to get through an HTTP proxy.</p>
<h3 id="enabling-bosh-support">Enabling BOSH support<a class="headerlink" href="#enabling-bosh-support" title="Permanent link">&para;</a></h3>
<p><code>mod_bosh</code> extends ejabberd’s built in HTTP service with a configurable resource at which this service will be hosted.</p>
<p>To use XMPP over BOSH, enable the module:</p>
<p>modules:
   ...
   mod_bosh: {}
   ...</p>
<p>and add <code>mod_bosh</code> in the HTTP listener service, together with <code>ejabberd_c2s</code>. For example:</p>
<p>listen:
   -
     port: 5222
     module: ejabberd_c2s
     max_stanza_size: 65536
     shaper: c2s_shaper
     access: c2s
   ...
   -
     port: 5280
     module: ejabberd_http
     request_handlers:
        /bosh: mod_bosh
        /admin: ejabberd_web_admin
   ...</p>
<p>With this configuration, the module will serve the requests sent to
<code>http://example.org:5280/bosh/</code></p>
<p>Please, remember that this page is not designed to be used by web browsers, it is used by XMPP clients that support XMPP
over BOSH.</p>
<h3 id="options_1">Options<a class="headerlink" href="#options_1" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>{max_inactivity, Seconds}</code></strong>:   Define the maximum inactivity period in seconds. Default value is 30
 seconds. For example, to set 50 seconds:</p>
<p>modules:
   ...
   mod_bosh:
     max_inactivity: 50
   ...</p>
</li>
<li>
<p><strong><code>use_cache: false|true</code></strong>:   Use this option and related ones as explained in section <a href="#caching">Caching</a>.</p>
</li>
</ul>
<!-- TODO Document options:
json, max_concat, max_inactivity, max_pause, prebind, ram_db_type,     queue_type, use_cache, cache_size, cache_missed, cache_life_time
-->

<h3 id="discovery">Discovery<a class="headerlink" href="#discovery" title="Permanent link">&para;</a></h3>
<p>You also need to configure DNS SRV records properly so clients can
easily discover a BOSH server serving your XMPP domain. Refer to
<a href="https://xmpp.org/extensions/xep-0156.html">XEP-0156</a>.</p>
<p>Example DNS TXT configuration for BOSH:</p>
<div class="language-text highlight"><pre><span></span><code>_xmppconnect IN TXT &quot;[ _xmpp-client-xbosh=https://web.example.org:5280/bosh ]&quot;
</code></pre></div>
<h2 id="mod_client_state">mod_client_state<a class="headerlink" href="#mod_client_state" title="Permanent link">&para;</a></h2>
<p>This module allows for queueing certain types of stanzas when a client
indicates that the user is not actively using the client right now (see
<a href="https://xmpp.org/extensions/xep-0352.html"><code>XEP-0352</code></a>). This can save bandwidth and resources.</p>
<p>A stanza is dropped from the queue if it's effectively obsoleted by a new
one (e.g., a new presence stanza would replace an old one from the same
client). The queue is flushed if a stanza arrives that won't be queued, or
if the queue size reaches a certain limit (currently 100 stanzas), or if
the client becomes active again.</p>
<p>Options:</p>
<p><strong><code>queue_chat_states: true|false</code></strong>:   Queue “standalone” chat state notifications (as defined in
 <a href="https://xmpp.org/extensions/xep-0085.html"><code>XEP-0085</code></a>) while a
 client indicates inactivity. The default value is <code>true</code>.</p>
<p><strong><code>queue_pep: true|false</code></strong>:   Queue PEP notifications while a client is inactive. When the queue is
 flushed, only the most recent notification of a given PEP node is
 delivered. The default value is <code>true</code>.</p>
<p><strong><code>queue_presence: true|false</code></strong>:   While a client is inactive, queue presence stanzas that indicate
 (un)availability. The default value is <code>true</code>.</p>
<p>Example:</p>
<p>modules:
   ...
   mod_client_state:
     queue_chat_states: true
     queue_pep: false
     queue_presence: true
   ...</p>
<h2 id="mod_delegation">mod_delegation<a class="headerlink" href="#mod_delegation" title="Permanent link">&para;</a></h2>
<p>This module is an implementation of (<a href="https://xmpp.org/extensions/xep-0355.html"><code>XEP-0355</code></a>). Only admin mode has been implemented by now. Namespace delegation allows external services to handle IQ using specific namespace. This may be applied for external PEP service.</p>
<p>Example:</p>
<p>To use the module add <code>mod_delegation</code> to <code>modules</code> section. If you want to delegate namespaces to a component, specify them in the namespaces option, and associate them to a access rule, e.g.:</p>
<p>module:
  ...
    mod_delegation:
      namespaces:
        "urn:xmpp:mam:1":
           filtering: [node]
           access: external_mam
        "http://jabber.org/protocol/pubsub":
           access: external_pubsub
    ...</p>
<p>You'll also have to define the access rules to allow the component to handle the namespaces:</p>
<p>access_rules:
   ...
     external_pubsub:
            - allow: external_component
     external_mam:
            - allow: external_component</p>
<p>acl:
   ...
     external_component:
       server:
         - sat-pubsub.example.org</p>
<p>In the example above <code>sat-pubsub.example.org</code> will receive all <code>pubsub</code> requests and all <code>MAM</code> requests with the <code>node</code> filtering attribute presented in <code>&lt;query/&gt;</code>.</p>
<p>Make sure you do not delegate the same namespace to several services at the same time. As in the example above to have the <code>sat-pubsub.example.org</code> component perform correctly disable the <code>mod_pubsub</code> module.</p>
<h3 id="security-issue">Security issue<a class="headerlink" href="#security-issue" title="Permanent link">&para;</a></h3>
<p>Namespace delegation gives components access to sensitive data, so permission should be granted carefully, only if you trust the component.</p>
<h3 id="note">Note<a class="headerlink" href="#note" title="Permanent link">&para;</a></h3>
<p>This module is complementary to <code>mod_privilege</code> (<a href="https://xmpp.org/extensions/xep-0356.html"><code>XEP-0356</code></a>) but can also be used separately.</p>
<h2 id="mod_disco">mod_disco<a class="headerlink" href="#mod_disco" title="Permanent link">&para;</a></h2>
<p>This module adds support for Service Discovery
(<a href="https://xmpp.org/extensions/xep-0030.html"><code>XEP-0030</code></a>). With this
module enabled, services on your server can be discovered by XMPP
clients. Note that <code>ejabberd</code> has no modules with support for the
superseded Jabber Browsing
(<a href="https://xmpp.org/extensions/xep-0011.html"><code>XEP-0011</code></a>) and Agent
Information (<a href="https://xmpp.org/extensions/xep-0094.html"><code>XEP-0094</code></a>).
Accordingly, XMPP clients need to have support for the newer Service
Discovery protocol if you want them be able to discover the services you
offer.</p>
<p>Options:</p>
<p><strong><code>extra_domains: [Domain, ...]</code></strong>:   With this option, you can specify a list of extra domains that are
 added to the Service Discovery item list.</p>
<p><strong><code>server_info: [ { modules: Modules, name: Name, urls: [URL, ...] } ]</code></strong>:   Specify additional information about the server, as described in
 Contact Addresses for XMPP Services
 (<a href="https://xmpp.org/extensions/xep-0157.html"><code>XEP-0157</code></a>). <code>Modules</code>
 can be the keyword ‘all’, in which case the information is reported
 in all the services; or a list of <code>ejabberd</code> modules, in which case
 the information is only specified for the services provided by those
 modules. Any arbitrary <code>Name</code> and <code>URL</code> can be specified, not only
 contact addresses.</p>
<p>Examples:</p>
<ul>
<li>To serve a link to the Jabber User Directory on <code>jabber.org</code>:</li>
</ul>
<p>modules:
    ...
    mod_disco:
      extra_domains: [users.jabber.org]
    ...</p>
<ul>
<li>To serve a link to the transports on another server:</li>
</ul>
<p>modules:
    ...
    mod_disco:
      extra_domains:
        - icq.example.com
        - msn.example.com
    ...</p>
<ul>
<li>To serve a link to a few friendly servers:</li>
</ul>
<p>modules:
    ...
    mod_disco:
      extra_domains:
        - example.org
        - example.com
    ...</p>
<ul>
<li>With this configuration, all services show abuse addresses, feedback
 address on the main server, and admin addresses for both the main
 server and the vJUD service:</li>
</ul>
<p>modules:
    ...
    mod_disco:
      server_info:
        -
          modules: all
          name: abuse-addresses
          urls: [mailto:abuse@shakespeare.lit]
        -
          modules: [mod_muc]
          name: "Web chatroom logs"
          urls: [http://www.example.org/muc-logs]
        -
          modules: [mod_disco]
          name: feedback-addresses
          urls:
            - http://shakespeare.lit/feedback.php
            - mailto:feedback@shakespeare.lit
            - xmpp:feedback@shakespeare.lit
        -
          modules:
            - mod_disco
            - mod_vcard
          name: admin-addresses
          urls:
            - mailto:xmpp@shakespeare.lit
            - xmpp:admins@shakespeare.lit
    ...</p>
<h2 id="mod_fail2ban">mod_fail2ban<a class="headerlink" href="#mod_fail2ban" title="Permanent link">&para;</a></h2>
<p>The module bans IPs that show the malicious signs. Currently only C2S
authentication failures are detected.</p>
<p>Unlike the <a href="https://github.com/fail2ban/fail2ban">fail2ban standalone program</a>, <code>mod_fail2ban</code>
clears the record of authentication failures <code>c2s_auth_ban_lifetime</code>
seconds after the first failure or on a successful authentication. It
also does not simply block network traffic, but provides the client with
a descriptive error message.</p>
<p>Available options:</p>
<p><strong><code>c2s_auth_ban_lifetime: Seconds</code></strong>:   The lifetime of the IP ban caused by too many C2S authentication
 failures. The default is 3600, i.e. one hour.</p>
<p><strong><code>c2s_max_auth_failures: Integer</code></strong>:   The number of C2S authentication failures to trigger the IP ban. The
 default is 20.</p>
<p><strong><code>access: AccessName</code></strong>:   Specify an access rule for whitelisting IP addresses or networks. If
 the rule returns ‘<code>allow</code>’ for a given IP address, that
 address will never be banned. The <code>AccessName</code> should be of type
 <code>ip</code>. The default value is <code>none</code>.</p>
<p>Example:</p>
<p>modules:
   ...
   mod_fail2ban:
     c2s_auth_ban_lifetime: 7200
     c2s_max_auth_failures: 50
   ...</p>
<p><em>Warning</em>: You should not use <code>mod_fail2ban</code> behind a proxy or load balancer. ejabberd will see the failures as coming
from the load balancer and, when the threshold of auth failures is reached, will reject all connections coming from the
load balancer. You can lock all your user base out of ejabberd when using <code>mod_fail2ban</code> behind a proxy.</p>
<h2 id="mod_http_api">mod_http_api<a class="headerlink" href="#mod_http_api" title="Permanent link">&para;</a></h2>
<p>This module provides a ReST API to call ejabberd commands using JSON data.</p>
<p>To start using it, simply add it as a request handler, for example:</p>
<p>listen:
   -
     port: 5280
     module: ejabberd_http
     request_handlers:
       /api: mod_http_api</p>
<p>To use a specific API version N, add a vN element in the URL path, like:</p>
<div class="language-text highlight"><pre><span></span><code>   /api/v2: mod_http_api
</code></pre></div>
<p>Access rights are defined with those global options:</p>
<p>commands_admin_access: configure
 commands:
   - add_commands: user</p>
<p><code>add_commands</code> allows exporting a class of commands, from</p>
<ul>
<li>
<p><code>open</code>: methods that are not risky and can be called without any access check</p>
</li>
<li>
<p><code>restricted</code>: the same, but will appear only in ejabberdctl list. This is the default.</p>
</li>
<li>
<p><code>admin</code>: auth is required with XMLRPC and HTTP API and checked for admin privileges, works as usual in ejabberdctl.</p>
</li>
<li>
<p><code>user</code>: can be used through XMLRPC and HTTP API, even by user. Only admin can use the commands for other users.</p>
</li>
</ul>
<p>Then, to run a command, send a POST request to the following URL:
<code>http://localhost:5280/api/&lt;command_name&gt;</code></p>
<p>It's also possible to enable unrestricted access to some commands from group
of IP addresses by using option <code>admin_ip_access</code> by having fragment like
this in configuration file:</p>
<p>modules:
   mod_http_api:
     admin_ip_access: admin_ip_access_rule</p>
<p>access:
   admin_ip_access_rule:
     admin_ip_acl:
       - command1
       - command2
       ## use <code>all</code> to give access to all commands</p>
<p>acl:
   admin_ip_acl:
     ip:
       - 127.0.0.1/8</p>
<h2 id="mod_http_fileserver">mod_http_fileserver<a class="headerlink" href="#mod_http_fileserver" title="Permanent link">&para;</a></h2>
<p>This simple module serves files from the local disk over HTTP.</p>
<p>Options:</p>
<p><strong><code>docroot: Path</code></strong>:   Directory to serve the files.</p>
<p><strong><code>accesslog: Path</code></strong>:   File to log accesses using an Apache-like format. No log will be
 recorded if this option is not specified.</p>
<p><strong><code>directory_indices: [Index, ...]</code></strong>:   Indicate one or more directory index files, similarly to Apache’s
 DirectoryIndex variable. When a web request hits a directory instead
 of a regular file, those directory indices are looked in order, and
 the first one found is returned.</p>
<p><strong><code>custom_headers: {Name: Value}</code></strong>:   Indicate custom HTTP headers to be included in all responses.
 Default value is: <code>[]</code></p>
<p><strong><code>content_types: {Name: Type}</code></strong>:   Specify mappings of extension to content type. There are several
 content types already defined, with this option you can add new
 definitions, modify or delete existing ones. To delete an existing
 definition, simply define it with a value: ‘undefined’.</p>
<p><strong><code>default_content_type: Type</code></strong>:   Specify the content type to use for unknown extensions. Default
 value is ‘application/octet-stream’.</p>
<p>This example configuration will serve the files from the local directory
<code>/var/www</code> in the address <code>http://example.org:5280/pub/archive/</code>. In
this example a new content type <code>ogg</code> is defined, <code>png</code> is redefined,
and <code>jpg</code> definition is deleted. To use this module you must enable it:</p>
<p>modules:
   ...
   mod_http_fileserver:
     docroot: /var/www
     accesslog: /var/log/ejabberd/access.log
     directory_indices:
       - index.html
       - main.htm
     custom_headers:
       X-Powered-By: Erlang/OTP
       X-Fry: "It's a widely-believed fact!"
     content_types:
       .ogg: audio/ogg
       .png: image/png
       .jpg: undefined
     default_content_type: text/html
   ...</p>
<p>And define it as a handler in the HTTP service:</p>
<p>listen:
   ...
   -
     port: 5280
     module: ejabberd_http
     request_handlers:
       ...
       /pub/archive: mod_http_fileserver
       ...
   ...</p>
<h2 id="mod_http_upload">mod_http_upload<a class="headerlink" href="#mod_http_upload" title="Permanent link">&para;</a></h2>
<p>This module allows for requesting permissions to upload a file via HTTP
as described in <a href="https://xmpp.org/extensions/xep-0363.html"><code>XEP-0363</code></a>. If the request is accepted, the
client receives a URL for uploading the file and another URL from which
that file can later be downloaded.</p>
<p>In order to use this module, it must be configured as a
<code>request_handler</code> for an <code>ejabberd_http</code> listener.</p>
<p>Options:</p>
<p><strong><code>host: HostName</code></strong>: This option defines the JID for the HTTP upload service. The keyword
“@HOST@” is replaced with the virtual host name. Default:
<code>upload.@HOST@</code>.</p>
<p><strong><code>name: Text</code></strong>: This option defines the Service Discovery name for the HTTP upload
service. Default: <code>HTTP File Upload</code>.</p>
<p><strong><code>access: AccessName</code></strong>: This option defines the access rule to limit who is permitted to use
the HTTP upload service. The default value is <code>local</code>. If no access rule
of that name exists, no user will be allowed to use the service.</p>
<p><strong><code>max_size: Size</code></strong>: This option limits the acceptable file size. Either a number of bytes
(larger than zero) or <code>infinity</code> must be specified. Default:
<code>104857600</code>.</p>
<p><strong><code>secret_length: Length</code></strong>: This option defines the length of the random string included in the
GET and PUT URLs generated by <code>mod_http_upload</code>. The minimum length is
<code>8</code> characters, but it is recommended to choose a larger value. Default:
<code>40</code>.</p>
<p><strong><code>jid_in_url: node|sha1</code></strong>: When this option is set to <code>node</code>, the node identifier of the user's
JID (i.e., the user name) is included in the GET and PUT URLs generated
by <code>mod_http_upload</code>. Otherwise, a SHA-1 hash of the user's bare JID is
included instead. Default: <code>sha1</code>.</p>
<p><strong><code>thumbnail: true|false</code></strong>: This option specifies whether ejabberd should create thumbnails of
uploaded images. If a thumbnail is created, a <code>&lt;thumbnail/&gt;</code> element
that contains the download <code>&lt;uri/&gt;</code> and some metadata is returned with
the PUT response. Default: <code>false</code>.</p>
<p><strong><code>file_mode: Mode</code></strong>: This option defines the permission bits of uploaded files. The bits
are specified as an octal number (see the <code>chmod(1)</code> manual page) within
double quotes. For example: <code>"0644"</code>. Default: <code>undefined</code>.</p>
<p><strong><code>dir_mode: Mode</code></strong>: This option defines the permission bits of the <code>docroot</code> directory and
any directories created during file uploads. The bits are specified as
an octal number (see the <code>chmod(1)</code> manual page) within double quotes.
For example: <code>"0755"</code>. Default: <code>undefined</code>.</p>
<p><strong><code>docroot: Path</code></strong>: Uploaded files are stored below the directory specified (as an
absolute path) with this option. The keyword <code>@HOME@</code> is replaced with
the home directory of the user running ejabberd, and the keyword
<code>@HOST@</code> with the virtual host name. Default: <code>"@HOME@/upload"</code>.</p>
<p><strong><code>put_url: URL</code></strong>: This option specifies the initial part of the PUT URLs used for file
uploads. The keyword <code>@HOST@</code> is replaced with the virtual host name.
Default: <code>"https://@HOST@:5443"</code>. <em>Note: Different virtual hosts cannot
use the same PUT URL.</em></p>
<p><strong><code>get_url: URL</code></strong>: This option specifies the initial part of the GET URLs used for
downloading the files. By default, it is set to the same value as the
<code>put_url</code>. The keyword <code>@HOST@</code> is replaced with the virtual host name.
<em>Note: If GET requests are handled by <code>mod_http_upload</code>, the <code>get_url</code>
must match the <code>put_url</code>.</em> Setting it to a different value only makes
sense if an external web server or <code>mod_http_fileserver</code> is used to
serve the uploaded files.</p>
<p><strong><code>service_url: URL</code></strong>:
WARNING: <strong>The <code>service_url</code> option is deprecated</strong> and will be unsupported
in future releases, better use the <code>external_secret</code> option instead.
If a <code>service_url</code> is specified, upload slot requests are forwarded to
this external service instead of being handled by <code>mod_http_upload</code>
itself. Whenever an upload slot request is accepted as per the <code>access</code>
rule, a HTTP GET query with <code>jid</code>, <code>name</code>, <code>size</code>, and <code>content_type</code>
fields is issued. In order to accept the request, the service must
return an HTTP status code of 200 or 201 and two lines of text/plain
output. The first line is forwarded to the XMPP client as the PUT URL,
the second line as the GET URL. In order to reject the request, the
service should return a status code of 402 (<code>resource-constraint</code>), 403
(<code>not-allowed</code>), or 413 (<code>not-acceptable</code>). Default: <code>undefined</code>.</p>
<p><strong><code>custom_headers: {Name: Value}</code></strong>: This option specifies additional header fields to be included in all
HTTP responses. Default: <code>[]</code>.</p>
<p><strong><code>rm_on_unregister: true|false</code></strong>: This option specifies whether files uploaded by a user should be
removed when that user is unregistered. Default: <code>true</code>.</p>
<p><strong><code>external_secret: "text"</code></strong>: This option makes it possible to offload
all HTTP Upload processing to a separate HTTP server. Both ejabberd and
the HTTP server should share this secret and behave exactly as described
at <a href="https://modules.prosody.im/mod_http_upload_external.html">Prosody's mod_http_upload_external</a>
in the 'Implementation' section. Default: <code>undefined</code>.</p>
<p>Example:</p>
<p>certfiles:
   - /etc/ejabberd/certificate.pem</p>
<p>listen:
   ...
   -
     port: 5443
     module: ejabberd_http
     tls: true
     request_handlers:
       ...
       upload: mod_http_upload
       ...
   ...</p>
<p>modules:
   ...
   mod_http_upload:
     docroot: /ejabberd/upload
     put_url: "https://@HOST@:5443/upload"
   ...</p>
<p>And using a separate HTTP server to host the files:</p>
<p>modules:
   ...
   mod_http_upload:
     put_url: https://separate.http.server/upload
     external_secret: "foo bar baz"
   ...</p>
<h2 id="mod_http_upload_quota">mod_http_upload_quota<a class="headerlink" href="#mod_http_upload_quota" title="Permanent link">&para;</a></h2>
<p>This module adds quota support for <code>mod_http_upload</code>.</p>
<p>Options:</p>
<p><strong><code>max_days: Days</code></strong>: If a number larger than zero is specified, any files (and directories)
older than this number of days are removed from the subdirectories of the
<code>docroot</code> directory, once per day. Default: <code>infinity</code>.</p>
<p><strong><code>access_hard_quota: AccessName</code></strong>: This option defines which access rule is used to specify the "hard
quota" for the matching JIDs. That rule must yield a positive number for
any JID that is supposed to have a quota limit. This is the number of
megabytes a corresponding user may upload. When this threshold is
exceeded, ejabberd deletes the oldest files uploaded by that user until
their disk usage equals or falls below the specified soft quota (see
below).</p>
<p><strong><code>access_soft_quota: AccessName</code></strong>: This option defines which access rule is used to specify the "soft
quota" for the matching JIDs. That rule must yield a positive number of
megabytes for any JID that is supposed to have a quota limit. See the
description of the <code>access_hard_quota</code> option for details.</p>
<p>Note: It's not necessary to specify the <code>access_hard_quota</code> and
<code>access_soft_quota</code> options in order to use the quota feature. You can
stick to the default names and just specify access rules such as those
in the following example.</p>
<p>shaper_rules:
   ...
   soft_upload_quota:
     - 1000: all # MiB
   hard_upload_quota:
     - 1100: all # MiB
   ...</p>
<p>modules:
   ...
   mod_http_upload: {}
   mod_http_upload_quota:
     max_days: 100
   ...</p>
<h2 id="ejabberd_http_ws">ejabberd_http_ws<a class="headerlink" href="#ejabberd_http_ws" title="Permanent link">&para;</a></h2>
<p>This module enables XMPP communication over Websocket connection as
described in <a href="https://tools.ietf.org/html/rfc7395"><code>RFC 7395</code></a>.</p>
<h3 id="enabling-websocket-support">Enabling Websocket support<a class="headerlink" href="#enabling-websocket-support" title="Permanent link">&para;</a></h3>
<p>To enable this module it must have handler added to <code>request_handlers</code>
section of <code>ejabberd_http</code> listener:</p>
<p>listen:
   ...
   -
     port: 5280
     module: ejabberd_http
     request_handlers:
       ...
       /xmpp: ejabberd_http_ws
       ...
   ...</p>
<p>This module can be configured by using those options that should be
placed in general section of config file:</p>
<ul>
<li>
<p><strong><code>websocket_origin: ignore|URL</code></strong>: This option enables validation for <code>"Origin"</code> header
to protect against connections from other domains than given in config.
In this way, the lower layer load balancer can get chosen for a specific
ejabberd implementation while still providing a secure websocket connection.
Default value of this option is <code>ignore</code>.
Example value of URL: <code>"https://test.example.org:8081"</code></p>
</li>
<li>
<p><strong><code>websocket_ping_interval: Seconds</code></strong>: Defines time between pings send by server to client (Websocket level
protocol pings are used for this) to keep connection active. If client
won't respond to two corresponding pings connection will be assumed as
closed. Value of <code>0</code> can be used to disable it feature. This options
do make server send pings only for connections using rfc compliant
protocol, for older style connections server expects that whitespace
pings would be used for this purpose. Default value of this option
is set to 60.</p>
</li>
<li>
<p><strong><code>websocket_timeout: Seconds</code></strong>: Amount of time without any communication after which connection
would be closed. The specified number of seconds must be larger than 0.
This option is set to 300 by default.</p>
</li>
</ul>
<h3 id="discovery_1">Discovery<a class="headerlink" href="#discovery_1" title="Permanent link">&para;</a></h3>
<p>You also need to configure DNS SRV records properly so clients can
easily discover Websocket service for your XMPP domain. Refer to
<a href="https://xmpp.org/extensions/xep-0156.html">XEP-0156</a>.</p>
<p>Example DNS TXT configuration for Websocket:</p>
<div class="language-text highlight"><pre><span></span><code>_xmppconnect IN TXT &quot;[ _xmpp-client-websocket=wss://web.example.com:443/ws ]&quot;
</code></pre></div>
<h3 id="testing-websocket">Testing Websocket<a class="headerlink" href="#testing-websocket" title="Permanent link">&para;</a></h3>
<p>A test client can be found on Github: <a href="https://github.com/processone/xmpp-websocket-client">Websocket test client</a></p>
<!-- TODO We should probably embed a test Websocket client on the Websocket info get page. -->

<h2 id="mod_jidprep">mod_jidprep<a class="headerlink" href="#mod_jidprep" title="Permanent link">&para;</a></h2>
<p>This module allows XMPP clients to ask the server to normalize a JID as
per the rules specified in <a href="https://tools.ietf.org/html/rfc6122"><code>RFC 6122: XMPP Address Format</code></a>. This
might be useful for clients in certain constrained environments, or for
testing purposes.</p>
<p>Options:</p>
<p><strong><code>access: AccessName</code></strong>:   This option defines which access rule will be
 used to control who is allowed to use this service. The default
 is <code>local</code>.</p>
<h2 id="mod_last">mod_last<a class="headerlink" href="#mod_last" title="Permanent link">&para;</a></h2>
<h3 id="description">Description<a class="headerlink" href="#description" title="Permanent link">&para;</a></h3>
<p>This module adds support for Last Activity
(<a href="https://xmpp.org/extensions/xep-0012.html"><code>XEP-0012</code></a>). It can be used
to discover when a disconnected user last accessed the server, to know
when a connected user was last active on the server, or to query the
uptime of the <code>ejabberd</code> server.</p>
<h3 id="options_2">Options<a class="headerlink" href="#options_2" title="Permanent link">&para;</a></h3>
<p><strong><code>db_type: mnesia|sql</code></strong>:   Define the type of storage where the module will create the tables and store user information. The default is the storage defined by the global option <code>default_db</code>, or <code>mnesia</code> if omitted. If <code>sql</code> value is defined, make sure you have defined the database, see <a href="#database-and-ldap-configuration">database</a>.</p>
<p><strong><code>use_cache: false|true</code></strong>:   Use this option and related ones as explained in section <a href="#caching">Caching</a>.</p>
<h3 id="example-configuration">Example Configuration<a class="headerlink" href="#example-configuration" title="Permanent link">&para;</a></h3>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="nt">modules</span><span class="p">:</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="w">  </span><span class="nt">mod_last</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</span></code></pre></div>
<h3 id="implementation-notes">Implementation notes<a class="headerlink" href="#implementation-notes" title="Permanent link">&para;</a></h3>
<p>You may want to disable that module depending on several parameters:</p>
<ul>
<li><strong>Privacy:</strong> You may not want to store the last presence of your users
  in database.</li>
<li><strong>Performance:</strong> If you have usage pattern with large spike of
  disconnect, you may want to disable that module to limit traffic
  spike on your <code>mod_last</code> database backend.</li>
</ul>
<p>Note that you may want also to purge last activity that is too old to
limit the storage size of those data.</p>
<h2 id="mod_mam">mod_mam<a class="headerlink" href="#mod_mam" title="Permanent link">&para;</a></h2>
<p>This module implements Message Archive Management as described in <a href="https://xmpp.org/extensions/xep-0313.html"><code>XEP-0313</code></a>. Versions 0.2 and 0.3 are supported at the moment. Compatible XMPP clients can use it to store their chat history on the server.</p>
<p>Options:</p>
<p><strong><code>assume_mam_usage: true|false</code></strong>: This option determines how
  ejabberd's stream management code handles unacknowledged messages
  when the connection is lost. Usually, such messages are either
  bounced or resent. However, neither is done for messages that were
  stored in the user's MAM archive if this option is set to <code>true</code>. In
  this case, ejabberd assumes those messages will be retrieved from
  the archive. The default is <code>false</code>.</p>
<p><strong><code>compress_xml: true|false</code></strong>: When enabled, new messages added to
  archives are compressed using a custom compression algorithm (for
  details see the <a href="https://www.process-one.net/blog/ejabberd-18-12/"><code>ejabberd 18.12 release
  notes</code></a>). This feature
  works only with <code>db_type: sql</code>. The default value is <code>false</code>.</p>
<p><strong><code>db_type: mnesia|sql</code></strong>: Define the type of storage where the module
  will create the tables and store user information. The default is
  the storage defined by the global option <code>default_db</code>, or <code>mnesia</code>
  if omitted. If <code>sql</code> value is defined, make sure you have defined
  the database, see <a href="#database-and-ldap-configuration">database</a>.
  Note: If <code>mnesia</code> is used, the total size of all MAM archives cannot
  exceed 2 GB. The <code>delete_old_mam_messages</code> command could be run
  periodically to make sure the <code>mnesia</code> data won't grow beyond that
  limit. To support larger archives, <code>sql</code> storage must be used.</p>
<p><strong><code>default: always|never|roster</code></strong>: The option defines default policy
  for chat history. When <code>always</code> is set every chat message is
  stored. With <code>roster</code> only chat history with contacts from user's
  roster is stored. <code>never</code> fully disables chat history. Note that a
  client can change its policy via protocol commands. The default is
  <code>never</code>.</p>
<p><strong><code>request_activates_archiving: true|false</code></strong>: If this option is
  enabled, no messages are stored for a user until their client issue
  a MAM request, regardless of the value of the <code>default</code> option. Once
  the server received a request, that user's messages are archived as
  usual. The default is <code>false</code>.</p>
<p><strong><code>use_cache: false|true</code></strong>: Use this option and related ones as
  explained in section <a href="#caching">Caching</a>.</p>
<p><strong><code>user_mucsub_from_muc_archive: false|true</code></strong>: this option is used
to enable storage optimization when using MucSub on large chat rooms along
with MAM. The default is <code>false</code> (disabled), to keep former behaviour as
default.</p>
<h2 id="mod_mix">mod_mix<a class="headerlink" href="#mod_mix" title="Permanent link">&para;</a></h2>
<p>This module is an experimental implementation Mediated Information
eXchange (MIX) as described in <a href="https://xmpp.org/extensions/xep-0369.html"><code>XEP-0369</code></a>. Our implementation is
based on version 0.13.0.</p>
<p>This feature was added in ejabberd 16.03 as an experimental feature,
updated in 19.02, and is not yet ready to use in production.</p>
<p>To learn more about how to use that feature, you can refer to our
tutorial:
<a href="../../tutorials/mix-010/">Getting started with XEP-0369: Mediated Information eXchange (MIX) v0.1</a>.</p>
<h2 id="mod_metrics">mod_metrics<a class="headerlink" href="#mod_metrics" title="Permanent link">&para;</a></h2>
<p>This module sends events to external backend (by now it only
supports grapherl). Supported events are: sm_register_connection,
sm_remove_connection, user_send_packet, user_receive_packet,
s2s_send_packet, s2s_receive_packet, register_user, remove_user,
offline_message.</p>
<p>When enabled, every call to these hooks triggers a counter event
to the configured backend.</p>
<p>Backend is not configurable yet, by now it requires to be grapherl
running in localhost and listening to port 11111.</p>
<h2 id="mod_muc">mod_muc<a class="headerlink" href="#mod_muc" title="Permanent link">&para;</a></h2>
<p>This module provides a Multi-User Chat
(<a href="https://xmpp.org/extensions/xep-0045.html"><code>XEP-0045</code></a>) service. Users
can discover existing rooms, join or create them. Occupants of a room
can chat in public or have private chats.</p>
<p>Some of the features of Multi-User Chat:</p>
<ul>
<li>
<p>Sending public and private messages to room occupants.</p>
</li>
<li>
<p>Inviting other users to a room.</p>
</li>
<li>
<p>Setting a room subject.</p>
</li>
<li>
<p>Creating password protected rooms.</p>
</li>
<li>
<p>Kicking and banning occupants.</p>
</li>
</ul>
<p>The MUC service allows any Jabber ID to register a nickname, so nobody
else can use that nickname in any room in the MUC service. To register a
nickname, open the Service Discovery in your XMPP client and register in
the MUC service.</p>
<p>This module supports clustering and load balancing. One module can be
started per cluster node. Rooms are distributed at creation time on all
available MUC module instances. The multi-user chat module is clustered
but the rooms themselves are not clustered nor fault-tolerant: if the
node managing a set of rooms goes down, the rooms disappear and they
will be recreated on an available node on first connection attempt.</p>
<p>Module options:</p>
<p><strong><code>host: HostName</code></strong>:   This option defines the Jabber ID of the service. If the <code>host</code>
 option is not specified, the Jabber ID will be the hostname of the
 virtual host with the prefix ‘<code>conference.</code>’. The keyword “@HOST@”
 is replaced at start time with the real virtual host name.</p>
<p><strong><code>db_type: mnesia|sql</code></strong>:   Define the type of storage where the module will create the tables and store user information. The default is the storage defined by the global option <code>default_db</code>, or <code>mnesia</code> if omitted. If <code>sql</code> value is defined, make sure you have defined the database, see <a href="#database-and-ldap-configuration">database</a>.</p>
<p><strong><code>access: AccessName</code></strong>:   You can specify who is allowed to use the Multi-User Chat service.
 By default everyone is allowed to use it.</p>
<p><strong><code>access_create: AccessName</code></strong>:   To configure who is allowed to create new rooms at the Multi-User
 Chat service, this option can be used. By default any account in the
 local ejabberd server is allowed to create rooms.</p>
<p><strong><code>access_persistent: AccessName</code></strong>:   To configure who is allowed to modify the ’persistent’ room option.
 By default any account in the local ejabberd server is allowed to
 modify that option.</p>
<p><strong><code>access_mam: AccessName</code></strong>:   To configure who is allowed to modify the ’mam’ room option.
 By default any account in the local ejabberd server is allowed to
 modify that option.</p>
<p><strong><code>access_admin: AccessName</code></strong>:   This option specifies who is allowed to administrate the Multi-User
 Chat service. The default value is <code>none</code>, which means that only the
 room creator can administer their room. The administrators can send a
 normal message to the service JID, and it will be shown in all
 active rooms as a service message. The administrators can send a
 groupchat message to the JID of an active room, and the message will
 be shown in the room as a service message.</p>
<p><strong><code>access_register: AccessName</code></strong>:   This option specifies who is allowed to
 register nickname within the Multi-User Chat service. The default is <code>all</code>
 for backward compatibility, which means that any user is allowed to
 register any free nick.</p>
<p><strong><code>history_size: Size</code></strong>:   A small history of the current discussion is sent to users when they
 enter the room. With this option you can define the number of
 history messages to keep and send to users joining the room. The
 value is an integer. Setting the value to <code>0</code> disables the history
 feature and, as a result, nothing is kept in memory. The default
 value is <code>20</code>. This value is global and thus affects all rooms on
 the service.</p>
<p><strong><code>max_users: Number</code></strong>:   This option defines at the service level, the maximum number of
 users allowed per room. It can be lowered in each room configuration
 but cannot be increased in individual room configuration. The
 default value is 200.</p>
<p><strong><code>max_users_admin_threshold: Number</code></strong>:   This option defines the number of service admins or room owners
 allowed to enter the room when the maximum number of allowed
 occupants was reached. The default limit is 5.</p>
<p><strong><code>max_user_conferences: Number</code></strong>:   This option defines the maximum number of rooms that any given user
 can join. The default value is 100. This option is used to prevent
 possible abuses. Note that this is a soft limit: some users can
 sometimes join more conferences in cluster configurations.</p>
<p><strong><code>max_room_id: Number</code></strong>:   This option defines the maximum number of characters that Room ID
 can have when creating a new room. The default value is to not
 limit: <code>infinity</code>.</p>
<p><strong><code>regexp_room_id: String</code></strong>:   This option defines the regular expression that a Room ID must satisfy
 to allow the room creation. The default value is the empty string.</p>
<p><strong><code>max_room_name: Number</code></strong>:   This option defines the maximum number of characters that Room Name
 can have when configuring the room. The default value is to not
 limit: <code>infinity</code>.</p>
<p><strong><code>max_room_desc: Number</code></strong>:   This option defines the maximum number of characters that Room
 Description can have when configuring the room. The default value is
 to not limit: <code>infinity</code>.</p>
<p><strong><code>max_rooms_discoitems: Number</code></strong>:   When there are more rooms than this Number,
 only the non-empty ones are returned in a Service Discovery query.
 The default value is: 100.</p>
<p><strong><code>min_message_interval: Number</code></strong>:   This option defines the minimum interval between two messages send
 by an occupant in seconds. This option is global and valid for all
 rooms. A decimal value can be used. When this option is not defined,
 message rate is not limited. This feature can be used to protect a
 MUC service from occupant abuses and limit number of messages that
 will be broadcasted by the service. A good value for this minimum
 message interval is 0.4 second. If an occupant tries to send
 messages faster, an error is send back explaining that the message
 has been discarded and describing the reason why the message is not
 acceptable.</p>
<p><strong><code>min_presence_interval: Number</code></strong>:   This option defines the minimum of time between presence changes
 coming from a given occupant in seconds. This option is global and
 valid for all rooms. A decimal value can be used. When this option
 is not defined, no restriction is applied. This option can be used
 to protect a MUC service for occupants abuses. If an occupant tries
 to change its presence more often than the specified interval, the
 presence is cached by <code>ejabberd</code> and only the last presence is
 broadcasted to all occupants in the room after expiration of the
 interval delay. Intermediate presence packets are silently
 discarded. A good value for this option is 4 seconds.</p>
<p><strong><code>max_users_presence: Number</code></strong>:   This option defines after how many users in the room, it is
    considered overcrowded. When a MUC room is considered overcrowed,
    presence broadcasts are limited to reduce load, traffic and excessive
    presence 'storm' received by participants.</p>
<p><strong><code>default_room_options: {OptionName: OptionValue}</code></strong>:   This module option allows to define the desired default room
 options. Note that the creator of a room can modify the options of
 his room at any time using an XMPP client with MUC capability.
 All of those room options can be set to <code>true</code> or <code>false</code>, except
 <code>password</code> and <code>title</code> which are strings, and <code>max_users</code> that is
 integer. The
 available room options and the default values are:</p>
<ul>
<li>
<p><strong><code>allow_change_subj: true|false</code></strong>:   Allow occupants to change the subject.</p>
</li>
<li>
<p><strong><code>allow_private_messages: true|false</code></strong>:   Occupants can send private messages to other occupants.</p>
</li>
<li>
<p><strong><code>allow_private_messages_from_visitors: anyone|moderators|nobody</code></strong>:   Visitors can send private messages to other occupants.</p>
</li>
<li>
<p><strong><code>allow_query_users: true|false</code></strong>:   Occupants can send IQ queries to other occupants.</p>
</li>
<li>
<p><strong><code>allow_subscription: true|false</code></strong>:   Allow users to subscribe to room events as described in
 <a href="../../developer/xmpp-clients-bots/extensions/muc-sub/"><code>Multi-User Chat Subscriptions</code></a>.</p>
</li>
<li>
<p><strong><code>allow_user_invites: false|true</code></strong>:   Allow occupants to send invitations.</p>
</li>
<li>
<p><strong><code>allow_visitor_nickchange: true|false</code></strong>:   Allow visitors to change nickname.</p>
</li>
<li>
<p><strong><code>allow_visitor_status: true|false</code></strong>:   Allow visitors to send status text in presence updates. If
     disallowed, the <code>status</code> text is stripped before broadcasting
     the presence update to all the room occupants.</p>
</li>
<li>
<p><strong><code>anonymous: true|false</code></strong>:   The room is anonymous: occupants don’t see the real JIDs of
     other occupants. Note that the room moderators can always see
     the real JIDs of the occupants.</p>
</li>
<li>
<p><strong><code>captcha_protected: false|true</code></strong>:   When a user tries to join a room where they have no affiliation
     (not owner, admin or member), the room requires them to fill a
     CAPTCHA challenge (see section <a href="#captcha">CAPTCHA</a>) in order to accept their
     join in the room.</p>
</li>
<li>
<p><strong><code>lang: Language</code></strong>:   Preferred language for the discussions in the room.
     The language format should conform to RFC 5646.</p>
</li>
<li>
<p><strong><code>logging: false|true</code></strong>:   The public messages are logged using <code>mod_muc_log</code>.</p>
</li>
<li>
<p><strong><code>mam: false|true</code></strong>:   Enable message archiving. Implies <code>mod_mam</code> is enabled.</p>
</li>
<li>
<p><strong><code>max_users: Number</code></strong>:   Maximum number of occupants in the room. The default value is 200.</p>
</li>
<li>
<p><strong><code>members_by_default: true|false</code></strong>:   The occupants that enter the room are participants by default,
     so they have ’voice’.</p>
</li>
<li>
<p><strong><code>members_only: false|true</code></strong>:   Only members of the room can enter.</p>
</li>
<li>
<p><strong><code>moderated: true|false</code></strong>:   Only occupants with ’voice’ can send public messages.</p>
</li>
<li>
<p><strong><code>password: roompass123</code></strong>:   Password of the room. You may want to enable the next option
     too.</p>
</li>
<li>
<p><strong><code>password_protected: false|true</code></strong>:   The password is required to enter the room.</p>
</li>
<li>
<p><strong><code>persistent: false|true</code></strong>:   The room persists even if the last participant leaves.</p>
</li>
<li>
<p><strong><code>presence_broadcast: [moderator, participant, visitor]</code></strong>:   List of roles for which presence is broadcasted.
 The list can contain one or several of: moderator, participant, visitor.</p>
</li>
<li>
<p><strong><code>public: true|false</code></strong>:   The room is public in the list of the MUC service, so it can be
     discovered. MUC admins and room participants will see private rooms in Service Discovery,
     and the room name will have the word: "private".</p>
</li>
<li>
<p><strong><code>public_list: true|false</code></strong>:   The list of participants is public, without requiring to enter
     the room.</p>
</li>
<li>
<p><strong><code>title: Room Title</code></strong>:   A human-readable title of the room.</p>
</li>
</ul>
<p>Examples:</p>
<ul>
<li>In the first example everyone is allowed to use the Multi-User Chat
 service. Everyone will also be able to create new rooms but only the
 user <code>admin@example.org</code> is allowed to administrate any room. In
 this example they are also a global administrator. When
 <code>admin@example.org</code> sends a message such as ‘Tomorrow, the XMPP
 server will be moved to new hardware. This will involve service
 breakdowns around 23:00 UMT. We apologise for this inconvenience.’
 to <code>conference.example.org</code>, it will be displayed in all active
 rooms. In this example the history feature is disabled.</li>
</ul>
<p>acl:
    admin:
      user:
        - admin@example.org</p>
<p>access_rules:
    muc_admin:
      - allow: admin</p>
<p>modules:
    ...
    mod_muc:
      access: all
      access_create: all
      access_admin: muc_admin
      history_size: 0
    ...</p>
<ul>
<li>In the second example the Multi-User Chat service is only accessible
 by paying customers registered on our domains and on other servers.
 Of course the administrator is also allowed to access rooms. In
 addition, he is the only authority able to create and administer
 rooms. When <code>admin@example.org</code> sends a message such as ‘Tomorrow,
 the Jabber server will be moved to new hardware. This will involve
 service breakdowns around 23:00 UMT. We apologise for this
 inconvenience.’ to <code>conference.example.org</code>, it will be displayed in
 all active rooms. No <code>history_size</code> option is used, this means that
 the feature is enabled and the default value of 20 history messages
 will be send to the users.</li>
</ul>
<p>acl:
    paying_customers:
      user:
        - customer1@example.net
        - customer2@example.com
        - customer3@example.org
    admin:
      user:
        - admin@example.org</p>
<p>access_rules:
    muc_admin
      - allow: admin
    muc_access:
      - allow: paying_customers
      - allow: admin</p>
<p>modules:
    ...
    mod_muc:
      access: muc_access
      access_create: muc_admin
      access_admin: muc_admin
    ...</p>
<ul>
<li>In the following example, MUC anti abuse options are used. An
 occupant cannot send more than one message every 0.4 seconds and
 cannot change its presence more than once every 4 seconds. The
 Room IDs can contain only letters and numbers. The
 length of Room IDs and Room Names are limited to 20 characters, and
 Room Description to 300 characters. No ACLs are defined, but some
 user restriction could be added as well:</li>
</ul>
<p>modules:
    ...
    mod_muc:
      min_message_interval: 0.4
      min_presence_interval: 4
      regexp_room_id: "^[a-z0-9]+$"
      max_room_id: 20
      max_room_name: 20
      max_room_desc: 300
    ...</p>
<ul>
<li>This example shows how to use <code>default_room_options</code> to make sure
 the newly created rooms have by default those options.</li>
</ul>
<p>modules:
    ...
    mod_muc:
      access: muc_access
      access_create: muc_admin
      default_room_options:
        allow_change_subj: false
        allow_query_users: true
        allow_private_messages: true
        members_by_default: false
        presence_broadcast: [visitor, moderator]
        title: "New chatroom"
        anonymous: false
      access_admin: muc_admin
    ...</p>
<h2 id="mod_muc_log">mod_muc_log<a class="headerlink" href="#mod_muc_log" title="Permanent link">&para;</a></h2>
<p>This module enables optional logging of Multi-User Chat (MUC) public
conversations to HTML. Once you enable this module, users can join a
room using a MUC capable XMPP client, and if they have enough
privileges, they can request the configuration form in which they can
set the option to enable room logging.</p>
<p>Features:</p>
<ul>
<li>
<p>Room details are added on top of each page: room title, JID, author,
 subject and configuration.</p>
</li>
<li>
<p>The room JID in the generated HTML is a link to join the room (using
 <a href="https://xmpp.org/rfcs/rfc5122.html"><code>XMPP URI</code></a>).</p>
</li>
<li>
<p>Subject and room configuration changes are tracked and displayed.</p>
</li>
<li>
<p>Joins, leaves, nick changes, kicks, bans and ‘/me’ are tracked and
 displayed, including the reason if available.</p>
</li>
<li>
<p>Generated HTML files are XHTML 1.0 Transitional and CSS compliant.</p>
</li>
<li>
<p>Timestamps are self-referencing links.</p>
</li>
<li>
<p>Links on top for quicker navigation: Previous day, Next day, Up.</p>
</li>
<li>
<p>CSS is used for style definition, and a custom CSS file can be used.</p>
</li>
<li>
<p>URLs on messages and subjects are converted to hyperlinks.</p>
</li>
<li>
<p>Timezone used on timestamps is shown on the log files.</p>
</li>
<li>
<p>A custom link can be added on top of each page.</p>
</li>
</ul>
<p>Options:</p>
<p><strong><code>access_log: AccessName</code></strong>:   This option restricts which occupants are allowed to enable or
 disable room logging. The default value is <code>muc_admin</code>. Note for
 this default setting you need to have an access rule for <code>muc_admin</code>
 in order to take effect.</p>
<p><strong><code>cssfile: false|URL</code></strong>:   With this option you can set whether the HTML files should have a
 custom CSS file or if they need to use the embedded CSS file.
 Allowed values are <code>false</code> and an URL to a CSS file. With the first
 value, HTML files will include the embedded CSS code. With the
 latter, you can specify the URL of the custom CSS file (for example:
 <code>http://example.com/my.css</code>). The default value is <code>false</code>.</p>
<p><strong><code>dirname: room_jid|room_name</code></strong>:   Allows to configure the name of the room directory. Allowed values
 are <code>room_jid</code> and <code>room_name</code>. With the first value, the room
 directory name will be the full room JID. With the latter, the room
 directory name will be only the room name, not including the MUC
 service name. The default value is <code>room_jid</code>.</p>
<p><strong><code>dirtype: subdirs|plain</code></strong>:   The type of the created directories can be specified with this
 option. Allowed values are <code>subdirs</code> and <code>plain</code>. With the first
 value, subdirectories are created for each year and month. With the
 latter, the names of the log files contain the full date, and there
 are no subdirectories. The default value is <code>subdirs</code>.</p>
<p><strong><code>file_format: html|plaintext</code></strong>:   Define the format of the log files: <code>html</code> stores in HTML format,
 <code>plaintext</code> stores in plain text. The default value is <code>html</code>.</p>
<p><strong><code>file_permissions: {mode: Mode, group: Group}</code></strong>:   Define the permissions that must be used when creating the log
 files: the number of the mode, and the numeric id of the group that
 will own the files. The default value is <code>{644, 33}</code>.</p>
<p><strong><code>outdir: Path</code></strong>:   This option sets the full path to the directory in which the HTML
 files should be stored. Make sure the <code>ejabberd</code> daemon user has
 write access on that directory. The default value is <code>www/muc</code>.</p>
<p><strong><code>spam_prevention: true|false</code></strong>:   To prevent spam, the <code>spam_prevention</code> option adds a special
 attribute to links that prevent their indexation by search engines.
 The default value is <code>true</code>, which mean that nofollow attributes
 will be added to user submitted links.</p>
<p><strong><code>timezone: local|universal</code></strong>:   The time zone for the logs is configurable with this option. Allowed
 values are <code>local</code> and <code>universal</code>. With the first value, the local
 time, as reported to Erlang by the operating system, will be used.
 With the latter, GMT/UTC time will be used. The default value is
 <code>local</code>.</p>
<p><strong><code>top_link: {URL: Text}</code></strong>:   With this option you can customize the link on the top right corner
 of each log file. The default value is <code>{/, Home}</code>.</p>
<p><strong><code>url: URL</code></strong>: A top level URL where a client is able to access logs of a particular conference.
        The conference name is appended to the URL if <code>dirname</code> is <code>room_name</code> or
 a conference JID is appended to the URL if <code>dirname</code> is <code>room_jid</code>.</p>
<p>Examples:</p>
<ul>
<li>In the first example any room owner can enable logging, and a custom
 CSS file will be used, <code>http://example.com/my.css</code>. The names of the
 log files will contain the full date, and there will be no
 subdirectories. The log files will be stored in /var/www/muclogs,
 and the time zone will be GMT/UTC. Finally, the top link will be
 <code>&lt;a href="http://www.jabber.ru/"&gt;Jabber.ru&lt;/a&gt;</code>.</li>
</ul>
<p>access_rules:
    - muc: allow</p>
<p>modules:
    ...
    mod_muc_log:
      access_log: muc
      cssfile: http://example.com/my.css
      dirtype: plain
      dirname: room_jid
      outdir: /var/www/muclogs
      timezone: universal
      spam_prevention: true
      top_link:
        http://www.jabber.ru/: Jabber.ru
    ...</p>
<ul>
<li>In the second example only <code>admin1@example.org</code> and
 <code>admin2@example.net</code> can enable logging, and the embedded CSS file
 will be used. The names of the log files will only contain the day
 (number), and there will be subdirectories for each year and month.
 The log files will be stored in /var/www/muclogs, and the local time
 will be used. Finally, the top link will be the default
 <code>&lt;a href="/"&gt;Home&lt;/a&gt;</code>.</li>
</ul>
<p>acl:
    admin:
      user:
        - admin1@example.org
        - admin2@example.net
  access_rules:
    muc_log:
      - allow: admin</p>
<p>modules:
    ...
    mod_muc_log:
      access_log: muc_log
      cssfile: false
      dirtype: subdirs
      file_permissions:
        mode: 644
        group: 33
      outdir: /var/www/muclogs
      timezone: local
    ...</p>
<ul>
<li>In the third example log files are served by <code>mod_http_fileserver</code> module and
    are available at <code>https://domain.tld:5443/chatlogs</code>:<div class="language-text highlight"><pre><span></span><code>  listen:
    ...
    -
      module: ejabberd_http
      port: 5443
      tls: true
      request_hanlers:
        /chatlogs: mod_http_fileserver
        ...

  modules:
    ...
    mod_http_fileserver:
      docroot: /var/www/muclogs
      ...
    mod_muc_log:
      url: https://domain.tld:5443/chatlogs
      outdir: /var/www/muclogs
      ...
</code></pre></div>
</li>
</ul>
<h2 id="mod_multicast">mod_multicast<a class="headerlink" href="#mod_multicast" title="Permanent link">&para;</a></h2>
<p>This module implements a service for Extended Stanza Addressing (<a href="https://xmpp.org/extensions/xep-0033.html"><code>XEP-0033</code></a>)</p>
<h3 id="enabling-multicast">Enabling multicast<a class="headerlink" href="#enabling-multicast" title="Permanent link">&para;</a></h3>
<p>Edit ejabberd.yml and add the module to the list of modules:</p>
<div class="language-text highlight"><pre><span></span><code>mod_multicast: []
</code></pre></div>
<h3 id="configurable-options">Configurable options<a class="headerlink" href="#configurable-options" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong><code>host</code></strong>: Define the hostname of the service. Default value: "multicast.SERVER"</p>
</li>
<li>
<p><strong><code>access</code></strong>: Specify who can send packets to the multicast service. Default value: all</p>
</li>
<li>
<p><strong><code>limits</code></strong>: Specify a list of custom limits which override the default ones defined in XEP-0033.
    Limits are defined per sender type and stanza type, where:</p>
</li>
<li>The sender type can be: local or remote.</li>
<li>The stanza type can be: message or presence.</li>
<li>The number can be a positive integer or the key word infinite.</li>
<li>Default values:</li>
</ul>
<p>local:
   message: 100
   presence: 100
 remote:
   message: 20
   presence: 20</p>
<h3 id="example-configuration_1">Example configuration<a class="headerlink" href="#example-configuration_1" title="Permanent link">&para;</a></h3>
<p># Only admins can send packets to multicast service
 access_rules:
   multicast:
     - allow: admin</p>
<p># If you want to allow all your users:
 access_rules:
   multicast:
     - allow</p>
<p># This allows both admins and remote users to send packets,
 # but does not allow local users
 acl:
   allservers:
     server_glob: "*"
 access_rules:
   multicast:
     - allow: admin
     - deny: local
     - allow: allservers</p>
<p>modules:
   mod_multicast:
      host: multicast.example.org
      access: multicast
      limits:
        local:
          message: 40
          presence: infinite
        remote:
          message: 150</p>
<h3 id="service-check">Service check<a class="headerlink" href="#service-check" title="Permanent link">&para;</a></h3>
<p>You have to restart ejabberd after adding or modifying <code>mod_multicast</code> configuration.</p>
<p>To verify the service is running, login to ejabberd with a XMPP client, open the service discovery and check that
there's a service called "Multicast".</p>
<h3 id="how-to-simulate-group-chat-with-multicast">How to simulate group chat with multicast<a class="headerlink" href="#how-to-simulate-group-chat-with-multicast" title="Permanent link">&para;</a></h3>
<h4 id="for-stanza-sender">For stanza sender<a class="headerlink" href="#for-stanza-sender" title="Permanent link">&para;</a></h4>
<p>Instead of sending two stanzas, like this:</p>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="nt">&lt;message</span><span class="w"> </span><span class="na">to=</span><span class="s">&#39;user2@localhost&#39;</span><span class="w"> </span><span class="na">type=</span><span class="s">&#39;chat&#39;</span><span class="nt">&gt;</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">   </span><span class="nt">&lt;body&gt;</span>Hello,<span class="w"> </span>world!<span class="nt">&lt;/body&gt;</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="nt">&lt;/message&gt;</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="nt">&lt;message</span><span class="w"> </span><span class="na">to=</span><span class="s">&#39;user3@localhost&#39;</span><span class="w"> </span><span class="na">type=</span><span class="s">&#39;chat&#39;</span><span class="nt">&gt;</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="w">   </span><span class="nt">&lt;body&gt;</span>Hello,<span class="w"> </span>world!<span class="nt">&lt;/body&gt;</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="nt">&lt;/message&gt;</span>
</span></code></pre></div>
<p>now you can send a stanza like this:</p>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="nt">&lt;message</span><span class="w"> </span><span class="na">to=</span><span class="s">&#39;multicast.localhost&#39;</span><span class="w"> </span><span class="na">type=</span><span class="s">&#39;chat&#39;</span><span class="nt">&gt;</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="w">   </span><span class="nt">&lt;addresses</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/address&#39;</span><span class="nt">&gt;</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="w">       </span><span class="nt">&lt;address</span><span class="w"> </span><span class="na">type=</span><span class="s">&#39;to&#39;</span><span class="w"> </span><span class="na">jid=</span><span class="s">&#39;user2@localhost&#39;</span><span class="nt">/&gt;</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="w">       </span><span class="nt">&lt;address</span><span class="w"> </span><span class="na">type=</span><span class="s">&#39;cc&#39;</span><span class="w"> </span><span class="na">jid=</span><span class="s">&#39;user3@localhost&#39;</span><span class="nt">/&gt;</span>
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a><span class="w">   </span><span class="nt">&lt;/addresses&gt;</span>
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a><span class="w">   </span><span class="nt">&lt;body&gt;</span>Hello,<span class="w"> </span>world!<span class="nt">&lt;/body&gt;</span>
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a><span class="nt">&lt;/message&gt;</span>
</span></code></pre></div>
<h4 id="for-the-stanza-receivers">For the stanza receivers<a class="headerlink" href="#for-the-stanza-receivers" title="Permanent link">&para;</a></h4>
<p>They will receive something like this:</p>
<div class="language-xml highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="nt">&lt;message</span><span class="w"> </span><span class="na">from=</span><span class="s">&#39;user1@localhost/tka1&#39;</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="w">        </span><span class="na">to=</span><span class="s">&#39;user3@localhost&#39;</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a><span class="w">        </span><span class="na">type=</span><span class="s">&#39;chat&#39;</span><span class="nt">&gt;</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="w">  </span><span class="nt">&lt;addresses</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&#39;http://jabber.org/protocol/address&#39;</span><span class="nt">&gt;</span>
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a><span class="w">    </span><span class="nt">&lt;address</span><span class="w"> </span><span class="na">type=</span><span class="s">&#39;cc&#39;</span>
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="w">        </span><span class="na">jid=</span><span class="s">&#39;user3@localhost&#39;</span><span class="nt">/&gt;</span>
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a><span class="w">  </span><span class="nt">&lt;/addresses&gt;</span>
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="w">  </span><span class="nt">&lt;body&gt;</span>Hello,<span class="w"> </span>world!<span class="nt">&lt;/body&gt;</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a><span class="nt">&lt;/message&gt;</span>
</span></code></pre></div>
<p>The addresses tag let the receiver knows that there were multiple
recipients and can:</p>
<ul>
<li>Display it properly in client interface.</li>
<li>Reply to all recipients.</li>
</ul>
<h2 id="mod_offline">mod_offline<a class="headerlink" href="#mod_offline" title="Permanent link">&para;</a></h2>
<h3 id="description_1">Description<a class="headerlink" href="#description_1" title="Permanent link">&para;</a></h3>
<p>This module implements offline message storage (<a href="https://xmpp.org/extensions/xep-0160.html"><code>XEP-0160</code></a>) and
flexible offline message retrieval
(<a href="https://xmpp.org/extensions/xep-0013.html"><code>XEP-0013</code></a>). This means
that all messages sent to an offline user will be stored on the server
until that user comes online again. Thus it is very similar to how
email works. A user is considered offline if no session presence
priority &gt; 0 are currently open.</p>
<p>Note that <code>ejabberdctl</code> has a command to delete expired messages (see
section <a href="../../admin/guide/managing/#ejabberdctl">Managing: ejabberdctl</a>).</p>
<h3 id="options_3">Options<a class="headerlink" href="#options_3" title="Permanent link">&para;</a></h3>
<p><strong><code>db_type: mnesia|sql</code></strong>: Define the type of storage where the module will create the tables
and store user information. The default is the storage defined by the
global option <code>default_db</code>, or <code>mnesia</code> if omitted. If <code>sql</code> value is defined, make sure you have defined the database, see
<a href="#database-and-ldap-configuration">database</a>.</p>
<p><strong><code>access_max_user_messages: AccessName</code></strong>: This option defines which access rule (atom) will be enforced to
 limit the maximum number of offline messages that a user can have
 (quota).  When a user has too many offline messages, any new
 messages that they receive are discarded, and a resource-constraint
 error is returned to the sender. The default value is
 <code>max_user_offline_messages</code>.  Then you can define an access rule
 with a syntax similar to <code>max_user_sessions</code> (see
 <a href="#limiting-opened-sessions-with-acl">Limiting Opened Sessions with ACL</a>).</p>
<p><strong><code>store_empty_body: true|false|unless_chat_state</code></strong>: Whether or not to store messages that lack a <code>&lt;body/&gt;</code> element. The default
 value is <code>unless_chat_state</code>, which tells ejabberd to store messages
 even if they lack the <code>&lt;body/&gt;</code> element, <em>unless</em> they only contain a
 chat state notification (as defined in
 <a href="https://xmpp.org/extensions/xep-0085.html"><code>XEP-0085</code></a>).</p>
<p><strong><code>pool_size: Size</code></strong>: This option specifies the size of the worker pool for storing
 offline messages. The allowed values are positive integers.
 Default value: <code>16</code>.</p>
<p><strong><code>bounce_groupchat: false|true</code></strong>: This option is use the disable an optimisation that avoids bouncing error messages
when groupchat messages could not be stored as offline. It will reduce chat room load, without any drawback in standard
use cases. You may change default value only if you have a custom module which uses offline hook after mod_offline.
This option  can be useful for both standard MUC and MucSub, but the bounce is much more likely to happen in the
context of MucSub, so it is even more important to have it on large MucSub services.The default is <code>false</code>, meaning
the optimisation is enabled.</p>
<p><strong><code>use_mam_for_storage: false|true</code></strong>: This is an experimental option. Enabling this option will make mod_offline not
use the former spool table for storing MucSub offline messages, but will use the archive table instead. This use of
the archive table is cleaner and it makes it possible for clients to slowly drop the former offline use case and rely
on message archive instead. It also further reduce the storage required when you enabled MucSub. Enabling this option
has a known drawback for the moment: most of flexible message retrieval queries don’t work (those that allow
retrieval/deletion of messages by id), but this specification is not widely used. The default value is <code>false</code> to
keep former behaviour as default and ensure this option is disabled.</p>
<h3 id="example-configuration_2">Example Configuration<a class="headerlink" href="#example-configuration_2" title="Permanent link">&para;</a></h3>
<p>This example allows power users to have as much as 5000 offline
messages, administrators up to 2000, and all the other users up to
100.</p>
<p>acl:
   admin:
     user:
       - admin1@localhost
       - admin2@example.org
   poweruser:
     user:
       - bob@example.org
       - jane@example.org</p>
<p>shaper_rules:
   max_user_offline_messages:
     - 5000: poweruser
     - 2000: admin
        - 100</p>
<p>modules:
   ...
   mod_offline:
     access_max_user_messages: max_user_offline_messages
   ...</p>
<h3 id="implementation-notes_1">Implementation notes<a class="headerlink" href="#implementation-notes_1" title="Permanent link">&para;</a></h3>
<p>You have several approach for a client to learn what happened when it was offline:</p>
<ul>
<li>offline storage: This is adequate especially when a single client is
  typically used at a time.</li>
<li>message archive (MAM): This is a new archiving feature. A client
  (for example a mobile client) can use it to resync its own history
  with what happened when it was offline. In that case, the client is
  responsible for marking messages it considers new as "unread". See
  <a href="#mod_mam">mod_mam</a>.</li>
</ul>
<p>Some clients may rely on offline and/or message archives to catch up
on messages on reconnect, but client developers should always consider
interactions with those two modules together.</p>
<h2 id="mod_ping">mod_ping<a class="headerlink" href="#mod_ping" title="Permanent link">&para;</a></h2>
<p>This module implements support for XMPP Ping
(<a href="https://xmpp.org/extensions/xep-0199.html"><code>XEP-0199</code></a>) and periodic
keepalives. When this module is enabled ejabberd responds correctly to
ping requests, as defined in the protocol.</p>
<p>Configuration options:</p>
<p><strong><code>send_pings: true|false</code></strong>:   If this option is set to <code>true</code>, the server sends pings to connected
 clients that are not active in a given interval <code>ping_interval</code>.
 This is useful to keep client connections alive or checking
 availability. By default this option is disabled.</p>
<p><strong><code>ping_interval: Seconds</code></strong>:   How often to send pings to connected clients, if the previous option
 is enabled. If a client connection does not send or receive any
 stanza in this interval, a ping request is sent to the client. The
 default value is 60 seconds.</p>
<p><strong><code>ping_ack_timeout: Seconds</code></strong>:   How long to wait before deeming that a client has not answered a given
    server ping request.
 default value is 32 seconds.</p>
<p><strong><code>timeout_action: none|kill</code></strong>:   What to do when a client does not answer to a server ping request in
 less than <code>ping_ack_timeout</code>. The default is to do nothing.</p>
<p>This example enables Ping responses, configures the module to send pings
to client connections that are inactive for 4 minutes, and if a client
does not answer to the ping in less than 32 seconds, its connection is
closed:</p>
<p>modules:
   ...
   mod_ping:
     send_pings: true
     ping_interval: 240
     timeout_action: kill
   ...</p>
<h2 id="mod_pres_counter">mod_pres_counter<a class="headerlink" href="#mod_pres_counter" title="Permanent link">&para;</a></h2>
<p>This module detects flood/spam in presence subscription stanza traffic.
If a user sends or receives more of those stanzas in a time interval,
the exceeding stanzas are silently dropped, and warning is logged.</p>
<p>Configuration options:</p>
<p><strong><code>count: StanzaNumber</code></strong>:   The number of subscription presence stanzas (subscribe, unsubscribe,
 subscribed, unsubscribed) allowed for any direction (input or
 output) per time interval. Please note that two users subscribing to
 each other usually generate 4 stanzas, so the recommended value is 4
 or more. The default value is: 5.</p>
<p><strong><code>interval: Seconds</code></strong>:   The time interval defined in seconds. The default value is 60.</p>
<p>This example enables the module, and allows up to 5 presence
subscription stanzas to be sent or received by the users in 60 seconds:</p>
<p>modules:
   ...
   mod_pres_counter:
     count: 5
     interval: 60
   ...</p>
<h2 id="mod_privacy">mod_privacy<a class="headerlink" href="#mod_privacy" title="Permanent link">&para;</a></h2>
<p>This module implements
<a href="https://xmpp.org/extensions/xep-0016.html">XEP-0016: Privacy Lists`</a>. If
end users have support for it in their XMPP client, they will be able
to:</p>
<ul>
<li>Retrieving one’s privacy lists.</li>
<li>Adding, removing, and editing one’s privacy lists.</li>
<li>Setting, changing, or declining active lists.</li>
<li>Setting, changing, or declining the default list (i.e., the list that is active by default).</li>
<li>Allowing or blocking messages based on JID, group, or subscription type (or globally).</li>
<li>Allowing or blocking inbound presence notifications based on JID, group, or subscription type (or globally).</li>
<li>Allowing or blocking outbound presence notifications based on JID, group, or subscription type (or globally).</li>
<li>Allowing or blocking IQ stanzas based on JID, group, or subscription type (or globally).</li>
<li>Allowing or blocking all communications based on JID, group, or subscription type (or globally).</li>
</ul>
<p>Options:</p>
<p><strong><code>db_type: mnesia|sql</code></strong>:   Define the type of storage where the module will create the tables and store user information. The default is the storage defined by the global option <code>default_db</code>, or <code>mnesia</code> if omitted. If <code>sql</code> value is defined, make sure you have defined the database, see <a href="#database-and-ldap-configuration">database</a>.</p>
<p><strong><code>use_cache: false|true</code></strong>:   Use this option and related ones as explained in section <a href="#caching">Caching</a>.</p>
<h2 id="mod_private">mod_private<a class="headerlink" href="#mod_private" title="Permanent link">&para;</a></h2>
<p>This module adds support for Private XML Storage
(<a href="https://xmpp.org/extensions/xep-0049.html"><code>XEP-0049</code></a>):</p>
<blockquote>
<p>Using this method, XMPP entities can store private data on the server
and retrieve it whenever necessary. The data stored might be anything,
as long as it is valid XML. One typical usage for this namespace is
the server-side storage of client-specific preferences; another is
Bookmark Storage
(<a href="https://xmpp.org/extensions/xep-0048.html"><code>XEP-0048</code></a>).</p>
</blockquote>
<p>Options:</p>
<p><strong><code>db_type: mnesia|sql</code></strong>:   Define the type of storage where the module will create the tables and store user information. The default is the storage defined by the global option <code>default_db</code>, or <code>mnesia</code> if omitted. If <code>sql</code> value is defined, make sure you have defined the database, see <a href="#database-and-ldap-configuration">database</a>.</p>
<p><strong><code>use_cache: false|true</code></strong>:   Use this option and related ones as explained in section <a href="#caching">Caching</a>.</p>
<h2 id="mod_privilege">mod_privilege<a class="headerlink" href="#mod_privilege" title="Permanent link">&para;</a></h2>
<p>This module is an implementation of (<a href="https://xmpp.org/extensions/xep-0356.html"><code>XEP-0356</code></a>). This extension allows components to have privileged access to
other entity data (send messages on behalf of the server or on behalf of a user, get/set user roster, access presence
information, etc.). This may be used to write powerful external components, for example implementing an external PEP
(<a href="https://xmpp.org/extensions/xep-0163.html">XEP-0163: Personal Eventing Protocol</a>) or MAM
(<a href="https://xmpp.org/extensions/xep-0313.html">XEP-0313: Message Archive Management</a>) service.</p>
<h3 id="permission-list">Permission list<a class="headerlink" href="#permission-list" title="Permanent link">&para;</a></h3>
<p>By default a component does not have any privileged access. It is worth noting that the permissions listed below
grant access to the component to a specific data type for all users of the domain.</p>
<p>When configuring <code>mod_privilege</code> module, here are the available permissions:</p>
<ul>
<li>presence</li>
<li>managed_entity: receive server user presence.</li>
<li>roster: the component is allowed to receive the presence of both the users and the contacts in their roster.</li>
<li>message</li>
<li>outgoing: the component is allowed to send messages on behalf of either the server or a bare JID of server users.</li>
<li>roster</li>
<li>get: read access to a user's roster.</li>
<li>set: write access to a user's roster.</li>
<li>both: read/write access to a user's roster.</li>
</ul>
<p>You grant access to the component by providing an ACL to apply to that permission or <code>all</code> to give that access level to all
authenticated components.</p>
<h3 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h3>
<p>If you want to grant privileged access to a component, specify it in the module configurations, e.g.:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="nt">module</span><span class="p">:</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="nn">...</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="w">  </span><span class="nt">mod_privilege</span><span class="p">:</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="w">    </span><span class="nt">roster</span><span class="p">:</span>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="w">      </span><span class="nt">get</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a><span class="w">    </span><span class="nt">presence</span><span class="p">:</span>
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a><span class="w">      </span><span class="nt">managed_entity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
</span><span id="__span-53-8"><a id="__codelineno-53-8" name="__codelineno-53-8" href="#__codelineno-53-8"></a><span class="w">    </span><span class="nt">message</span><span class="p">:</span>
</span><span id="__span-53-9"><a id="__codelineno-53-9" name="__codelineno-53-9" href="#__codelineno-53-9"></a><span class="w">      </span><span class="nt">outgoing</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
</span></code></pre></div>
<p>In the example above, the <code>sat-pubsub.example.org</code> component can get the roster of every user of the server and send
messages on behalf of the server.</p>
<p>Note: You need to make sure you have a listener configured to connect your component. Check the
<a href="#listening-ports">listener</a> section for more information.</p>
<p>Here is a more complete example, with ACL and support for namespace delegation
(<a href="https://xmpp.org/extensions/xep-0355.html">XEP-0355</a>):</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="nt">listen</span><span class="p">:</span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a><span class="nn">...</span>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8888</span>
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="w">    </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ejabberd_service</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="w">    </span><span class="nt">hosts</span><span class="p">:</span>
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a><span class="w">      </span><span class="nt">sat-pubsub.example.org</span><span class="p">:</span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="w">        </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mypass</span>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a>
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a><span class="nt">acl</span><span class="p">:</span>
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a><span class="nn">...</span>
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a><span class="w">  </span><span class="nt">external_component</span><span class="p">:</span>
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a><span class="w">    </span><span class="nt">server</span><span class="p">:</span>
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sat-pubsub.example.org</span>
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a>
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a><span class="nt">access_rules</span><span class="p">:</span>
</span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a><span class="nn">...</span>
</span><span id="__span-54-17"><a id="__codelineno-54-17" name="__codelineno-54-17" href="#__codelineno-54-17"></a><span class="w">  </span><span class="nt">external_pubsub</span><span class="p">:</span>
</span><span id="__span-54-18"><a id="__codelineno-54-18" name="__codelineno-54-18" href="#__codelineno-54-18"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">allow</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">external_component</span>
</span><span id="__span-54-19"><a id="__codelineno-54-19" name="__codelineno-54-19" href="#__codelineno-54-19"></a>
</span><span id="__span-54-20"><a id="__codelineno-54-20" name="__codelineno-54-20" href="#__codelineno-54-20"></a><span class="nt">module</span><span class="p">:</span>
</span><span id="__span-54-21"><a id="__codelineno-54-21" name="__codelineno-54-21" href="#__codelineno-54-21"></a><span class="nn">...</span>
</span><span id="__span-54-22"><a id="__codelineno-54-22" name="__codelineno-54-22" href="#__codelineno-54-22"></a><span class="w">  </span><span class="nt">mod_delegation</span><span class="p">:</span>
</span><span id="__span-54-23"><a id="__codelineno-54-23" name="__codelineno-54-23" href="#__codelineno-54-23"></a><span class="w">    </span><span class="nt">namespaces</span><span class="p">:</span>
</span><span id="__span-54-24"><a id="__codelineno-54-24" name="__codelineno-54-24" href="#__codelineno-54-24"></a><span class="w">      </span><span class="s">&quot;http://jabber.org/protocol/pubsub&quot;</span><span class="p p-Indicator">:</span>
</span><span id="__span-54-25"><a id="__codelineno-54-25" name="__codelineno-54-25" href="#__codelineno-54-25"></a><span class="w">         </span><span class="nt">access</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">external_pubsub</span>
</span><span id="__span-54-26"><a id="__codelineno-54-26" name="__codelineno-54-26" href="#__codelineno-54-26"></a><span class="w">  </span><span class="nt">mod_privilege</span><span class="p">:</span>
</span><span id="__span-54-27"><a id="__codelineno-54-27" name="__codelineno-54-27" href="#__codelineno-54-27"></a><span class="w">    </span><span class="nt">roster</span><span class="p">:</span>
</span><span id="__span-54-28"><a id="__codelineno-54-28" name="__codelineno-54-28" href="#__codelineno-54-28"></a><span class="w">      </span><span class="nt">get</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">external_pubsub</span>
</span><span id="__span-54-29"><a id="__codelineno-54-29" name="__codelineno-54-29" href="#__codelineno-54-29"></a><span class="w">    </span><span class="nt">presence</span><span class="p">:</span>
</span><span id="__span-54-30"><a id="__codelineno-54-30" name="__codelineno-54-30" href="#__codelineno-54-30"></a><span class="w">      </span><span class="nt">managed_entity</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">external_pubsub</span>
</span><span id="__span-54-31"><a id="__codelineno-54-31" name="__codelineno-54-31" href="#__codelineno-54-31"></a><span class="w">    </span><span class="nt">message</span><span class="p">:</span>
</span><span id="__span-54-32"><a id="__codelineno-54-32" name="__codelineno-54-32" href="#__codelineno-54-32"></a><span class="w">      </span><span class="nt">outgoing</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">external_pubsub</span>
</span></code></pre></div>
<h3 id="security-issue_1">Security issue<a class="headerlink" href="#security-issue_1" title="Permanent link">&para;</a></h3>
<p>Privileged access gives components access to sensitive data, so permission should be granted carefully, only if you trust a component.</p>
<h3 id="note_1">Note<a class="headerlink" href="#note_1" title="Permanent link">&para;</a></h3>
<p>This module is complementary to <code>mod_delegation</code> (<a href="https://xmpp.org/extensions/xep-0355.html"><code>XEP-0355</code></a>) but can also be used separately.</p>
<h2 id="mod_proxy65">mod_proxy65<a class="headerlink" href="#mod_proxy65" title="Permanent link">&para;</a></h2>
<p>This module implements SOCKS5 Bytestreams
(<a href="https://xmpp.org/extensions/xep-0065.html"><code>XEP-0065</code></a>). It allows
<code>ejabberd</code> to act as a file transfer proxy between two XMPP clients.</p>
<p>Options:</p>
<p><strong><code>host: HostName</code></strong>:   This option defines the Jabber ID of the service. If the <code>host</code>
 option is not specified, the Jabber ID will be the hostname of the
 virtual host with the prefix ‘<code>proxy.</code>’. The keyword “@HOST@” is
 replaced at start time with the real virtual host name.</p>
<p><strong><code>name: Text</code></strong>:   Defines Service Discovery name of the service. Default is
 <code>SOCKS5 Bytestreams</code>.</p>
<p><strong><code>ip: IP</code></strong>:   This option specifies which network interface to listen for. Default
 is an IP address of the service’s DNS name, or, if fails,
 <code>"127.0.0.1"</code>.</p>
<p><strong><code>port: Number</code></strong>:   This option defines port to listen for incoming connections. Default
 is 7777.</p>
<p><strong><code>hostname: HostName</code></strong>:   Defines a hostname advertised by the service when establishing a
 session with clients. This is useful when you run the service behind
 a NAT. The keyword “@HOST@” is replaced with the virtual host name.
 The default is the value of <code>ip</code> option. Examples:
 <code>proxy.mydomain.org</code>, <code>200.150.100.50</code>. Note that not all clients
 understand domain names in stream negotiation, so you should think
 twice before setting domain name in this option.</p>
<p><strong><code>auth_type: anonymous|plain</code></strong>:   SOCKS5 authentication type. Possible values are <code>anonymous</code> and
 <code>plain</code>. Default is <code>anonymous</code>.</p>
<p><strong><code>access: AccessName</code></strong>:   Defines ACL for file transfer initiators. Default is <code>all</code>.</p>
<p><strong><code>max_connections: Number</code></strong>:   Maximum number of active connections per file transfer initiator. No
 limit by default.</p>
<p><strong><code>shaper: none|ShaperName</code></strong>:   This option defines shaper for the file transfer peers. Shaper with
 the maximum bandwidth will be selected. Default is <code>none</code>.</p>
<p>Examples:</p>
<ul>
<li>The simplest configuration of the module:</li>
</ul>
<p>modules:
    ...
    mod_proxy65: {}
    ...</p>
<ul>
<li>More complicated configuration.</li>
</ul>
<p>acl:
    admin:
      user:
        - admin@example.org
    proxy_users:
      server:
        - example.org</p>
<p>access_rules:
    proxy65_access:
      - allow: proxy_users
  shaper_rules:
    proxy65_shaper:
      - none: admin
      - proxyrate: proxy_users</p>
<p>shaper:
    proxyrate: 10240</p>
<p>modules:
    ...
    mod_proxy65:
      host: proxy1.example.org
      name: "File Transfer Proxy"
      ip: 200.150.100.1
      port: 7778
      max_connections: 5
      access: proxy65_access
      shaper: proxy65_shaper
    ...</p>
<h2 id="mod_pubsub">mod_pubsub<a class="headerlink" href="#mod_pubsub" title="Permanent link">&para;</a></h2>
<p>This module offers a Publish-Subscribe Service
(<a href="https://xmpp.org/extensions/xep-0060.html"><code>XEP-0060</code></a>). The
functionality in <code>mod_pubsub</code> can be extended using plugins. The plugin
that implements PEP (Personal Eventing via Pubsub)
(<a href="https://xmpp.org/extensions/xep-0163.html"><code>XEP-0163</code></a>) is enabled in
the default ejabberd configuration file, and it requires <code>mod_caps</code>.</p>
<p>Options:</p>
<p><strong><code>host: HostName</code></strong>:   This option defines the Jabber ID of the service. If the <code>host</code>
 option is not specified, the Jabber ID will be the hostname of the
 virtual host with the prefix ‘<code>pubsub.</code>’. The keyword “@HOST@” is
 replaced at start time with the real virtual host name.</p>
<p>If you use <code>mod_pubsub</code> with <code>sql</code> <code>db_type</code>, please ensure the
prefix contains only one dot, for example ‘<code>pubsub.</code>’, or
‘<code>publish.</code>’,.</p>
<p><strong><code>access_createnode: AccessName</code></strong>:   This option restricts which users are allowed to create pubsub nodes
 using ACL and ACCESS. By default any account in the local ejabberd
 server is allowed to create pubsub nodes.</p>
<p><strong><code>max_items_node: MaxItems</code></strong>:   Define the maximum number of items that can be stored in a node.
 Default value is 10.</p>
<p><strong><code>max_subscriptions_node: MaxSubs</code></strong>:   Define the maximum number of subscriptions managed by a node.
 Default value is undefined; no limitation.</p>
<p><strong><code>plugins: [ Plugin, ...]</code></strong>:   To specify which pubsub node plugins to use. The first one in the
 list is used by default. If this option is not defined, the default
 plugins list is: <code>[flat]</code>. PubSub clients can define which plugin to
 use when creating a node: add <code>type=’plugin-name’</code> attribute to the
 <code>create</code> stanza element.</p>
<ul>
<li>
<p><code>flat</code> plugin handles the default behaviour and follows standard
      XEP-0060 implementation.</p>
</li>
<li>
<p><code>pep</code> plugin adds extension to handle Personal Eventing Protocol
     (<a href="https://xmpp.org/extensions/xep-0163.html"><code>XEP-0163</code></a>) to the PubSub
     engine. Adding pep plugin to PubSub make it handle PEP automatically.</p>
</li>
</ul>
<p><strong><code>nodetree: Nodetree</code></strong>:   To specify which nodetree to use. If not defined, the default pubsub
 nodetree is used: <code>tree</code>. Only one nodetree can be used per host,
 and is shared by all node plugins.</p>
<ul>
<li>
<p><code>tree</code> nodetree store node configuration and relations on the
     database. <code>flat</code> nodes are stored without any relationship, and
     <code>hometree</code> nodes can have child nodes.</p>
</li>
<li>
<p><code>virtual</code> nodetree does not store nodes on database. This saves
     resources on systems with tons of nodes. If using the <code>virtual</code>
     nodetree, you can only enable those node plugins: [<code>flat</code>, <code>pep</code>] or
     [<code>flat</code>]; any other plugins configuration will not work. Also, all
     nodes will have the default configuration, and this can not be
     changed. Using “virtual” nodetree requires to start from a clean
     database, it will not work if you used the default “tree” nodetree
     before.</p>
</li>
<li>
<p><code>dag</code> nodetree provides experimental support for PubSub
     Collection Nodes
     (<a href="https://xmpp.org/extensions/xep-0248.html"><code>XEP-0248</code></a>). In that
     case you should also add “dag” node plugin as default, for example:</p>
<div class="language-text highlight"><pre><span></span><code>plugins: [flat,pep]
</code></pre></div>
</li>
</ul>
<p><strong><code>ignore_pep_from_offline: false|true</code></strong>:   To specify whether or not we should get last published PEP items
 from users in our roster which are offline when we connect. Value is
 true or false. If not defined, pubsub assumes true so we only get
 last items of online contacts.</p>
<p><strong><code>last_item_cache: false|true</code></strong>:   To specify whether or not pubsub should cache last items. Value is
 true or false. If not defined, pubsub do not cache last items. On
 systems with not so many nodes, caching last items speeds up pubsub
 and allows to raise user connection rate. The cost is memory usage,
 as every item is stored in memory.</p>
<p><strong><code>default_node_config: Config</code></strong>:   To override default node configuration, regardless of node plugin. Value
 is a list of key-value definition. Node configuration still uses
 default configuration defined by node plugin, and overrides any items
 by value defined in this configurable list.</p>
<p><strong><code>pep_mapping: {Key, Value}</code></strong>:   This allow to define a Key-Value list to choose defined node plugins
 on given PEP namespace. The following example will use node_tune
 instead of node_pep for every PEP node with tune namespace:</p>
<div class="language-text highlight"><pre><span></span><code> modules:
   ...
   mod_pubsub:
     pep_mapping:
       http://jabber.org/protocol/tune: tune
   ...
</code></pre></div>
<p>Example of configuration that uses flat nodes as default, and allows use
of flat, hometree and pep nodes:</p>
<p>modules:
   ...
   mod_pubsub:
     access_createnode: pubsub_createnode
     max_subscriptions_node: 100
     default_node_config:
       notification_type: normal
       notify_retract: false
       max_items: 4
     plugins:
       - flat
       - pep
   ...</p>
<p>Using relational database requires using mod_pubsub with db_type
<code>sql</code>. Only flat, hometree and pep plugins supports SQL. The
following example shows previous configuration with SQL usage:</p>
<p>modules:
   ...
   mod_pubsub:
     db_type: sql
     access_createnode: pubsub_createnode
     ignore_pep_from_offline: true
     last_item_cache: false
     plugins:
       - flat
       - pep
   ...</p>
<h2 id="mod_push">mod_push<a class="headerlink" href="#mod_push" title="Permanent link">&para;</a></h2>
<p>This module implements the XMPP server's part of the push notification
solution specified in <a href="https://xmpp.org/extensions/xep-0357.html"><code>XEP-0357</code></a>. It does <em>not</em> generate, for
example, APNS or FCM notifications directly. Instead, it's designed to
work with so-called "app servers" operated by third-party vendors of
mobile apps. Those app servers will usually trigger notification
delivery to the user's mobile device using platform-dependant backend
services such as FCM or APNS.</p>
<p>Options:</p>
<p><strong><code>include_sender: true|false</code></strong>:   If this option is set to <code>true</code>, the
 sender's JID is included with push notifications generated for
 incoming messages with a body. Default: <code>false</code>.</p>
<p><strong><code>include_body: true|false|String</code></strong>:   If this option is set to
 <code>true</code>, the message text is included with push notifications
 generated for incoming messages with a body. The option can
 instead be set to a static text, in which case the specified
 text will be included in place of the actual message body. This
 can be useful to signal the app server whether the notification
 was triggered by a message with body (as opposed to other types
 of traffic) without leaking actual message contents. Default:
 <code>"New message"</code>.</p>
<p><strong><code>db_type: mnesia|sql</code></strong>:   The type of storage where the module will
 store push session information. The default is the storage
 defined by the global option <code>default_db</code>, or <code>mnesia</code> if
 omitted. If <code>sql</code> is specified, make sure you have configured
 the database, see the
 <a href="#database-and-ldap-configuration">database</a> section.</p>
<p><strong><code>use_cache: false|true</code></strong>:   Use this option and related ones as
 explained in the section on <a href="#caching">caching</a>.</p>
<h2 id="mod_push_keepalive">mod_push_keepalive<a class="headerlink" href="#mod_push_keepalive" title="Permanent link">&para;</a></h2>
<p>This module tries to keep the <a href="#mod_stream_mgmt">stream management</a>
session of a disconnected mobile client alive if the client enabled
<a href="#mod_push">push notifications</a> for that session. However, the normal
session resumption timeout is restored once a push notification is
issued, so the session will be closed if the client doesn't respond to
push notifications.</p>
<p>Options:</p>
<p><strong><code>resume_timeout: Seconds|undefined</code></strong>:   This option specifies the
 number of seconds until the session of a disconnected push
 client times out. This timeout is only in effect as long as no
 push notification is issued. Once that happened, the resumption
 timeout configured for the <a href="#mod_stream_mgmt">stream management
 module</a> is restored. If this option is set to
 <code>undefined</code>, the resumption timeout won't be modified by
 <code>mod_push_keepalive</code>. Default: <code>259200</code>.</p>
<p><strong><code>wake_on_start: true|false</code></strong>:   If this option is set to <code>true</code>,
 notifications are generated for <em>all</em> registered push clients
 during server startup. This option should <em>not</em> be enabled on
 servers with many push clients as it can generate significant
 load on the involved push services. Default: <code>false</code>.</p>
<p><strong><code>wake_on_timeout: true|false</code></strong>:   If this option is set to <code>true</code>, a
 notification is generated shortly before the session would time
 out as per the <code>resume_timeout</code> described above. Default:
 <code>true</code>.</p>
<h2 id="mod_register">mod_register<a class="headerlink" href="#mod_register" title="Permanent link">&para;</a></h2>
<p>This module adds support for In-Band Registration
(<a href="https://xmpp.org/extensions/xep-0077.html"><code>XEP-0077</code></a>). This protocol
enables end users to use a XMPP client to:</p>
<ul>
<li>
<p>Register a new account on the server.</p>
</li>
<li>
<p>Change the password from an existing account on the server.</p>
</li>
<li>
<p>Delete an existing account on the server.</p>
</li>
</ul>
<p>Options:</p>
<p><strong><code>access: AccessName</code></strong>:   Specify rules to restrict what usernames can be registered and
 unregistered. If a rule returns ‘deny’ on the requested username,
 registration and unregistration of that user name is denied. There
 are no restrictions by default.</p>
<p><strong><code>access_from: AccessName</code></strong>:   By default, <code>ejabberd</code> doesn't allow to register new accounts from
 s2s or existing c2s sessions. You can change it by defining access
 rule in this option. Use with care: allowing registration from s2s
 leads to uncontrolled massive accounts creation by rogue users.</p>
<p><strong><code>captcha_protected: false|true</code></strong>:   Protect registrations with CAPTCHA (see section <a href="#captcha">CAPTCHA</a>). The
 default is <code>false</code>.</p>
<p><strong><code>ip_access: AccessName</code></strong>:   Define rules to allow or deny account registration depending on the
 IP address of the XMPP client. The <code>AccessName</code> should be of type
 <code>ip</code>. The default value is <code>all</code>.</p>
<p><strong><code>password_strength: Entropy</code></strong>:   This option sets the minimum Shannon entropy for passwords.
 The value <code>Entropy</code> is a number of bits of entropy. The recommended
 minimum is 32 bits. The default is 0, i.e. no checks are performed.</p>
<p><strong><code>redirect_url: URL</code></strong>:   This option enables registration redirection as described in
 <a href="https://xmpp.org/extensions/xep-0077.html#redirect"><code>XEP-0077: In-Band Registration: Redirection</code></a>.</p>
<p><strong><code>registration_watchers: [ JID, ...]</code></strong>:   This option defines a list of JIDs which will be notified each time
 a new account is registered.</p>
<p><strong><code>welcome_message: {subject: Subject, body: Body}</code></strong>:   Set a welcome message that is sent to each newly registered account.
 The first string is the subject, and the second string is the
 message body.</p>
<p>This module reads also another option defined globally for the server:
<code>registration_timeout: Timeout</code>. This option limits the frequency of
registration from a given IP or username. So, a user that tries to
register a new account from the same IP address or JID during this
number of seconds after their previous registration will receive an error
<code>resource-constraint</code> with the explanation: “Users are not allowed to
register accounts so quickly”. The timeout is expressed in seconds, and
it must be an integer. To disable this limitation, instead of an integer
put a word like: <code>infinity</code>. Default value: 600 seconds.</p>
<p>Examples:</p>
<ul>
<li>Next example prohibits the registration of too short account names,
 and allows to create accounts only to clients of the local network:</li>
</ul>
<p>acl:
    loopback:
      ip:
        - 127.0.0.0/8
        - "::1"
    shortname:
      user_glob:
        - "?"
        - "??"
      ## The same using regexp:
      ##user_regexp: "^..?$"</p>
<p>access_rules:
    mynetworks:
      - allow: loopback
    register:
      - deny: shortname
      - allow: all</p>
<p>modules:
    mod_register:
      ip_access: mynetworks
      access: register</p>
<ul>
<li>This configuration prohibits usage of In-Band Registration to create
 or delete accounts, but allows existing accounts to change the
 password:</li>
</ul>
<p>modules:
    ...
    mod_register:
      access: none
    ...</p>
<ul>
<li>This configuration disables all In-Band Registration functionality:
 create, delete accounts and change password:</li>
</ul>
<p>modules:
    ...
    ## mod_register:
    ##   access: register
    ...</p>
<ul>
<li>Define the welcome message and two registration watchers. Also
 define a registration timeout of one hour:</li>
</ul>
<p>registration_timeout: 3600
  modules:
    ...
    mod_register:
      welcome_message:
        subject: "Welcome!"
        body: |-
          Hi.
          Welcome to this XMPP server.
          Check https://xmpp.org/</p>
<div class="language-text highlight"><pre><span></span><code>      Bye
  registration_watchers:
    - admin1@example.org
    - boss@example.net
  redirect_url: http://my.site.org/register
...
</code></pre></div>
<h2 id="mod_register_web">mod_register_web<a class="headerlink" href="#mod_register_web" title="Permanent link">&para;</a></h2>
<p>This module provides a web page where people can:</p>
<ul>
<li>
<p>Register a new account on the server.</p>
</li>
<li>
<p>Change the password from an existing account on the server.</p>
</li>
<li>
<p>Delete an existing account on the server.</p>
</li>
</ul>
<p>This module supports CAPTCHA image to register a new account. To enable
this feature, configure the options captcha_cmd and captcha_host.</p>
<p>Options:</p>
<p><strong><code>registration_watchers: [ JID, ...]</code></strong>:   This option defines a list of JIDs which will be notified each time
 a new account is registered.</p>
<p>This example configuration shows how to enable the module and the web
handler:</p>
<p>hosts:
   - localhost
   - example.org
   - example.com</p>
<p>certfiles:
   - /etc/ejabberd/certificate.pem</p>
<p>listen:
   ...
   -
     port: 5281
     module: ejabberd_http
     tls: true
     request_handlers:
       /register: mod_register_web
   ...</p>
<p>modules:
   ...
   mod_register_web: {}
   ...</p>
<p>For example, the users of the host <code>example.org</code> can visit the page:
<code>https://example.org:5281/register/</code> It is important to include the last
/ character in the URL, otherwise the subpages URL will be incorrect.</p>
<h2 id="mod_roster">mod_roster<a class="headerlink" href="#mod_roster" title="Permanent link">&para;</a></h2>
<p>This module implements roster management as defined in
<a href="https://tools.ietf.org/html/rfc6121#section-2"><code>RFC 6121: XMPP IM</code></a>. It
also supports Roster Versioning
(<a href="https://xmpp.org/extensions/xep-0237.html"><code>XEP-0237</code></a>).</p>
<p>Options:</p>
<p><strong><code>db_type: mnesia|sql</code></strong>:   Define the type of storage where the module will create the tables and store user information. The default is the storage defined by the global option <code>default_db</code>, or <code>mnesia</code> if omitted. If <code>sql</code> value is defined, make sure you have defined the database, see <a href="#database-and-ldap-configuration">database</a>.</p>
<p><strong><code>use_cache: false|true</code></strong>:   Use this option and related ones as explained in section <a href="#caching">Caching</a>.</p>
<p><strong><code>versioning: false|true</code></strong>:   Enables Roster Versioning. This option is disabled by default. We use a <a href="../../developer/xmpp-clients-bots/extensions/roster-versioning/">simplified version of roster versioning</a>.</p>
<p><strong><code>store_current_id: false|true</code></strong>:   If this option is enabled, the current version number is stored on
 the database. If disabled, the version number is calculated on the
 fly each time. Enabling this option reduces the load for both
 ejabberd and the database. This option does not affect the client in
 any way. This option is only useful if Roster Versioning is enabled.
 This option is disabled by default. Important: if you use
 <code>mod_shared_roster</code> or <code>mod_shared_roster_ldap</code>, you must disable
 this option.</p>
<p><strong><code>access</code></strong>:   This option can be configured to specify rules to restrict roster
 management. If a rule returns ‘deny’ on the requested user name,
 that user cannot modify their personal roster: not add/remove/modify
 contacts, or subscribe/unsubscribe presence. By default there aren’t
 restrictions.</p>
<p>This example configuration enables Roster Versioning with storage of
current id. The ICQ and MSN transports can get ICQ and MSN contacts, add
them, or remove them for any local account:</p>
<p>modules:
   ...
   mod_roster:
     versioning: true
     store_current_id: true
   ...</p>
<p>With this example configuration, only admins can manage their rosters;
everybody else cannot modify the roster:</p>
<p>acl:
   admin:
     user:
       - sarah@example.org
 access_rules:
   roster:
     - allow: admin</p>
<p>modules:
   ...
   mod_roster:
     access: roster
   ...</p>
<h2 id="mod_s2s_dialback">mod_s2s_dialback<a class="headerlink" href="#mod_s2s_dialback" title="Permanent link">&para;</a></h2>
<p>This module adds support for the Server Dialback protocol (<a href="https://xmpp.org/extensions/xep-0220.html"><code>XEP-0220</code></a>)
to provide identity verification based on DNS.</p>
<h2 id="mod_service_log">mod_service_log<a class="headerlink" href="#mod_service_log" title="Permanent link">&para;</a></h2>
<p>This module adds support for logging end user packets via a XMPP message
auditing service such as
<a href="https://www.funkypenguin.co.nz/project/bandersnatch/"><code>Bandersnatch</code></a>.
All user packets are encapsulated in a <code>&lt;route/&gt;</code> element and sent to
the specified service(s).</p>
<p>Options:</p>
<p><strong><code>loggers: [Names, ...]</code></strong>:   With this option a (list of) service(s) that will receive the
 packets can be specified.</p>
<p>Examples:</p>
<ul>
<li>To log all end user packets to the Bandersnatch service running on
 <code>bandersnatch.example.com</code>:</li>
</ul>
<p>modules:
    ...
    mod_service_log:
      loggers: [bandersnatch.example.com]
    ...</p>
<ul>
<li>To log all end user packets to the Bandersnatch service running on
 <code>bandersnatch.example.com</code> and the backup service on
 <code>bandersnatch.example.org</code>:</li>
</ul>
<p>modules:
    ...
    mod_service_log:
      loggers:
        - bandersnatch.example.com
        - bandersnatch.example.org
    ...</p>
<h2 id="mod_shared_roster">mod_shared_roster<a class="headerlink" href="#mod_shared_roster" title="Permanent link">&para;</a></h2>
<p>This module enables you to create shared roster groups. This means that
you can create groups of people that can see members from (other) groups
in their rosters. The big advantages of this feature are that end users
do not need to manually add all users to their rosters, and that they
cannot permanently delete users from the shared roster groups. A shared
roster group can have members from any XMPP server, but the presence
will only be available from and to members of the same virtual host
where the group is created.</p>
<p>It still allows the users to have / add their own contacts, as it does
not replace the standard roster. Instead, the shared roster contacts
are merged to the relevant users at retrieval time. The standard user
rosters thus stay unmodified.</p>
<p>Special values like @all@ and @online@ will help populating the shared
roster dynamically. It means that the actual list of members in those
shared rosters is generated dynamically at retrieval time.</p>
<p><strong>Note:</strong> <code>mod_shared_roster</code> depends on <code>mod_roster</code> being
enabled. Roster queries will return 503 errors if <code>mod_roster</code> is not
enabled.</p>
<p>Options:</p>
<p><strong><code>db_type: mnesia|sql</code></strong>:   Define the type of storage where the module will create the tables and store user information. The default is the storage defined by the global option <code>default_db</code>, or <code>mnesia</code> if omitted. If <code>sql</code> value is defined, make sure you have defined the database, see <a href="#database-and-ldap-configuration">database</a>.</p>
<p>Shared roster groups can be edited <em>only</em> via the Web Admin. Each group
has a unique identification and the following parameters:</p>
<ul>
<li>
<p><strong>Name</strong>:   The name of the group, which will be displayed in the roster.</p>
</li>
<li>
<p><strong>Description</strong>:   The description of the group. This parameter does not affect
 anything.</p>
</li>
<li>
<p><strong>Members</strong>:   A list of JIDs of group members, entered one per line in the Web
 Admin. The special member directive <code>@all@</code> represents all the
 registered users in the virtual host; which is only recommended for
 a small server with just a few hundred users. The special member
 directive <code>@online@</code> represents the online users in the virtual
 host.</p>
</li>
<li>
<p><strong>Displayed groups</strong>:   A list of groups that will be in the rosters of this group’s
 members. A group of other vhost can be identified with
 <code>groupid@vhost</code></p>
</li>
</ul>
<p>Examples:</p>
<ul>
<li>Take the case of a computer club that wants all its members seeing
 each other in their rosters. To achieve this, they need to create a
 shared roster group similar to this one:</li>
</ul>
<p><strong>Identification</strong>:  Group ‘<code>club_members</code>’</p>
<p><strong>Name</strong>:  Club Members</p>
<p><strong>Description</strong>:  Members from the computer club</p>
<p><strong>Members</strong>:  <code>member1@example.org</code>, <code>member2@example.org</code>, <code>member3@example.org</code></p>
<p><strong>Displayed groups</strong>:  <code>club_members</code></p>
<ul>
<li>In another case we have a company which has three divisions:
 Management, Marketing and Sales. All group members should see all
 other members in their rosters. Additionally, all managers should
 have all marketing and sales people in their roster. Simultaneously,
 all marketeers and the whole sales team should see all managers.
 This scenario can be achieved by creating shared roster groups as
 shown in the following lists:</li>
</ul>
<p>First list:</p>
<p><strong>Identification</strong>:  Group ‘<code>management</code>’</p>
<p><strong>Name</strong>:  Management</p>
<p><strong>Description</strong>:  Management</p>
<p><strong>Members</strong>:  <code>manager1@example.org</code>, <code>manager2@example.org</code></p>
<p><strong>Displayed groups</strong>:  <code>management</code>, <code>marketing</code>, <code>sales</code></p>
<p>Second list:</p>
<p><strong>Identification</strong>:  Group ‘<code>marketing</code>’</p>
<p><strong>Name</strong>:  Marketing</p>
<p><strong>Description</strong>:  Marketing</p>
<p><strong>Members</strong>:  <code>marketeer1@example.org</code>, <code>marketeer2@example.org</code>, <code>marketeer3@example.org</code></p>
<p><strong>Displayed groups</strong>:  <code>management</code>, <code>marketing</code></p>
<p>Third list:</p>
<p><strong>Identification</strong>:  Group ‘<code>sales</code>’</p>
<p><strong>Name</strong>:  Sales</p>
<p><strong>Description</strong>:  Sales</p>
<p><strong>Members</strong>:  <code>salesman1@example.org</code>, <code>salesman2@example.org</code>, <code>salesman3@example.org</code></p>
<p><strong>Displayed groups</strong>:  <code>management</code>, <code>sales</code></p>
<h2 id="mod_shared_roster_ldap">mod_shared_roster_ldap<a class="headerlink" href="#mod_shared_roster_ldap" title="Permanent link">&para;</a></h2>
<p>This module lets the server administrator automatically populate users’
rosters (contact lists) with entries based on users and groups defined
in an LDAP-based directory.</p>
<p><strong>Note:</strong> <code>mod_shared_roster_ldap</code> depends on <code>mod_roster</code> being
enabled. Roster queries will return 503 errors if <code>mod_roster</code> is not
enabled.</p>
<h3 id="configuration-parameters">Configuration parameters<a class="headerlink" href="#configuration-parameters" title="Permanent link">&para;</a></h3>
<p>The module accepts the following configuration parameters. Some of them,
if unspecified, default to the values specified for the top level of
configuration. This lets you avoid specifying, for example, the bind
password, in multiple places.</p>
<p><strong><code>use_cache: false|true</code></strong>:   Use this option and related ones as explained in section <a href="#caching">Caching</a>.</p>
<h4 id="filters">Filters<a class="headerlink" href="#filters" title="Permanent link">&para;</a></h4>
<p>These parameters specify LDAP filters used to query for shared roster
information. All of them are run against the <code>ldap_base</code>.</p>
<p><strong><code>ldap_rfilter</code></strong>:   So called “Roster Filter”. Used to find names of all “shared roster”
 groups. See also the <code>ldap_groupattr</code> parameter. If unspecified,
 defaults to the top-level parameter of the same name. You
 <em>must</em> specify it in some place in the configuration,
 there is no default.</p>
<p><strong><code>ldap_ufilter</code></strong>:   “User Filter” – used for retrieving the human-readable name of
 roster entries (usually full names of people in the roster). See
 also the parameters <code>ldap_userdesc</code> and <code>ldap_useruid</code>. If
 unspecified, defaults to the top-level parameter of the same name.
 If that one also is unspecified, then the filter is assembled from
 values of other parameters as follows (<code>[ldap_SOMETHING]</code> is used to
 mean “the value of the configuration parameter
 <code>ldap_SOMETHING</code>”):</p>
<p>(&amp;(&amp;([ldap_memberattr]=[ldap_memberattr_format])([ldap_groupattr]=%g))[ldap_filter])</p>
<p>Subsequently <code>%u</code> and <code>%g</code> are replaced with a *.
This means that given the defaults, the filter sent to the LDAP
server would be <code>(&amp;(memberUid=*)(cn=*))</code>. If however the
<code>ldap_memberattr_format</code> is something like
<code>uid=%u,ou=People,o=org</code>, then the filter will be
<code>(&amp;(memberUid=uid=*,ou=People,o=org)(cn=*))</code>.</p>
<p><strong><code>ldap_gfilter</code></strong>:   “Group Filter” – used when retrieving human-readable name (a.k.a.
 “Display Name”) and the members of a group. See also the parameters
 <code>ldap_groupattr</code>, <code>ldap_groupdesc</code> and <code>ldap_memberattr</code>. If
 unspecified, defaults to the top-level parameter of the same name.
 If that one also is unspecified, then the filter is constructed
 exactly in the same way as <em>User Filter</em>.</p>
<p><strong><code>ldap_filter</code></strong>:   Additional filter which is AND-ed together with <em>User
 Filter</em> and <em>Group Filter</em>. If unspecified,
 defaults to the top-level parameter of the same name. If that one is
 also unspecified, then no additional filter is merged with the other
 filters.</p>
<p>Note that you will probably need to manually define the
<em>User</em> and <em>Group Filter</em> (since the
auto-assembled ones will not work) if:</p>
<ul>
<li>
<p>your <code>ldap_memberattr_format</code> is anything other than a
 simple <code>%u</code>,</p>
</li>
<li>
<p><strong>and</strong> the attribute specified with
 <code>ldap_memberattr</code> does not support substring matches.</p>
</li>
</ul>
<p>An example where it is the case is OpenLDAP and
<em>(unique)MemberName</em> attribute from the
<em>groupOf(Unique)Names</em> objectClass. A symptom of this problem
is that you will see messages such as the following in your
<code>slapd.log</code>:</p>
<p>get_filter: unknown filter type=130
 filter="(&amp;(?=undefined)(?=undefined)(something=else))"</p>
<h3 id="attributes">Attributes<a class="headerlink" href="#attributes" title="Permanent link">&para;</a></h3>
<p>These parameters specify the names of the attributes which hold
interesting data in the entries returned by running filters specified in
section <a href="#filters">Filters</a>.</p>
<p><strong><code>ldap_groupattr</code></strong>: The name of the attribute that holds the group name, and that is used to
  differentiate between them. Retrieved from results of the “Roster
  Filter” and “Group Filter”. Defaults to <code>cn</code>.</p>
<p><strong><code>ldap_groupdesc</code></strong>: The name of the attribute which holds the human-readable group name in
  the objects you use to represent groups. Retrieved from results of the
  “Group Filter”. Defaults to whatever <code>ldap_groupattr</code> is
  set.</p>
<p><strong><code>ldap_memberattr</code></strong>: The name of the attribute which holds the IDs of the members of a group.
 Retrieved from results of the “Group Filter”. Defaults to
 <code>memberUid</code>.</p>
<p>The name of the attribute differs depending on the
<code>objectClass</code> you use for your group objects, for example:</p>
<p><code>posixGroup</code> -&gt; <code>memberUid</code>
  <code>groupOfNames</code> -&gt; <code>member</code>
  <code>groupOfUniqueNames</code> -&gt; <code>uniqueMember</code></p>
<p><strong><code>ldap_userdesc</code></strong>: The name of the attribute which holds the human-readable user name.
  Retrieved from results of the “User Filter”. Defaults to
  <code>cn</code>.</p>
<p><strong><code>ldap_useruid</code></strong>: The name of the attribute which holds the ID of a roster item. Value of
  this attribute in the roster item objects needs to match the ID
  retrieved from the <code>ldap_memberattr</code> attribute of a group
  object. Retrieved from results of the “User Filter”. Defaults to
  <code>cn</code>.</p>
<h3 id="control-parameters">Control parameters<a class="headerlink" href="#control-parameters" title="Permanent link">&para;</a></h3>
<p>These parameters control the behaviour of the module.</p>
<p><strong><code>ldap_memberattr_format</code></strong>:   A globbing format for extracting user ID from the value of the
 attribute named by <code>ldap_memberattr</code>. Defaults to <code>%u</code>,
 which means that the whole value is the member ID. If you change it
 to something different, you may also need to specify the User and
 Group Filters manually — see section <a href="#filters">Filters</a>.</p>
<p><strong><code>ldap_memberattr_format_re</code></strong>:   A regex for extracting user ID from the value of the attribute named
 by <code>ldap_memberattr</code>.</p>
<p>An example value
<code>“CN=(\\w*),(OU=.*,)*DC=company,DC=com”</code>
works for user IDs such as the following:</p>
<ul>
<li><code>CN=Romeo,OU=Montague,DC=company,DC=com</code></li>
<li><code>CN=Abram,OU=Servants,OU=Montague,DC=company,DC=com</code></li>
<li><code>CN=Juliet,OU=Capulet,DC=company,DC=com</code></li>
<li><code>CN=Peter,OU=Servants,OU=Capulet,DC=company,DC=com</code></li>
</ul>
<p>In case:</p>
<ul>
<li>the option is unset,</li>
<li>or the <code>re</code> module in unavailable in the current
    Erlang environment,</li>
<li>or the regular expression does not compile,</li>
</ul>
<p>then instead of a regular expression, a simple format specified by
<code>ldap_memberattr_format</code> is used. Also, in the last two
cases an error message is logged during the module initialization.</p>
<p>Also, note that in all cases <code>ldap_memberattr_format</code>
(and <code>*not*</code> the regex version) is used for constructing
the default “User/Group Filter” — see section <a href="#filters">Filters</a>.</p>
<p><strong><code>ldap_auth_check</code></strong>:   Whether the module should check (via the ejabberd authentication
 subsystem) for existence of each user in the shared LDAP roster. See
 section <a href="#mod_shared_roster_ldap">mod_shared_roster_ldap</a> form more information. Set to
 <code>off</code> if you want to disable the check. Defaults to
 <code>on</code>.</p>
<p><strong><code>ldap_user_cache_validity</code></strong>:   Number of seconds for which the cache for roster item full names is
 considered fresh after retrieval. 300 by default. See
 section <a href="#mod_shared_roster_ldap">mod_shared_roster_ldap</a> on how it is used during roster
 retrieval.</p>
<p><strong><code>ldap_group_cache_validity</code></strong>:   Number of seconds for which the cache for group membership is
 considered fresh after retrieval. 300 by default. See
 section <a href="#mod_shared_roster_ldap">mod_shared_roster_ldap</a> on how it is used during roster
 retrieval.</p>
<h3 id="connection-parameters">Connection parameters<a class="headerlink" href="#connection-parameters" title="Permanent link">&para;</a></h3>
<p>The module also accepts the connection parameters, all of which default
to the top-level parameter of the same name, if unspecified.
See <a href="#ldap-connection">LDAP Connection</a>] for more information about them.</p>
<h3 id="retrieving-the-roster">Retrieving the roster<a class="headerlink" href="#retrieving-the-roster" title="Permanent link">&para;</a></h3>
<p>When the module is called to retrieve the shared roster for a user, the
following algorithm is used:</p>
<ol>
<li>
<p>[step:rfilter] A list of names of groups to display is created: the
 <em>Roster Filter</em> is run against the base DN, retrieving
 the values of the attribute named by <code>ldap_groupattr</code>.</p>
</li>
<li>
<p>Unless the group cache is fresh (see the
 <code>ldap_group_cache_validity</code> option), it is refreshed:</p>
</li>
<li>
<p>Information for all groups is retrieved using a single query:
  the <em>Group Filter</em> is run against the Base DN,
  retrieving the values of attributes named by
  <code>ldap_groupattr</code> (group ID),
  <code>ldap_groupdesc</code> (group “Display Name”) and
  <code>ldap_memberattr</code> (IDs of group members).</p>
</li>
<li>
<p>group “Display Name”, read from the attribute named by
  <code>ldap_groupdesc</code>, is stored in the cache for the
  given group</p>
</li>
<li>
<p>the following processing takes place for each retrieved value of
  attribute named by <code>ldap_memberattr</code>:</p>
</li>
<li>
<p>the user ID part of it is extracted using
   <code>ldap_memberattr_format(_re)</code>,</p>
</li>
<li>
<p>then (unless <code>ldap_auth_check</code> is set to
   <code>off</code>) for each found user ID, the module checks
   (using the <code>ejabberd</code> authentication subsystem) whether such
   user exists in the given virtual host. It is skipped if the
   check is enabled and fails.</p>
</li>
</ol>
<p>This step is here for historical reasons. If you have a tidy
   DIT and properly defined “Roster Filter” and “Group Filter”,
   it is safe to disable it by setting
   <code>ldap_auth_check</code> to <code>off</code> — it will
   speed up the roster retrieval.</p>
<ol>
<li>
<p>the user ID is stored in the list of members in the cache
   for the given group</p>
</li>
<li>
<p>For each item (group name) in the list of groups retrieved in
 step [step:rfilter]:</p>
</li>
<li>
<p>the display name of a shared roster group is retrieved from the
  group cache</p>
</li>
<li>
<p>for each IDs of users which belong to the group, retrieved from
  the group cache:</p>
</li>
<li>
<p>the ID is skipped if it’s the same as the one for which we
   are retrieving the roster. This is so that the user does not
   have himself in the roster.</p>
</li>
<li>
<p>the display name of a shared roster user is retrieved:</p>
</li>
<li>
<p>first, unless the user name cache is fresh (see the
    <code>ldap_user_cache_validity</code> option), it is
    refreshed by running the <em>User Filter</em>,
    against the Base DN, retrieving the values of attributes
    named by <code>ldap_useruid</code> and
    <code>ldap_userdesc</code>.</p>
</li>
<li>
<p>then, the display name for the given user ID is
    retrieved from the user name cache.</p>
</li>
</ol>
<h3 id="configuration-examples">Configuration examples<a class="headerlink" href="#configuration-examples" title="Permanent link">&para;</a></h3>
<p>Since there are many possible
<a href="https://en.wikipedia.org/wiki/Directory_Information_Tree"><code>DIT</code></a>
layouts, it will probably be easiest to understand how to configure the
module by looking at an example for a given DIT (or one resembling it).</p>
<h4 id="flat-dit">Flat DIT<a class="headerlink" href="#flat-dit" title="Permanent link">&para;</a></h4>
<p>This seems to be the kind of DIT for which this module was initially
designed. Basically there are just user objects, and group membership is
stored in an attribute individually for each user. For example in a
layout shown in figure [fig:msrl-dit-flat], the group of each user is
stored in its <code>ou</code> attribute.</p>
<p>Such layout has a few downsides, including:</p>
<ul>
<li>
<p>information duplication – the group name is repeated in every member
 object</p>
</li>
<li>
<p>difficult group management – information about group members is not
 centralized, but distributed between member objects</p>
</li>
<li>
<p>inefficiency – the list of unique group names has to be computed by
 iterating over all users</p>
</li>
</ul>
<p>This however seems to be a common DIT layout, so the module keeps
supporting it. You can use the following configuration…</p>
<p>modules:
   ...
   mod_shared_roster_ldap:
     ldap_base: "ou=flat,dc=nodomain"
     ldap_rfilter: "(objectClass=inetOrgPerson)"
     ldap_groupattr: ou
     ldap_memberattr: cn
     ldap_filter: "(objectClass=inetOrgPerson)"
     ldap_userdesc: displayName
   ...</p>
<p>…to be provided with a roster as shown in figure [fig:msrl-roster-flat]
upon connecting as user <code>czesio</code>.</p>
<h4 id="deep-dit">Deep DIT<a class="headerlink" href="#deep-dit" title="Permanent link">&para;</a></h4>
<p>This type of DIT contains distinctly typed objects for users and groups
– see figure [fig:msrl-dit-deep]. They are shown separated into
different subtrees, but it’s not a requirement.</p>
<p>If you use the following example module configuration with it:</p>
<p>modules:
   ...
   mod_shared_roster_ldap:
     ldap_base: "ou=deep,dc=nodomain"
     ldap_rfilter: "(objectClass=groupOfUniqueNames)"
     ldap_filter: ""
     ldap_gfilter: "(&amp;(objectClass=groupOfUniqueNames)(cn=%g))"
     ldap_groupdesc: description
     ldap_memberattr: uniqueMember
     ldap_memberattr_format: "cn=%u,ou=people,ou=deep,dc=nodomain"
     ldap_ufilter: "(&amp;(objectClass=inetOrgPerson)(cn=%u))"
     ldap_userdesc: displayName
   ...</p>
<p>…and connect as user <code>czesio</code>, then <code>ejabberd</code> will provide
you with the roster shown in figure [fig:msrl-roster-deep].</p>
<h2 id="mod_sic">mod_sic<a class="headerlink" href="#mod_sic" title="Permanent link">&para;</a></h2>
<p>This module adds support for Server IP Check
(<a href="https://xmpp.org/extensions/xep-0279.html"><code>XEP-0279</code></a>). This protocol
enables a client to discover its external IP address.</p>
<h2 id="mod_sip">mod_sip<a class="headerlink" href="#mod_sip" title="Permanent link">&para;</a></h2>
<p>This module adds SIP proxy/registrar support for the corresponding
virtual host. Note that it is not enough to just load this module only.
You should also configure listeners and DNS records properly. See
section <a href="#sip">SIP</a> for the full explanation.</p>
<p>Example configuration:</p>
<p>modules:
   ...
   mod_sip: {}
   ...</p>
<p>Options:</p>
<p><strong><code>record_route: SIP_URI</code></strong>:   When the option <code>always_record_route</code> is set or when SIP outbound is
 utilized <a href="https://tools.ietf.org/html/rfc5626"><code>RFC 5626</code></a>,
 <code>ejabberd</code> inserts <code>Record-Route</code> header field with this <code>SIP_URI</code>
 into a SIP message. The default is SIP URI constructed from the
 virtual host.</p>
<p><strong><code>always_record_route: true|false</code></strong>:   Always insert <code>Record-Route</code> header into SIP messages. This approach
 allows to bypass NATs/firewalls a bit more easily. The default is
 <code>true</code>.</p>
<p><strong><code>routes: [SIP_URI]</code></strong>:   You can set a list of SIP URIs of routes pointing to this proxy
 server. The default is a list of a SIP URI constructed from the
 virtual host.</p>
<p><strong><code>flow_timeout_udp: Seconds</code></strong>:   For SIP outbound UDP connections set a keep-alive timer to
 <code>Seconds</code>. The default is 29.</p>
<p><strong><code>flow_timeout_tcp: Seconds</code></strong>:   For SIP outbound TCP connections set a keep-alive timer to
 <code>Seconds</code>. The default is 120.</p>
<p><strong><code>via: [{type: Type, host: Host, port: Port}]</code></strong>:   With this option for every <code>Type</code> you can specify <code>Host</code> and <code>Port</code>
 to set in <code>Via</code> header of outgoing SIP messages, where <code>Type</code> can be
 <code>udp</code>, <code>tcp</code> or <code>tls</code>. <code>Host</code> is a string and <code>Port</code> is a non
 negative integer. This is useful if you’re running your server in a
 non-standard network topology.</p>
<p>Example complex configuration:</p>
<p>modules:
   ...
   mod_sip:
     always_record_route: false
     record_route: "sip:example.com;lr"
     routes:
       - "sip:example.com;lr"
       - "sip:sip.example.com;lr"
     flow_timeout_udp: 30
     flow_timeout_tcp: 130
     via:
       -
         type: tls
         host: sip-tls.example.com
         port: 5061
       -
         type: tcp
         host: sip-tcp.example.com
         port: 5060
       -
         type: udp
         host: sip-udp.example.com
         port: 5060
   ...</p>
<h2 id="mod_stats">mod_stats<a class="headerlink" href="#mod_stats" title="Permanent link">&para;</a></h2>
<p>This module adds support for Statistics Gathering
(<a href="https://xmpp.org/extensions/xep-0039.html"><code>XEP-0039</code></a>). This protocol
allows you to retrieve next statistics from your <code>ejabberd</code> deployment:</p>
<ul>
<li>
<p>Total number of registered users on the current virtual host
 (users/total).</p>
</li>
<li>
<p>Total number of registered users on all virtual hosts
 (users/all-hosts/total).</p>
</li>
<li>
<p>Total number of online users on the current virtual host
 (users/online).</p>
</li>
<li>
<p>Total number of online users on all virtual hosts
 (users/all-hosts/online).</p>
</li>
</ul>
<p>As there are only a small amount of clients (for example
<a href="http://tkabber.jabber.ru/"><code>Tkabber</code></a>) and software libraries with
support for this XEP, a few examples are given of the XML you need to
send in order to get the statistics. Here they are:</p>
<ul>
<li>You can request the number of online users on the current virtual
 host (<code>example.org</code>) by sending:</li>
</ul>
<p><iq to='example.org' type='get'>
    <query xmlns='http://jabber.org/protocol/stats'>
      <stat name='users/online'/>
    </query>
  </iq></p>
<ul>
<li>You can request the total number of registered users on all virtual
 hosts by sending:</li>
</ul>
<p><iq to='example.org' type='get'>
    <query xmlns='http://jabber.org/protocol/stats'>
      <stat name='users/all-hosts/total'/>
    </query>
  </iq></p>
<h2 id="mod_stream_mgmt">mod_stream_mgmt<a class="headerlink" href="#mod_stream_mgmt" title="Permanent link">&para;</a></h2>
<p>This module adds support for Stream Management (<a href="https://xmpp.org/extensions/xep-0198.html"><code>XEP-0198</code></a>).
This protocol allows active management of an XML stream between two XMPP entities,
including features for stanza acknowledgements and stream resumption.</p>
<p>Options:</p>
<p><strong><code>max_ack_queue: Size</code></strong>:   This option specifies the maximum number of unacknowledged stanzas
 queued for possible retransmission.
 When the limit is exceeded, the client session is
 terminated. The allowed values are positive integers and <code>infinity</code>.
 You should be careful when setting this value as it should not be set too low,
 otherwise, you could killed sessions in loop, before they get the chance to finish
 proper session initiation. It should definitely be set higher that the size of the
 offline queue (for example at least 3 times the value of the max offline queue and never
 lower than 1000).
 Default value: <code>5000</code>.</p>
<p><strong><code>max_resume_timeout: Seconds</code></strong>:   A client may specify the number of
 seconds until a session times out if the connection is lost. During
 this period of time, the client may resume the session. This option
 limits the number of seconds a client is permitted to request.
 It must be set to
 a number equal to or larger than the default <code>resume_timeout</code> (see
 below). By default, it is set to the same value as the
 <code>resume_timeout</code> option.</p>
<p><strong><code>resend_on_timeout: true|false|if_offline</code></strong>:   If this option is set to <code>true</code>,
 any message stanzas that weren’t acknowledged by the client will
 be resent on session timeout. This behavior might often be desired,
 but could have unexpected results under certain circumstances. For
 example, a message that was sent to two resources might get resent
 to one of them if the other one timed out. Therefore, the default
 value for this option is <code>false</code>, which tells ejabberd to generate
 an error message instead. As an alternative, the option may be set
 to <code>if_offline</code>. In this case, unacknowledged messages are resent
 only if no other resource is online when the session times out.
 Otherwise, error messages are generated.</p>
<p><strong><code>resume_timeout: Seconds</code></strong>:   This option configures the (default) number of seconds until a session
 times out if the connection is lost. During this period of time, a
 client may resume the session.
 (Note that the client may request a different timeout value, see the
 <code>max_resume_timeout</code> option above.) Setting it to <code>0</code> effectively disables
 session resumption. The default value is <code>300</code>.</p>
<p><strong><code>ack_timeout: Seconds</code></strong>: The default value is <code>60</code>.
 Setting it to <code>infinity</code> effectively disables the timeout.</p>
<p><strong><code>queue_type: Discipline</code></strong>: The default value is <code>ram</code>.
 The accepted values are <code>ram</code> and <code>file</code>.</p>
<h2 id="mod_time">mod_time<a class="headerlink" href="#mod_time" title="Permanent link">&para;</a></h2>
<p>This module features support for Entity Time
(<a href="https://xmpp.org/extensions/xep-0202.html"><code>XEP-0202</code></a>). By using this
XEP, you are able to discover the time at another entity’s location.</p>
<h2 id="mod_vcard">mod_vcard<a class="headerlink" href="#mod_vcard" title="Permanent link">&para;</a></h2>
<p>This module allows end users to store and retrieve their vCard, and to
retrieve other users vCards, as defined in vcard-temp
(<a href="https://xmpp.org/extensions/xep-0054.html"><code>XEP-0054</code></a>). The module
also implements an uncomplicated Jabber User Directory based on the
vCards of these users. Moreover, it enables the server to send its vCard
when queried.</p>
<p>Options:</p>
<p><strong><code>host: HostName</code></strong>:   This option defines the Jabber ID of the service. If the <code>host</code>
 option is not specified, the Jabber ID will be the hostname of the
 virtual host with the prefix ‘<code>vjud.</code>’. The keyword “@HOST@” is
 replaced at start time with the real virtual host name.</p>
<p><strong><code>db_type: mnesia|sql|ldap</code></strong>: Define the type of storage where
  the module will create the tables and store user information. The
  default is the storage defined by the global option <code>default_db</code>, or
  <code>mnesia</code> if omitted. If <code>sql</code> value is defined, make sure
  you have defined the database, see
  <a href="#database-and-ldap-configuration">database</a>. If <code>ldap</code> value is
  defined, check its specific options, see <a href="#vcards-in-ldap">vCards in
  LDAP</a>.</p>
<p><strong><code>use_cache: false|true</code></strong>:   Use this option and related ones as explained in section <a href="#caching">Caching</a>.</p>
<p><strong><code>search: true|false</code></strong>:   This option specifies whether the search functionality is enabled or
 not. If disabled, the option <code>host</code> will be ignored and the Jabber
 User Directory service will not appear in the Service Discovery item
 list. The default value is <code>false</code>.</p>
<p><strong><code>matches: infinity|Number</code></strong>:   With this option, the number of reported search results can be
 limited. If the option’s value is set to <code>infinity</code>, all search
 results are reported. The default value is <code>30</code>.</p>
<p><strong><code>allow_return_all: false|true</code></strong>:   This option enables you to specify if search operations with empty
 input fields should return all users who added some information to
 their vCard. The default value is <code>false</code>.</p>
<p><strong><code>search_all_hosts, true|false</code></strong>:   If this option is set to <code>true</code>, search operations will apply to all
 virtual hosts. Otherwise only the current host will be searched. The
 default value is <code>true</code>. This option is available in <code>mod_vcard</code>
 when using Mnesia, but not when using SQL storage.</p>
<p>Examples:</p>
<ul>
<li>In this first situation, search results are limited to twenty items,
 every user who added information to their vCard will be listed when
 people do an empty search, and only users from the current host will
 be returned:</li>
</ul>
<p>modules:
    ...
    mod_vcard:
      search: true
      matches: 20
      allow_return_all: true
      search_all_hosts: false
    ...</p>
<ul>
<li>The second situation differs in a way that search results are not
 limited, and that all virtual hosts will be searched instead of only
 the current one:</li>
</ul>
<p>modules:
    ...
    mod_vcard:
      search: true
      matches: infinity
      allow_return_all: true
    ...</p>
<h3 id="vcards-in-ldap">vCards in LDAP<a class="headerlink" href="#vcards-in-ldap" title="Permanent link">&para;</a></h3>
<p><code>ejabberd</code> can map LDAP attributes to vCard fields. This feature is
enabled when the <code>mod_vcard</code> module is configured with <code>db_type:
ldap</code>. Notice that it does not depend on the authentication method
(see <a href="#ldap-authentication">LDAP Authentication</a>).</p>
<p>Usually <code>ejabberd</code> treats LDAP as a read-only storage: it is possible to
consult data, but not possible to create accounts or edit vCard that is
stored in LDAP. However, it is possible to change passwords if
<code>mod_register</code> module is enabled and LDAP server supports
<a href="https://tools.ietf.org/html/rfc3062"><code>RFC 3062</code></a>.</p>
<p>This feature has its own optional parameters. The first
group of parameters has the same meaning as the top-level LDAP
parameters to set the authentication method: <code>ldap_servers</code>,
<code>ldap_port</code>, <code>ldap_rootdn</code>, <code>ldap_password</code>, <code>ldap_base</code>, <code>ldap_uids</code>,
<code>ldap_deref_aliases</code> and <code>ldap_filter</code>. See section
<a href="#ldap-authentication">LDAP Authentication</a> for
detailed information about these options. If one of these options is not
set, <code>ejabberd</code> will look for the top-level option with the same name.</p>
<p>The second group of parameters consists of the following <code>mod_vcard</code>-specific options:</p>
<p><strong><code>host: HostName</code></strong>:   This option defines the Jabber ID of the service. If the <code>host</code>
 option is not specified, the Jabber ID will be the hostname of the
 virtual host with the prefix ‘<code>vjud.</code>’. The keyword “@HOST@” is
 replaced at start time with the real virtual host name.</p>
<p><strong><code>search: true|false</code></strong>:   This option specifies whether the search functionality is enabled
 (value: <code>true</code>) or disabled (value: <code>false</code>). If disabled, the
 option <code>host</code> will be ignored and the Jabber User Directory service
 will not appear in the Service Discovery item list. The default
 value is <code>false</code>.</p>
<p><strong><code>matches: infinity|Number</code></strong>:   With this option, the number of reported search results can be
 limited. If the option’s value is set to <code>infinity</code>, all search
 results are reported. The default value is <code>30</code>.</p>
<p><strong><code>ldap_vcard_map: {Name: {Pattern, LDAPattributes}, ...}</code></strong>:   With this option you can set the table that maps LDAP attributes to
 vCard fields. <code>Name</code> is the type name of the vCard as defined in
 <a href="https://tools.ietf.org/html/rfc2426"><code>RFC 2426</code></a>. <code>Pattern</code> is a
 string which contains pattern variables <code>%u</code>, <code>%d</code> or <code>%s</code>.
 <code>LDAPattributes</code> is the list containing LDAP attributes. The pattern
 variables <code>%s</code> will be sequentially replaced with the values of LDAP
 attributes from <code>List_of_LDAP_attributes</code>, <code>%u</code> will be replaced
 with the user part of a JID, and <code>%d</code> will be replaced with the
 domain part of a JID. The default is:</p>
<div class="language-text highlight"><pre><span></span><code> NICKNAME: {&quot;%u&quot;: []}
 FN: {&quot;%s&quot;: [displayName]}
 LAST: {&quot;%s&quot;: [sn]}
 FIRST: {&quot;%s&quot;: [givenName]}
 MIDDLE: {&quot;%s&quot;: [initials]}
 ORGNAME: {&quot;%s&quot;: [o]}
 ORGUNIT: {&quot;%s&quot;: [ou]}
 CTRY: {&quot;%s&quot;: [c]}
 LOCALITY: {&quot;%s&quot;: [l]}
 STREET: {&quot;%s&quot;: [street]}
 REGION: {&quot;%s&quot;: [st]}
 PCODE: {&quot;%s&quot;: [postalCode]}
 TITLE: {&quot;%s&quot;: [title]}
 URL: {&quot;%s&quot;: [labeleduri]}
 DESC: {&quot;%s&quot;: [description]}
 TEL: {&quot;%s&quot;: [telephoneNumber]}
 EMAIL: {&quot;%s&quot;: [mail]}
 BDAY: {&quot;%s&quot;: [birthDay]}
 ROLE: {&quot;%s&quot;: [employeeType]}
 PHOTO: {&quot;%s&quot;: [jpegPhoto]}
</code></pre></div>
<p><strong><code>ldap_search_fields: {Name: Attribute, ...}</code></strong>:   This option defines the search form and the LDAP attributes to
 search within. <code>Name</code> is the name of a search form field which will
 be automatically translated by using the translation files (see
 <code>msgs/*.msg</code> for available words). <code>Attribute</code> is the LDAP attribute
 or the pattern <code>%u</code>. The default is:</p>
<div class="language-text highlight"><pre><span></span><code> User: &quot;%u&quot;
 &quot;Full Name&quot;: displayName
 &quot;Given Name&quot;: givenName
 &quot;Middle Name&quot;: initials
 &quot;Family Name&quot;: sn
 Nickname: &quot;%u&quot;
 Birthday: birthDay
 Country: c
 City: l
 Email: mail
 &quot;Organization Name&quot;: o
 &quot;Organization Unit&quot;: ou
</code></pre></div>
<p><strong><code>ldap_search_reported: {SearchField: VcardField}, ...}</code></strong>:   This option defines which search fields should be reported.
 <code>SearchField</code> is the name of a search form field which will be
 automatically translated by using the translation files (see
 <code>msgs/*.msg</code> for available words). <code>VcardField</code> is the vCard field
 name defined in the <code>ldap_vcard_map</code> option. The default is:</p>
<div class="language-text highlight"><pre><span></span><code> &quot;Full Name&quot;: FN
 &quot;Given Name&quot;: FIRST
 &quot;Middle Name&quot;: MIDDLE
 &quot;Family Name&quot;: LAST
 &quot;Nickname&quot;: NICKNAME
 &quot;Birthday&quot;: BDAY
 &quot;Country&quot;: CTRY
 &quot;City&quot;: LOCALITY
 &quot;Email&quot;: EMAIL
 &quot;Organization Name&quot;: ORGNAME
 &quot;Organization Unit&quot;: ORGUNIT
</code></pre></div>
<p>Examples:</p>
<ul>
<li>Let’s say <code>ldap.example.org</code> is the name of our LDAP server. We have
 users with their passwords in <code>ou=Users,dc=example,dc=org</code>
 directory. Also we have addressbook, which contains users emails and
 their additional infos in <code>ou=AddressBook,dc=example,dc=org</code>
 directory. Corresponding authentication section should looks like
 this:</li>
</ul>
<p>## authentication method
  auth_method: ldap
  ## DNS name of our LDAP server
  ldap_servers:
    - ldap.example.org
  ## We want to authorize users from 'shadowAccount' object class only
  ldap_filter: "(objectClass=shadowAccount)"</p>
<p>Now we want to use users LDAP-info as their vCards. We have four
attributes defined in our LDAP schema: <code>mail</code> — email address,
<code>givenName</code> — first name, <code>sn</code> — second name, <code>birthDay</code> — birthday.
Also we want users to search each other. Let’s see how we can set it
up:</p>
<p>modules:
    mod_vcard:
      db_type: ldap
      ## We use the same server and port, but want to bind anonymously because
      ## our LDAP server accepts anonymous requests to
      ## "ou=AddressBook,dc=example,dc=org" subtree.
      ldap_rootdn: ""
      ldap_password: ""
      ## define the addressbook's base
      ldap_base: "ou=AddressBook,dc=example,dc=org"
      ## uidattr: user's part of JID is located in the "mail" attribute
      ## uidattr_format: common format for our emails
      ldap_uids: {"mail": "%u@mail.example.org"}
      ## Now we want to define vCard pattern
      ldap_vcard_map:
        NICKNAME: {"%u": []} # just use user's part of JID as their nickname
        FIRST: {"%s": [givenName]}
        LAST: {"%s": [sn]}
        FN: {"%s, %s": [sn, givenName]} # example: "Smith, John"
        EMAIL: {"%s": [mail]}
        BDAY: {"%s": [birthDay]}
      ## Search form
      ldap_search_fields:
        User: "%u"
        Name: givenName
        "Family Name": sn
        Email: mail
        Birthday: birthDay
      ## vCard fields to be reported
      ## Note that JID is always returned with search results
      ldap_search_reported:
        "Full Name": FN
        Nickname: NICKNAME
        Birthday: BDAY</p>
<p>Note that <code>mod_vcard</code> with LDAP backend checks an existence of the user
before searching their info in LDAP.</p>
<ul>
<li><code>ldap_vcard_map</code> example:</li>
</ul>
<p>ldap_vcard_map:
    NICKNAME: {"%u": []} # just use user's part of JID as their nickname
    FN: {"%s": [displayName]}
    CTRY: {Russia: []}
    EMAIL: {"%u@%d": []}
    DESC: {"%s\n%s": [title, description]}</p>
<ul>
<li><code>ldap_search_fields</code> example:</li>
</ul>
<p>ldap_search_fields:
    User: uid
    "Full Name": displayName
    Email: mail</p>
<ul>
<li><code>ldap_search_reported</code> example:</li>
</ul>
<p>ldap_search_reported:
    "Full Name": FN
    Email: EMAIL
    Birthday: BDAY
    Nickname: NICKNAME</p>
<h2 id="mod_vcard_xupdate">mod_vcard_xupdate<a class="headerlink" href="#mod_vcard_xupdate" title="Permanent link">&para;</a></h2>
<p>The user’s client can store an avatar in the user vCard. The vCard-Based
Avatars protocol
(<a href="https://xmpp.org/extensions/xep-0153.html"><code>XEP-0153</code></a>) provides a
method for clients to inform the contacts what is the avatar hash value.
However, simple or small clients may not implement that protocol.</p>
<p>If this module is enabled, all the outgoing client presence stanzas get
automatically the avatar hash on behalf of the client. So, the contacts
receive the presence stanzas with the Update Data described in
<a href="https://xmpp.org/extensions/xep-0153.html"><code>XEP-0153</code></a> as if the client
would had inserted it itself. If the client had already included such
element in the presence stanza, it is replaced with the element
generated by ejabberd.</p>
<p>By enabling this module, each vCard modification produces a hash
recalculation, and each presence sent by a client produces hash
retrieval and a presence stanza rewrite. For this reason, enabling this
module will introduce a computational overhead in servers with clients
that change frequently their presence.</p>
<p>Supported options:</p>
<p><strong><code>use_cache: false|true</code></strong>:   Use this option and related ones as explained in section <a href="#caching">Caching</a>.</p>
<h2 id="mod_version">mod_version<a class="headerlink" href="#mod_version" title="Permanent link">&para;</a></h2>
<p>This module implements Software Version
(<a href="https://xmpp.org/extensions/xep-0092.html"><code>XEP-0092</code></a>). Consequently,
it answers <code>ejabberd</code>’s version when queried.</p>
<p>Options:</p>
<p><strong><code>show_os: true|false</code></strong>:   Should the operating system be revealed or not. The default value is
 <code>true</code>.</p>







  
  






                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../older-releases/from_2.1.1x_to_16.02/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Upgrade from 2.1.1x to 16.02">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Upgrade from 2.1.1x to 16.02
              </div>
            </div>
          </a>
        
        
          
          <a href="../../CHANGELOG/" class="md-footer__link md-footer__link--next" aria-label="Next: ChangeLog">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                ChangeLog
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2008 - 2024 <a href="https://process-one.net" target="_blank" rel="noopener">ProcessOne</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/processone/ejabberd" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/processone/docker-ejabberd/" target="_blank" rel="noopener" title="Docker Registry" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>
  
    
    
      
    
    
    
    <a href="https://social.process-one.net/@ejabberd" target="_blank" rel="noopener me" title="Mastodon" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://process-one.net" target="_blank" rel="noopener" title="ProcessOne Website" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="m225.8 468.2-2.5-2.3L48.1 303.2C17.4 274.7 0 234.7 0 192.8v-3.3c0-70.4 50-130.8 119.2-144 39.4-7.6 79.7 1.5 111.8 24.1 9 6.4 17.4 13.8 25 22.3 4.2-4.8 8.7-9.2 13.5-13.3 3.7-3.2 7.5-6.2 11.5-9 32.1-22.6 72.4-31.7 111.8-24.2C462 58.6 512 119.1 512 189.5v3.3c0 41.9-17.4 81.9-48.1 110.4L288.7 465.9l-2.5 2.3c-8.2 7.6-19 11.9-30.2 11.9s-22-4.2-30.2-11.9zM239.1 145c-.4-.3-.7-.7-1-1.1l-17.8-20-.1-.1c-23.1-25.9-58-37.7-92-31.2-46.6 8.9-80.2 49.5-80.2 96.9v3.3c0 28.5 11.9 55.8 32.8 75.2L256 430.7 431.2 268a102.7 102.7 0 0 0 32.8-75.2v-3.3c0-47.3-33.6-88-80.1-96.9-34-6.5-69 5.4-92 31.2l-.1.1-.1.1-17.8 20c-.3.4-.7.7-1 1.1-4.5 4.5-10.6 7-16.9 7s-12.4-2.5-16.9-7z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "toc.follow", "navigation.top", "navigation.instant", "navigation.instant.progress", "navigation.tracking", "navigation.footer", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotate", "content.code.copy", "content.action.edit", "content.action.view"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.dd8806f2.min.js"></script>
      
    
  </body>
</html>